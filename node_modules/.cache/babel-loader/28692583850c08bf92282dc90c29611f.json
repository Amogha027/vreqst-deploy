{"ast":null,"code":"import _regeneratorRuntime from\"/home/amogha/btp/temp/VReqST-main/VReqST/frontend/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/amogha/btp/temp/VReqST-main/VReqST/frontend/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/amogha/btp/temp/VReqST-main/VReqST/frontend/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import AceEditor from\"react-ace\";import{Box,Breadcrumb,BreadcrumbItem,BreadcrumbLink,Button,Center,Flex,FormControl,FormLabel,Radio,RadioGroup,Spinner,Stack,Switch,useToast}from\"@chakra-ui/react\";import{ChevronRightIcon}from\"@chakra-ui/icons\";import\"ace-builds/src-noconflict/ext-language_tools\";import\"ace-builds/src-noconflict/mode-json\";import\"ace-builds/src-noconflict/theme-terminal\";import{FaSave,FaTimes}from\"react-icons/fa\";import{useHistory,useParams,Link}from\"react-router-dom\";import{backend}from\"../../server_urls\";import isJson from\"../../utils/checkjson\";import{check}from\"express-validator\";var scenefile=require(\"../default/scene.txt\");var assetfile=require(\"../default/asset.txt\");var actionfile=require(\"../default/action.txt\");var timelinefile=require(\"../default/timeline.txt\");var EditFile=function EditFile(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),filename=_useState2[0],setfilename=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setdata=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),grammarfor=_useState8[0],setGrammarfor=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),privateFile=_useState10[0],setPrivateFile=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),flag=_useState12[0],setflag=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),isSaved=_useState14[0],setSaved=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),scenedef=_useState16[0],setScenedef=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),assetdef=_useState18[0],setAssetdef=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),actiondef=_useState20[0],setActiondef=_useState20[1];var _useState21=useState(''),_useState22=_slicedToArray(_useState21,2),timelinedef=_useState22[0],setTimelinedef=_useState22[1];var _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),scenedata=_useState24[0],setSceneData=_useState24[1];var _useState25=useState(''),_useState26=_slicedToArray(_useState25,2),assetdata=_useState26[0],setAssetData=_useState26[1];var _useState27=useState(''),_useState28=_slicedToArray(_useState27,2),actiondata=_useState28[0],setActionData=_useState28[1];var _useState29=useState(''),_useState30=_slicedToArray(_useState29,2),timelinedata=_useState30[0],setTimelineData=_useState30[1];var history=useHistory();var toast=useToast();var _useParams=useParams(),fileid=_useParams.fileid;var fetchdata=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var jwttoken,requestOptions,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:jwttoken=localStorage.getItem(\"jwtToken\");_context.prev=1;requestOptions={headers:{\"Content-Type\":\"application/json\",token:jwttoken}};_context.next=5;return axios.get(// `http://localhost:5002/api/json/${fileid}`,\nbackend+\"/api/json/\".concat(fileid),requestOptions);case 5:res=_context.sent;if(res.data.scene!=null)setSceneData(res.data.scene);if(res.data.asset!=null)setAssetData(res.data.asset);if(res.data.action!=null)setActionData(res.data.action);if(res.data.timeline!=null)setTimelineData(res.data.timeline);setfilename(res.data.name);setGrammarfor(res.data.grammarfor);setPrivateFile(res.data.private);_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[1,15]]);}));return function fetchdata(){return _ref.apply(this,arguments);};}();var fetchDefault=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response1,data1,response2,data2,response3,data3,response4,data4;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(scenefile);case 3:response1=_context2.sent;if(response1.ok){_context2.next=6;break;}throw new Error('Network response was not ok.');case 6:_context2.next=8;return response1.text();case 8:data1=_context2.sent;setScenedef(data1);_context2.next=12;return fetch(assetfile);case 12:response2=_context2.sent;if(response2.ok){_context2.next=15;break;}throw new Error('Network response was not ok.');case 15:_context2.next=17;return response2.text();case 17:data2=_context2.sent;setAssetdef(data2);_context2.next=21;return fetch(actionfile);case 21:response3=_context2.sent;if(response3.ok){_context2.next=24;break;}throw new Error('Network response was not ok.');case 24:_context2.next=26;return response3.text();case 26:data3=_context2.sent;setActiondef(data3);_context2.next=30;return fetch(timelinefile);case 30:response4=_context2.sent;if(response4.ok){_context2.next=33;break;}throw new Error('Network response was not ok.');case 33:_context2.next=35;return response4.text();case 35:data4=_context2.sent;setTimelinedef(data4);_context2.next=42;break;case 39:_context2.prev=39;_context2.t0=_context2[\"catch\"](0);console.error('Error fetching data:',_context2.t0);case 42:case\"end\":return _context2.stop();}}},_callee2,null,[[0,39]]);}));return function fetchDefault(){return _ref2.apply(this,arguments);};}();useEffect(function(){setLoading(true);fetchdata();fetchDefault();setLoading(false);},[]);function onChange(newValue){setdata(newValue);setSaved(false);}var handleGrammar=function handleGrammar(value){setflag(false);setGrammarfor(value);if(value===\"scene\")setdata(scenedata);if(value===\"asset\")setdata(assetdata);if(value===\"action\")setdata(actiondata);if(value===\"timeline\")setdata(timelinedata);};var handleSwitch=function handleSwitch(){setSaved(false);if(!flag){if(grammarfor===\"scene\")setdata(scenedef);if(grammarfor===\"asset\")setdata(assetdef);if(grammarfor===\"action\")setdata(actiondef);if(grammarfor===\"timeline\")setdata(timelinedef);setflag(true);}else{// setdata(\"\");\nif(grammarfor===\"scene\")setdata(scenedata);if(grammarfor===\"asset\")setdata(assetdata);if(grammarfor===\"action\")setdata(actiondata);if(grammarfor===\"timeline\")setdata(timelinedata);setflag(false);}};var saveFiles=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var jwttoken,requestOptions,url;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(isJson(data)){_context3.next=3;break;}toast({title:\"JSON Syntax is not correct\",status:\"error\",duration:5000,isClosable:true,position:\"top\"});return _context3.abrupt(\"return\");case 3:jwttoken=localStorage.getItem(\"jwtToken\");setLoading(true);_context3.prev=5;requestOptions={headers:{\"Content-Type\":\"application/json\",token:jwttoken}};url=backend;if(grammarfor===\"scene\"){url=url+\"/api/json/\".concat(fileid,\"/scene\");setSceneData(data);}if(grammarfor===\"action\"){url=url+\"/api/json/\".concat(fileid,\"/action\");setActionData(data);}if(grammarfor===\"asset\"){url=url+\"/api/json/\".concat(fileid,\"/asset\");setAssetData(data);}if(grammarfor===\"timeline\"){url=url+\"/api/json/\".concat(fileid,\"/timeline\");setTimelineData(data);}setSaved(true);_context3.next=15;return axios.patch(url,{data:data,name:filename,grammarfor:grammarfor},requestOptions);case 15:// history.push(\"/myfiles\");\nsetLoading(false);toast({title:\"File updated successfully\",status:\"success\",duration:5000,isClosable:true,position:\"top-right\"});_context3.next=22;break;case 19:_context3.prev=19;_context3.t0=_context3[\"catch\"](5);console.log(_context3.t0);case 22:setflag(false);case 23:case\"end\":return _context3.stop();}}},_callee3,null,[[5,19]]);}));return function saveFiles(){return _ref3.apply(this,arguments);};}();return loading?React.createElement(React.Fragment,null,React.createElement(Flex,{width:\"100vw\",height:\"85vh\",justifyContent:\"center\",alignItems:\"center\"},React.createElement(Spinner,{thickness:\"4px\",speed:\"0.65s\",emptyColor:\"gray.200\",color:\"blue.500\",size:\"xl\"}))):React.createElement(Box,{minH:\"85vh\"},React.createElement(Breadcrumb,{spacing:\"8px\",pt:5,pl:5,separator:React.createElement(ChevronRightIcon,{color:\"gray.500\"})},React.createElement(BreadcrumbItem,null,React.createElement(BreadcrumbLink,{as:Link,to:\"/myfiles\"},\"My Validators\")),React.createElement(BreadcrumbItem,{isCurrentPage:true},React.createElement(BreadcrumbLink,null,filename))),React.createElement(Flex,{flexDir:\"column\",justifyContent:\"center\",alignItems:\"center\",py:\"50px\"},React.createElement(Flex,{boxShadow:\"xl\",p:8,rounded:\"xl\",align:\"center\",borderWidth:\"1px\",borderColor:\"gray.400\",mb:5},React.createElement(Flex,{justifyContent:\"center\",flexDir:\"column\"},React.createElement(RadioGroup,{onChange:handleGrammar,value:grammarfor,py:2},React.createElement(Stack,{direction:\"row\"},React.createElement(Radio,{isReadOnly:!isSaved,value:\"scene\"},\"Scene\"),React.createElement(Radio,{isReadOnly:!isSaved,value:\"asset\"},\"Asset\"),React.createElement(Radio,{isReadOnly:!isSaved,value:\"action\"},\"Action\"),React.createElement(Radio,{isReadOnly:!isSaved,value:\"timeline\"},\"Timeline\"))),React.createElement(FormControl,{display:\"flex\",justifyContent:\"center\",pb:2},React.createElement(FormLabel,{htmlFor:\"public-file\",mb:\"0\"},\"DEFAULT\"),React.createElement(Switch,{id:\"public-file\",defaultChecked:false,isChecked:flag,onChange:handleSwitch})))),React.createElement(Box,{mx:\"40px\"},React.createElement(AceEditor,{fontSize:16,showPrintMargin:true,showGutter:true,highlightActiveLine:true,setOptions:{enableBasicAutocompletion:true,enableLiveAutocompletion:true,enableSnippets:false,showLineNumbers:true,tabSize:2},mode:\"json\",theme:\"terminal\",onChange:onChange,value:data,name:\"grammar-editor\",id:\"grammar-editor\",wrapEnabled:true,height:\"40em\",width:\"60em\"})),React.createElement(Center,{minW:\"max-content\",justifyContent:\"center\",my:\"20px\"},React.createElement(Button,{leftIcon:React.createElement(FaSave,null),colorScheme:\"yellow\"// disabled={!filename || !data}\n,disabled:isSaved,onClick:function onClick(){saveFiles();},isLoading:loading},\"Save Validator\"),React.createElement(Button,{leftIcon:React.createElement(FaTimes,null),colorScheme:\"yellow\",disabled:!isSaved,onClick:function onClick(){history.push(\"/myfiles\");},isLoading:loading},\"Exit\"))));};export default EditFile;","map":{"version":3,"sources":["/home/amogha/btp/temp/VReqST-main/VReqST/frontend/client/src/Components/EditFile/EditFile.jsx"],"names":["axios","React","useEffect","useState","AceEditor","Box","Breadcrumb","BreadcrumbItem","BreadcrumbLink","Button","Center","Flex","FormControl","FormLabel","Radio","RadioGroup","Spinner","Stack","Switch","useToast","ChevronRightIcon","FaSave","FaTimes","useHistory","useParams","Link","backend","isJson","check","scenefile","require","assetfile","actionfile","timelinefile","EditFile","filename","setfilename","data","setdata","loading","setLoading","grammarfor","setGrammarfor","privateFile","setPrivateFile","flag","setflag","isSaved","setSaved","scenedef","setScenedef","assetdef","setAssetdef","actiondef","setActiondef","timelinedef","setTimelinedef","scenedata","setSceneData","assetdata","setAssetData","actiondata","setActionData","timelinedata","setTimelineData","history","toast","fileid","fetchdata","jwttoken","localStorage","getItem","requestOptions","headers","token","get","res","scene","asset","action","timeline","name","private","console","log","fetchDefault","fetch","response1","ok","Error","text","data1","response2","data2","response3","data3","response4","data4","error","onChange","newValue","handleGrammar","value","handleSwitch","saveFiles","title","status","duration","isClosable","position","url","patch","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","showLineNumbers","tabSize","push"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport AceEditor from \"react-ace\";\n\nimport {\n  Box,\n  Breadcrumb,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  Button,\n  Center,\n  Flex,\n  FormControl,\n  FormLabel,\n  Radio,\n  RadioGroup,\n  Spinner,\n  Stack,\n  Switch,\n  useToast,\n} from \"@chakra-ui/react\";\nimport { ChevronRightIcon } from \"@chakra-ui/icons\";\nimport \"ace-builds/src-noconflict/ext-language_tools\";\nimport \"ace-builds/src-noconflict/mode-json\";\nimport \"ace-builds/src-noconflict/theme-terminal\";\nimport { FaSave, FaTimes } from \"react-icons/fa\";\nimport { useHistory, useParams, Link } from \"react-router-dom\";\nimport { backend } from \"../../server_urls\";\n\nimport isJson from \"../../utils/checkjson\";\nimport { check } from \"express-validator\";\n\nconst scenefile = require(\"../default/scene.txt\")\nconst assetfile = require(\"../default/asset.txt\")\nconst actionfile = require(\"../default/action.txt\")\nconst timelinefile = require(\"../default/timeline.txt\")\n\nconst EditFile = () => {\n  const [filename, setfilename] = useState(\"\");\n  const [data, setdata] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [grammarfor, setGrammarfor] = useState(\"\");\n  const [privateFile, setPrivateFile] = useState(false);\n  const [flag, setflag] = useState(false);\n  const [isSaved, setSaved] = useState(true);\n\n  const [scenedef, setScenedef] = useState('');\n  const [assetdef, setAssetdef] = useState('');\n  const [actiondef, setActiondef] = useState('');\n  const [timelinedef, setTimelinedef] = useState('');\n\n  const [scenedata, setSceneData] = useState('');\n  const [assetdata, setAssetData] = useState('');\n  const [actiondata, setActionData] = useState('');\n  const [timelinedata, setTimelineData] = useState('');\n\n  const history = useHistory();\n  const toast = useToast();\n  let { fileid } = useParams();\n\n  const fetchdata = async () => {\n    const jwttoken = localStorage.getItem(\"jwtToken\");\n    try {\n      const requestOptions = {\n        headers: { \"Content-Type\": \"application/json\", token: jwttoken },\n      };\n      const res = await axios.get(\n        // `http://localhost:5002/api/json/${fileid}`,\n        backend + `/api/json/${fileid}`,\n        requestOptions\n      );\n\n      if (res.data.scene != null) setSceneData(res.data.scene);\n      if (res.data.asset != null) setAssetData(res.data.asset);\n      if (res.data.action != null) setActionData(res.data.action);\n      if (res.data.timeline != null) setTimelineData(res.data.timeline);\n\n      setfilename(res.data.name);\n      setGrammarfor(res.data.grammarfor);\n      setPrivateFile(res.data.private);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const fetchDefault = async () => {\n    try {\n      const response1 = await fetch(scenefile);\n      if (!response1.ok) {\n        throw new Error('Network response was not ok.');\n      }\n      const data1 = await response1.text();\n      setScenedef(data1);\n\n      const response2 = await fetch(assetfile);\n      if (!response2.ok) {\n        throw new Error('Network response was not ok.');\n      }\n      const data2 = await response2.text();\n      setAssetdef(data2);\n\n      const response3 = await fetch(actionfile);\n      if (!response3.ok) {\n        throw new Error('Network response was not ok.');\n      }\n      const data3 = await response3.text();\n      setActiondef(data3);\n\n      const response4 = await fetch(timelinefile);\n      if (!response4.ok) {\n        throw new Error('Network response was not ok.');\n      }\n      const data4 = await response4.text();\n      setTimelinedef(data4);\n    } catch (error) {\n      console.error('Error fetching data:', error);\n    }\n  }\n\n  useEffect(() => {\n    setLoading(true)\n    fetchdata();\n    fetchDefault();\n    setLoading(false);\n  }, []);\n\n  function onChange(newValue) {\n    setdata(newValue);\n    setSaved(false);\n  }\n\n  const handleGrammar = (value) => {\n    setflag(false);\n    setGrammarfor(value);\n    if (value === \"scene\") setdata(scenedata);\n    if (value === \"asset\") setdata(assetdata);\n    if (value === \"action\") setdata(actiondata);\n    if (value === \"timeline\") setdata(timelinedata);\n  }\n\n  const handleSwitch = () => {\n    setSaved(false);\n    if (!flag) {\n      if (grammarfor === \"scene\") setdata(scenedef);\n      if (grammarfor === \"asset\") setdata(assetdef);\n      if (grammarfor === \"action\") setdata(actiondef);\n      if (grammarfor === \"timeline\") setdata(timelinedef);\n      setflag(true)\n    }\n    else {\n      // setdata(\"\");\n      if (grammarfor === \"scene\") setdata(scenedata);\n      if (grammarfor === \"asset\") setdata(assetdata);\n      if (grammarfor === \"action\") setdata(actiondata);\n      if (grammarfor === \"timeline\") setdata(timelinedata);\n      setflag(false)\n    }\n  }\n\n  const saveFiles = async () => {\n    if (!isJson(data)) {\n      toast({\n        title: \"JSON Syntax is not correct\",\n        status: \"error\",\n        duration: 5000,\n        isClosable: true,\n        position: \"top\",\n      });\n      return;\n    }\n\n    const jwttoken = localStorage.getItem(\"jwtToken\");\n    setLoading(true);\n\n    try {\n      const requestOptions = {\n        headers: { \"Content-Type\": \"application/json\", token: jwttoken },\n      };\n\n      let url = backend;\n      if (grammarfor === \"scene\") {\n        url = url + `/api/json/${fileid}/scene`;\n        setSceneData(data);\n      }\n      if (grammarfor === \"action\") {\n        url = url + `/api/json/${fileid}/action`;\n        setActionData(data);\n      }\n      if (grammarfor === \"asset\") {\n        url = url + `/api/json/${fileid}/asset`;\n        setAssetData(data);\n      }\n      if (grammarfor === \"timeline\") {\n        url = url + `/api/json/${fileid}/timeline`;\n        setTimelineData(data);\n      }\n      setSaved(true);\n\n      await axios.patch(\n        url,\n        { data, name: filename, grammarfor },\n        requestOptions\n      );\n      // history.push(\"/myfiles\");\n      setLoading(false);\n      toast({\n        title: \"File updated successfully\",\n        status: \"success\",\n        duration: 5000,\n        isClosable: true,\n        position: \"top-right\",\n      });\n    } catch (error) {\n      console.log(error);\n    }\n    setflag(false);\n  }\n\n  return loading ? (\n    <>\n      <Flex\n        width={\"100vw\"}\n        height={\"85vh\"}\n        justifyContent=\"center\"\n        alignItems={\"center\"}\n      >\n        <Spinner\n          thickness=\"4px\"\n          speed=\"0.65s\"\n          emptyColor=\"gray.200\"\n          color=\"blue.500\"\n          size=\"xl\"\n        />\n      </Flex>\n    </>\n  ) : (\n    <Box minH={\"85vh\"}>\n      <Breadcrumb\n        spacing=\"8px\"\n        pt={5}\n        pl={5}\n        separator={<ChevronRightIcon color=\"gray.500\" />}\n      >\n        <BreadcrumbItem>\n          <BreadcrumbLink as={Link} to=\"/myfiles\">\n            My Validators\n          </BreadcrumbLink>\n        </BreadcrumbItem>\n\n        <BreadcrumbItem isCurrentPage>\n          <BreadcrumbLink>{filename}</BreadcrumbLink>\n        </BreadcrumbItem>\n      </Breadcrumb>\n      <Flex\n        flexDir={\"column\"}\n        justifyContent={\"center\"}\n        alignItems=\"center\"\n        py=\"50px\"\n      >\n        <Flex\n          boxShadow={\"xl\"}\n          p={8}\n          rounded={\"xl\"}\n          align={\"center\"}\n          borderWidth={\"1px\"}\n          borderColor=\"gray.400\"\n          mb={5}\n        >\n          <Flex justifyContent=\"center\" flexDir={\"column\"}>\n            <RadioGroup onChange={handleGrammar} value={grammarfor} py={2}>\n              <Stack direction=\"row\">\n                <Radio isReadOnly={!isSaved} value=\"scene\">Scene</Radio>\n                <Radio isReadOnly={!isSaved} value=\"asset\">Asset</Radio>\n                <Radio isReadOnly={!isSaved} value=\"action\">Action</Radio>\n                <Radio isReadOnly={!isSaved} value=\"timeline\">Timeline</Radio>\n              </Stack>\n            </RadioGroup>\n            <FormControl display=\"flex\" justifyContent=\"center\" pb={2}>\n              <FormLabel htmlFor=\"public-file\" mb=\"0\">\n                DEFAULT\n              </FormLabel>\n              <Switch\n                id=\"public-file\"\n                defaultChecked={false}\n                isChecked={flag}\n                onChange={handleSwitch}\n              />\n            </FormControl>\n          </Flex>\n        </Flex>\n\n        <Box mx={\"40px\"}>\n          <AceEditor\n            fontSize={16}\n            showPrintMargin={true}\n            showGutter={true}\n            highlightActiveLine={true}\n            setOptions={{\n              enableBasicAutocompletion: true,\n              enableLiveAutocompletion: true,\n              enableSnippets: false,\n              showLineNumbers: true,\n              tabSize: 2,\n            }}\n            mode=\"json\"\n            theme=\"terminal\"\n            onChange={onChange}\n            value={data}\n            name=\"grammar-editor\"\n            id=\"grammar-editor\"\n            wrapEnabled\n            height=\"40em\"\n            width=\"60em\"\n          />\n        </Box>\n        <Center minW=\"max-content\" justifyContent={\"center\"} my={\"20px\"}>\n          <Button\n            leftIcon={<FaSave />}\n            colorScheme=\"yellow\"\n            // disabled={!filename || !data}\n            disabled={isSaved}\n            onClick={() => {saveFiles()}}\n            isLoading={loading}\n          >\n            Save Validator\n          </Button>\n          <Button\n            leftIcon={<FaTimes />}\n            colorScheme=\"yellow\"\n            disabled={!isSaved}\n            onClick={() => {\n              history.push(\"/myfiles\");\n            }}\n            isLoading={loading}\n          >\n            Exit\n          </Button>\n        </Center>\n      </Flex>\n    </Box>\n  );\n};\n\nexport default EditFile;\n"]},"metadata":{},"sourceType":"module"}