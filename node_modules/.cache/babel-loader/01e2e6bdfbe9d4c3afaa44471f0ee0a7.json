{"ast":null,"code":"import { RawTask } from './RawTask.js';\nexport class TaskFactory {\n  create(task) {\n    const tasks = this.freeTasks;\n    const t1 = tasks.length ? tasks.pop() : new RawTask(this.onError, t => tasks[tasks.length] = t);\n    t1.task = task;\n    return t1;\n  }\n\n  constructor(onError) {\n    this.onError = onError;\n    this.freeTasks = [];\n  }\n\n}","map":{"version":3,"sources":["../src/TaskFactory.ts"],"names":["RawTask","TaskFactory","freeTasks","onError","create","task","tasks","t","length","pop"],"mappings":"AAAA,SAASA,OAAT,QAAwB,cAAxB;AAGA,OAAO,MAAMC,WAAN,CAAiB;AAKhBG,EAAAA,MAAM,CAACC,IAAD,EAAyB;AACrC,UAAMC,KAAK,GAAG,KAAKJ,SAAnB;AACA,UAAMK,EAAC,GAAGD,KAAK,CAACE,MAANF,GACNA,KAAK,CAACG,GAANH,EADMA,GAEP,IAAIN,OAAJ,CAAY,KAAKG,OAAjB,EAA2BI,CAAD,IAAQD,KAAK,CAACA,KAAK,CAACE,MAAP,CAALF,GAAsBC,CAAxD,CAFH;AAGAA,IAAAA,EAAC,CAACF,IAAFE,GAASF,IAATE;AACA,WAAOA,EAAP;AACA;;AATD,EAAA,WAAA,CAA2BJ,OAA3B,EAAwD;SAA7BA,O,GAAAA,O;SAFnBD,S,GAAuB,E;AAE2B;;AAHnC","sourcesContent":["import { RawTask } from './RawTask.js'\nimport type { Task } from './types.js'\n\nexport class TaskFactory {\n\tprivate freeTasks: RawTask[] = []\n\n\tpublic constructor(private onError: (err: any) => void) {}\n\n\tpublic create(task: () => void): Task {\n\t\tconst tasks = this.freeTasks\n\t\tconst t = tasks.length\n\t\t\t? (tasks.pop() as RawTask)\n\t\t\t: new RawTask(this.onError, (t) => (tasks[tasks.length] = t))\n\t\tt.task = task\n\t\treturn t\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}