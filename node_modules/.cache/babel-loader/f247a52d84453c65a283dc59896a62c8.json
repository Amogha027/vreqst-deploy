{"ast":null,"code":"ace.define(\"ace/snippets\", [\"require\", \"exports\", \"module\", \"ace/lib/dom\", \"ace/lib/oop\", \"ace/lib/event_emitter\", \"ace/lib/lang\", \"ace/range\", \"ace/range_list\", \"ace/keyboard/hash_handler\", \"ace/tokenizer\", \"ace/clipboard\", \"ace/editor\"], function (require, exports, module) {\n  \"use strict\";\n\n  var dom = require(\"./lib/dom\");\n\n  var oop = require(\"./lib/oop\");\n\n  var EventEmitter = require(\"./lib/event_emitter\").EventEmitter;\n\n  var lang = require(\"./lib/lang\");\n\n  var Range = require(\"./range\").Range;\n\n  var RangeList = require(\"./range_list\").RangeList;\n\n  var HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\n\n  var Tokenizer = require(\"./tokenizer\").Tokenizer;\n\n  var clipboard = require(\"./clipboard\");\n\n  var VARIABLES = {\n    CURRENT_WORD: function CURRENT_WORD(editor) {\n      return editor.session.getTextRange(editor.session.getWordRange());\n    },\n    SELECTION: function SELECTION(editor, name, indentation) {\n      var text = editor.session.getTextRange();\n      if (indentation) return text.replace(/\\n\\r?([ \\t]*\\S)/g, \"\\n\" + indentation + \"$1\");\n      return text;\n    },\n    CURRENT_LINE: function CURRENT_LINE(editor) {\n      return editor.session.getLine(editor.getCursorPosition().row);\n    },\n    PREV_LINE: function PREV_LINE(editor) {\n      return editor.session.getLine(editor.getCursorPosition().row - 1);\n    },\n    LINE_INDEX: function LINE_INDEX(editor) {\n      return editor.getCursorPosition().row;\n    },\n    LINE_NUMBER: function LINE_NUMBER(editor) {\n      return editor.getCursorPosition().row + 1;\n    },\n    SOFT_TABS: function SOFT_TABS(editor) {\n      return editor.session.getUseSoftTabs() ? \"YES\" : \"NO\";\n    },\n    TAB_SIZE: function TAB_SIZE(editor) {\n      return editor.session.getTabSize();\n    },\n    CLIPBOARD: function CLIPBOARD(editor) {\n      return clipboard.getText && clipboard.getText();\n    },\n    FILENAME: function FILENAME(editor) {\n      return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0];\n    },\n    FILENAME_BASE: function FILENAME_BASE(editor) {\n      return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0].replace(/\\.[^.]*$/, \"\");\n    },\n    DIRECTORY: function DIRECTORY(editor) {\n      return this.FILEPATH(editor).replace(/[^/\\\\]*$/, \"\");\n    },\n    FILEPATH: function FILEPATH(editor) {\n      return \"/not implemented.txt\";\n    },\n    WORKSPACE_NAME: function WORKSPACE_NAME() {\n      return \"Unknown\";\n    },\n    FULLNAME: function FULLNAME() {\n      return \"Unknown\";\n    },\n    BLOCK_COMMENT_START: function BLOCK_COMMENT_START(editor) {\n      var mode = editor.session.$mode || {};\n      return mode.blockComment && mode.blockComment.start || \"\";\n    },\n    BLOCK_COMMENT_END: function BLOCK_COMMENT_END(editor) {\n      var mode = editor.session.$mode || {};\n      return mode.blockComment && mode.blockComment.end || \"\";\n    },\n    LINE_COMMENT: function LINE_COMMENT(editor) {\n      var mode = editor.session.$mode || {};\n      return mode.lineCommentStart || \"\";\n    },\n    CURRENT_YEAR: date.bind(null, {\n      year: \"numeric\"\n    }),\n    CURRENT_YEAR_SHORT: date.bind(null, {\n      year: \"2-digit\"\n    }),\n    CURRENT_MONTH: date.bind(null, {\n      month: \"numeric\"\n    }),\n    CURRENT_MONTH_NAME: date.bind(null, {\n      month: \"long\"\n    }),\n    CURRENT_MONTH_NAME_SHORT: date.bind(null, {\n      month: \"short\"\n    }),\n    CURRENT_DATE: date.bind(null, {\n      day: \"2-digit\"\n    }),\n    CURRENT_DAY_NAME: date.bind(null, {\n      weekday: \"long\"\n    }),\n    CURRENT_DAY_NAME_SHORT: date.bind(null, {\n      weekday: \"short\"\n    }),\n    CURRENT_HOUR: date.bind(null, {\n      hour: \"2-digit\",\n      hour12: false\n    }),\n    CURRENT_MINUTE: date.bind(null, {\n      minute: \"2-digit\"\n    }),\n    CURRENT_SECOND: date.bind(null, {\n      second: \"2-digit\"\n    })\n  };\n  VARIABLES.SELECTED_TEXT = VARIABLES.SELECTION;\n\n  function date(dateFormat) {\n    var str = new Date().toLocaleString(\"en-us\", dateFormat);\n    return str.length == 1 ? \"0\" + str : str;\n  }\n\n  var SnippetManager =\n  /** @class */\n  function () {\n    function SnippetManager() {\n      this.snippetMap = {};\n      this.snippetNameMap = {};\n      this.variables = VARIABLES;\n    }\n\n    SnippetManager.prototype.getTokenizer = function () {\n      return SnippetManager[\"$tokenizer\"] || this.createTokenizer();\n    };\n\n    SnippetManager.prototype.createTokenizer = function () {\n      function TabstopToken(str) {\n        str = str.substr(1);\n        if (/^\\d+$/.test(str)) return [{\n          tabstopId: parseInt(str, 10)\n        }];\n        return [{\n          text: str\n        }];\n      }\n\n      function escape(ch) {\n        return \"(?:[^\\\\\\\\\" + ch + \"]|\\\\\\\\.)\";\n      }\n\n      var formatMatcher = {\n        regex: \"/(\" + escape(\"/\") + \"+)/\",\n        onMatch: function onMatch(val, state, stack) {\n          var ts = stack[0];\n          ts.fmtString = true;\n          ts.guard = val.slice(1, -1);\n          ts.flag = \"\";\n          return \"\";\n        },\n        next: \"formatString\"\n      };\n      SnippetManager[\"$tokenizer\"] = new Tokenizer({\n        start: [{\n          regex: /\\\\./,\n          onMatch: function onMatch(val, state, stack) {\n            var ch = val[1];\n\n            if (ch == \"}\" && stack.length) {\n              val = ch;\n            } else if (\"`$\\\\\".indexOf(ch) != -1) {\n              val = ch;\n            }\n\n            return [val];\n          }\n        }, {\n          regex: /}/,\n          onMatch: function onMatch(val, state, stack) {\n            return [stack.length ? stack.shift() : val];\n          }\n        }, {\n          regex: /\\$(?:\\d+|\\w+)/,\n          onMatch: TabstopToken\n        }, {\n          regex: /\\$\\{[\\dA-Z_a-z]+/,\n          onMatch: function onMatch(str, state, stack) {\n            var t = TabstopToken(str.substr(1));\n            stack.unshift(t[0]);\n            return t;\n          },\n          next: \"snippetVar\"\n        }, {\n          regex: /\\n/,\n          token: \"newline\",\n          merge: false\n        }],\n        snippetVar: [{\n          regex: \"\\\\|\" + escape(\"\\\\|\") + \"*\\\\|\",\n          onMatch: function onMatch(val, state, stack) {\n            var choices = val.slice(1, -1).replace(/\\\\[,|\\\\]|,/g, function (operator) {\n              return operator.length == 2 ? operator[1] : \"\\x00\";\n            }).split(\"\\x00\").map(function (value) {\n              return {\n                value: value\n              };\n            });\n            stack[0].choices = choices;\n            return [choices[0]];\n          },\n          next: \"start\"\n        }, formatMatcher, {\n          regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\",\n          token: \"\",\n          next: \"start\"\n        }],\n        formatString: [{\n          regex: /:/,\n          onMatch: function onMatch(val, state, stack) {\n            if (stack.length && stack[0].expectElse) {\n              stack[0].expectElse = false;\n              stack[0].ifEnd = {\n                elseEnd: stack[0]\n              };\n              return [stack[0].ifEnd];\n            }\n\n            return \":\";\n          }\n        }, {\n          regex: /\\\\./,\n          onMatch: function onMatch(val, state, stack) {\n            var ch = val[1];\n            if (ch == \"}\" && stack.length) val = ch;else if (\"`$\\\\\".indexOf(ch) != -1) val = ch;else if (ch == \"n\") val = \"\\n\";else if (ch == \"t\") val = \"\\t\";else if (\"ulULE\".indexOf(ch) != -1) val = {\n              changeCase: ch,\n              local: ch > \"a\"\n            };\n            return [val];\n          }\n        }, {\n          regex: \"/\\\\w*}\",\n          onMatch: function onMatch(val, state, stack) {\n            var next = stack.shift();\n            if (next) next.flag = val.slice(1, -1);\n            this.next = next && next.tabstopId ? \"start\" : \"\";\n            return [next || val];\n          },\n          next: \"start\"\n        }, {\n          regex: /\\$(?:\\d+|\\w+)/,\n          onMatch: function onMatch(val, state, stack) {\n            return [{\n              text: val.slice(1)\n            }];\n          }\n        }, {\n          regex: /\\${\\w+/,\n          onMatch: function onMatch(val, state, stack) {\n            var token = {\n              text: val.slice(2)\n            };\n            stack.unshift(token);\n            return [token];\n          },\n          next: \"formatStringVar\"\n        }, {\n          regex: /\\n/,\n          token: \"newline\",\n          merge: false\n        }, {\n          regex: /}/,\n          onMatch: function onMatch(val, state, stack) {\n            var next = stack.shift();\n            this.next = next && next.tabstopId ? \"start\" : \"\";\n            return [next || val];\n          },\n          next: \"start\"\n        }],\n        formatStringVar: [{\n          regex: /:\\/\\w+}/,\n          onMatch: function onMatch(val, state, stack) {\n            var ts = stack[0];\n            ts.formatFunction = val.slice(2, -1);\n            return [stack.shift()];\n          },\n          next: \"formatString\"\n        }, formatMatcher, {\n          regex: /:[\\?\\-+]?/,\n          onMatch: function onMatch(val, state, stack) {\n            if (val[1] == \"+\") stack[0].ifEnd = stack[0];\n            if (val[1] == \"?\") stack[0].expectElse = true;\n          },\n          next: \"formatString\"\n        }, {\n          regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\",\n          token: \"\",\n          next: \"formatString\"\n        }]\n      });\n      return SnippetManager[\"$tokenizer\"];\n    };\n\n    SnippetManager.prototype.tokenizeTmSnippet = function (str, startState) {\n      return this.getTokenizer().getLineTokens(str, startState).tokens.map(function (x) {\n        return x.value || x;\n      });\n    };\n\n    SnippetManager.prototype.getVariableValue = function (editor, name, indentation) {\n      if (/^\\d+$/.test(name)) return (this.variables.__ || {})[name] || \"\";\n      if (/^[A-Z]\\d+$/.test(name)) return (this.variables[name[0] + \"__\"] || {})[name.substr(1)] || \"\";\n      name = name.replace(/^TM_/, \"\");\n      if (!this.variables.hasOwnProperty(name)) return \"\";\n      var value = this.variables[name];\n      if (typeof value == \"function\") value = this.variables[name](editor, name, indentation);\n      return value == null ? \"\" : value;\n    };\n\n    SnippetManager.prototype.tmStrFormat = function (str, ch, editor) {\n      if (!ch.fmt) return str;\n      var flag = ch.flag || \"\";\n      var re = ch.guard;\n      re = new RegExp(re, flag.replace(/[^gim]/g, \"\"));\n      var fmtTokens = typeof ch.fmt == \"string\" ? this.tokenizeTmSnippet(ch.fmt, \"formatString\") : ch.fmt;\n\n      var _self = this;\n\n      var formatted = str.replace(re, function () {\n        var oldArgs = _self.variables.__;\n        _self.variables.__ = [].slice.call(arguments);\n\n        var fmtParts = _self.resolveVariables(fmtTokens, editor);\n\n        var gChangeCase = \"E\";\n\n        for (var i = 0; i < fmtParts.length; i++) {\n          var ch = fmtParts[i];\n\n          if (typeof ch == \"object\") {\n            fmtParts[i] = \"\";\n\n            if (ch.changeCase && ch.local) {\n              var next = fmtParts[i + 1];\n\n              if (next && typeof next == \"string\") {\n                if (ch.changeCase == \"u\") fmtParts[i] = next[0].toUpperCase();else fmtParts[i] = next[0].toLowerCase();\n                fmtParts[i + 1] = next.substr(1);\n              }\n            } else if (ch.changeCase) {\n              gChangeCase = ch.changeCase;\n            }\n          } else if (gChangeCase == \"U\") {\n            fmtParts[i] = ch.toUpperCase();\n          } else if (gChangeCase == \"L\") {\n            fmtParts[i] = ch.toLowerCase();\n          }\n        }\n\n        _self.variables.__ = oldArgs;\n        return fmtParts.join(\"\");\n      });\n      return formatted;\n    };\n\n    SnippetManager.prototype.tmFormatFunction = function (str, ch, editor) {\n      if (ch.formatFunction == \"upcase\") return str.toUpperCase();\n      if (ch.formatFunction == \"downcase\") return str.toLowerCase();\n      return str;\n    };\n\n    SnippetManager.prototype.resolveVariables = function (snippet, editor) {\n      var result = [];\n      var indentation = \"\";\n      var afterNewLine = true;\n\n      for (var i = 0; i < snippet.length; i++) {\n        var ch = snippet[i];\n\n        if (typeof ch == \"string\") {\n          result.push(ch);\n\n          if (ch == \"\\n\") {\n            afterNewLine = true;\n            indentation = \"\";\n          } else if (afterNewLine) {\n            indentation = /^\\t*/.exec(ch)[0];\n            afterNewLine = /\\S/.test(ch);\n          }\n\n          continue;\n        }\n\n        if (!ch) continue;\n        afterNewLine = false;\n\n        if (ch.fmtString) {\n          var j = snippet.indexOf(ch, i + 1);\n          if (j == -1) j = snippet.length;\n          ch.fmt = snippet.slice(i + 1, j);\n          i = j;\n        }\n\n        if (ch.text) {\n          var value = this.getVariableValue(editor, ch.text, indentation) + \"\";\n          if (ch.fmtString) value = this.tmStrFormat(value, ch, editor);\n          if (ch.formatFunction) value = this.tmFormatFunction(value, ch, editor);\n\n          if (value && !ch.ifEnd) {\n            result.push(value);\n            gotoNext(ch);\n          } else if (!value && ch.ifEnd) {\n            gotoNext(ch.ifEnd);\n          }\n        } else if (ch.elseEnd) {\n          gotoNext(ch.elseEnd);\n        } else if (ch.tabstopId != null) {\n          result.push(ch);\n        } else if (ch.changeCase != null) {\n          result.push(ch);\n        }\n      }\n\n      function gotoNext(ch) {\n        var i1 = snippet.indexOf(ch, i + 1);\n        if (i1 != -1) i = i1;\n      }\n\n      return result;\n    };\n\n    SnippetManager.prototype.getDisplayTextForSnippet = function (editor, snippetText) {\n      var processedSnippet = processSnippetText.call(this, editor, snippetText);\n      return processedSnippet.text;\n    };\n\n    SnippetManager.prototype.insertSnippetForSelection = function (editor, snippetText, options) {\n      if (options === void 0) {\n        options = {};\n      }\n\n      var processedSnippet = processSnippetText.call(this, editor, snippetText, options);\n      var range = editor.getSelectionRange();\n      var end = editor.session.replace(range, processedSnippet.text);\n      var tabstopManager = new TabstopManager(editor);\n      var selectionId = editor.inVirtualSelectionMode && editor.selection.index;\n      tabstopManager.addTabstops(processedSnippet.tabstops, range.start, end, selectionId);\n    };\n\n    SnippetManager.prototype.insertSnippet = function (editor, snippetText, options) {\n      if (options === void 0) {\n        options = {};\n      }\n\n      var self = this;\n      if (editor.inVirtualSelectionMode) return self.insertSnippetForSelection(editor, snippetText, options);\n      editor.forEachSelection(function () {\n        self.insertSnippetForSelection(editor, snippetText, options);\n      }, null, {\n        keepOrder: true\n      });\n      if (editor.tabstopManager) editor.tabstopManager.tabNext();\n    };\n\n    SnippetManager.prototype.$getScope = function (editor) {\n      var scope = editor.session.$mode.$id || \"\";\n      scope = scope.split(\"/\").pop();\n\n      if (scope === \"html\" || scope === \"php\") {\n        if (scope === \"php\" && !editor.session.$mode.inlinePhp) scope = \"html\";\n        var c = editor.getCursorPosition();\n        var state = editor.session.getState(c.row);\n\n        if (typeof state === \"object\") {\n          state = state[0];\n        }\n\n        if (state.substring) {\n          if (state.substring(0, 3) == \"js-\") scope = \"javascript\";else if (state.substring(0, 4) == \"css-\") scope = \"css\";else if (state.substring(0, 4) == \"php-\") scope = \"php\";\n        }\n      }\n\n      return scope;\n    };\n\n    SnippetManager.prototype.getActiveScopes = function (editor) {\n      var scope = this.$getScope(editor);\n      var scopes = [scope];\n      var snippetMap = this.snippetMap;\n\n      if (snippetMap[scope] && snippetMap[scope].includeScopes) {\n        scopes.push.apply(scopes, snippetMap[scope].includeScopes);\n      }\n\n      scopes.push(\"_\");\n      return scopes;\n    };\n\n    SnippetManager.prototype.expandWithTab = function (editor, options) {\n      var self = this;\n      var result = editor.forEachSelection(function () {\n        return self.expandSnippetForSelection(editor, options);\n      }, null, {\n        keepOrder: true\n      });\n      if (result && editor.tabstopManager) editor.tabstopManager.tabNext();\n      return result;\n    };\n\n    SnippetManager.prototype.expandSnippetForSelection = function (editor, options) {\n      var cursor = editor.getCursorPosition();\n      var line = editor.session.getLine(cursor.row);\n      var before = line.substring(0, cursor.column);\n      var after = line.substr(cursor.column);\n      var snippetMap = this.snippetMap;\n      var snippet;\n      this.getActiveScopes(editor).some(function (scope) {\n        var snippets = snippetMap[scope];\n        if (snippets) snippet = this.findMatchingSnippet(snippets, before, after);\n        return !!snippet;\n      }, this);\n      if (!snippet) return false;\n      if (options && options.dryRun) return true;\n      editor.session.doc.removeInLine(cursor.row, cursor.column - snippet.replaceBefore.length, cursor.column + snippet.replaceAfter.length);\n      this.variables.M__ = snippet.matchBefore;\n      this.variables.T__ = snippet.matchAfter;\n      this.insertSnippetForSelection(editor, snippet.content);\n      this.variables.M__ = this.variables.T__ = null;\n      return true;\n    };\n\n    SnippetManager.prototype.findMatchingSnippet = function (snippetList, before, after) {\n      for (var i = snippetList.length; i--;) {\n        var s = snippetList[i];\n        if (s.startRe && !s.startRe.test(before)) continue;\n        if (s.endRe && !s.endRe.test(after)) continue;\n        if (!s.startRe && !s.endRe) continue;\n        s.matchBefore = s.startRe ? s.startRe.exec(before) : [\"\"];\n        s.matchAfter = s.endRe ? s.endRe.exec(after) : [\"\"];\n        s.replaceBefore = s.triggerRe ? s.triggerRe.exec(before)[0] : \"\";\n        s.replaceAfter = s.endTriggerRe ? s.endTriggerRe.exec(after)[0] : \"\";\n        return s;\n      }\n    };\n\n    SnippetManager.prototype.register = function (snippets, scope) {\n      var snippetMap = this.snippetMap;\n      var snippetNameMap = this.snippetNameMap;\n      var self = this;\n      if (!snippets) snippets = [];\n\n      function wrapRegexp(src) {\n        if (src && !/^\\^?\\(.*\\)\\$?$|^\\\\b$/.test(src)) src = \"(?:\" + src + \")\";\n        return src || \"\";\n      }\n\n      function guardedRegexp(re, guard, opening) {\n        re = wrapRegexp(re);\n        guard = wrapRegexp(guard);\n\n        if (opening) {\n          re = guard + re;\n          if (re && re[re.length - 1] != \"$\") re = re + \"$\";\n        } else {\n          re = re + guard;\n          if (re && re[0] != \"^\") re = \"^\" + re;\n        }\n\n        return new RegExp(re);\n      }\n\n      function addSnippet(s) {\n        if (!s.scope) s.scope = scope || \"_\";\n        scope = s.scope;\n\n        if (!snippetMap[scope]) {\n          snippetMap[scope] = [];\n          snippetNameMap[scope] = {};\n        }\n\n        var map = snippetNameMap[scope];\n\n        if (s.name) {\n          var old = map[s.name];\n          if (old) self.unregister(old);\n          map[s.name] = s;\n        }\n\n        snippetMap[scope].push(s);\n        if (s.prefix) s.tabTrigger = s.prefix;\n        if (!s.content && s.body) s.content = Array.isArray(s.body) ? s.body.join(\"\\n\") : s.body;\n\n        if (s.tabTrigger && !s.trigger) {\n          if (!s.guard && /^\\w/.test(s.tabTrigger)) s.guard = \"\\\\b\";\n          s.trigger = lang.escapeRegExp(s.tabTrigger);\n        }\n\n        if (!s.trigger && !s.guard && !s.endTrigger && !s.endGuard) return;\n        s.startRe = guardedRegexp(s.trigger, s.guard, true);\n        s.triggerRe = new RegExp(s.trigger);\n        s.endRe = guardedRegexp(s.endTrigger, s.endGuard, true);\n        s.endTriggerRe = new RegExp(s.endTrigger);\n      }\n\n      if (Array.isArray(snippets)) {\n        snippets.forEach(addSnippet);\n      } else {\n        Object.keys(snippets).forEach(function (key) {\n          addSnippet(snippets[key]);\n        });\n      }\n\n      this._signal(\"registerSnippets\", {\n        scope: scope\n      });\n    };\n\n    SnippetManager.prototype.unregister = function (snippets, scope) {\n      var snippetMap = this.snippetMap;\n      var snippetNameMap = this.snippetNameMap;\n\n      function removeSnippet(s) {\n        var nameMap = snippetNameMap[s.scope || scope];\n\n        if (nameMap && nameMap[s.name]) {\n          delete nameMap[s.name];\n          var map = snippetMap[s.scope || scope];\n          var i = map && map.indexOf(s);\n          if (i >= 0) map.splice(i, 1);\n        }\n      }\n\n      if (snippets.content) removeSnippet(snippets);else if (Array.isArray(snippets)) snippets.forEach(removeSnippet);\n    };\n\n    SnippetManager.prototype.parseSnippetFile = function (str) {\n      str = str.replace(/\\r/g, \"\");\n      var list = [],\n\n      /**@type{Snippet}*/\n      snippet = {};\n      var re = /^#.*|^({[\\s\\S]*})\\s*$|^(\\S+) (.*)$|^((?:\\n*\\t.*)+)/gm;\n      var m;\n\n      while (m = re.exec(str)) {\n        if (m[1]) {\n          try {\n            snippet = JSON.parse(m[1]);\n            list.push(snippet);\n          } catch (e) {}\n        }\n\n        if (m[4]) {\n          snippet.content = m[4].replace(/^\\t/gm, \"\");\n          list.push(snippet);\n          snippet = {};\n        } else {\n          var key = m[2],\n              val = m[3];\n\n          if (key == \"regex\") {\n            var guardRe = /\\/((?:[^\\/\\\\]|\\\\.)*)|$/g;\n            snippet.guard = guardRe.exec(val)[1];\n            snippet.trigger = guardRe.exec(val)[1];\n            snippet.endTrigger = guardRe.exec(val)[1];\n            snippet.endGuard = guardRe.exec(val)[1];\n          } else if (key == \"snippet\") {\n            snippet.tabTrigger = val.match(/^\\S*/)[0];\n            if (!snippet.name) snippet.name = val;\n          } else if (key) {\n            snippet[key] = val;\n          }\n        }\n      }\n\n      return list;\n    };\n\n    SnippetManager.prototype.getSnippetByName = function (name, editor) {\n      var snippetMap = this.snippetNameMap;\n      var snippet;\n      this.getActiveScopes(editor).some(function (scope) {\n        var snippets = snippetMap[scope];\n        if (snippets) snippet = snippets[name];\n        return !!snippet;\n      }, this);\n      return snippet;\n    };\n\n    return SnippetManager;\n  }();\n\n  oop.implement(SnippetManager.prototype, EventEmitter);\n\n  var processSnippetText = function processSnippetText(editor, snippetText, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var cursor = editor.getCursorPosition();\n    var line = editor.session.getLine(cursor.row);\n    var tabString = editor.session.getTabString();\n    var indentString = line.match(/^\\s*/)[0];\n    if (cursor.column < indentString.length) indentString = indentString.slice(0, cursor.column);\n    snippetText = snippetText.replace(/\\r/g, \"\");\n    var tokens = this.tokenizeTmSnippet(snippetText);\n    tokens = this.resolveVariables(tokens, editor);\n    tokens = tokens.map(function (x) {\n      if (x == \"\\n\" && !options.excludeExtraIndent) return x + indentString;\n      if (typeof x == \"string\") return x.replace(/\\t/g, tabString);\n      return x;\n    });\n    var tabstops = [];\n    tokens.forEach(function (p, i) {\n      if (typeof p != \"object\") return;\n      var id = p.tabstopId;\n      var ts = tabstops[id];\n\n      if (!ts) {\n        ts = tabstops[id] = [];\n        ts.index = id;\n        ts.value = \"\";\n        ts.parents = {};\n      }\n\n      if (ts.indexOf(p) !== -1) return;\n      if (p.choices && !ts.choices) ts.choices = p.choices;\n      ts.push(p);\n      var i1 = tokens.indexOf(p, i + 1);\n      if (i1 === -1) return;\n      var value = tokens.slice(i + 1, i1);\n      var isNested = value.some(function (t) {\n        return typeof t === \"object\";\n      });\n\n      if (isNested && !ts.value) {\n        ts.value = value;\n      } else if (value.length && (!ts.value || typeof ts.value !== \"string\")) {\n        ts.value = value.join(\"\");\n      }\n    });\n    tabstops.forEach(function (ts) {\n      ts.length = 0;\n    });\n    var expanding = {};\n\n    function copyValue(val) {\n      var copy = [];\n\n      for (var i = 0; i < val.length; i++) {\n        var p = val[i];\n\n        if (typeof p == \"object\") {\n          if (expanding[p.tabstopId]) continue;\n          var j = val.lastIndexOf(p, i - 1);\n          p = copy[j] || {\n            tabstopId: p.tabstopId\n          };\n        }\n\n        copy[i] = p;\n      }\n\n      return copy;\n    }\n\n    for (var i = 0; i < tokens.length; i++) {\n      var p = tokens[i];\n      if (typeof p != \"object\") continue;\n      var id = p.tabstopId;\n      var ts = tabstops[id];\n      var i1 = tokens.indexOf(p, i + 1);\n\n      if (expanding[id]) {\n        if (expanding[id] === p) {\n          delete expanding[id];\n          Object.keys(expanding).forEach(function (parentId) {\n            ts.parents[parentId] = true;\n          });\n        }\n\n        continue;\n      }\n\n      expanding[id] = p;\n      var value = ts.value;\n      if (typeof value !== \"string\") value = copyValue(value);else if (p.fmt) value = this.tmStrFormat(value, p, editor);\n      tokens.splice.apply(tokens, [i + 1, Math.max(0, i1 - i)].concat(value, p));\n      if (ts.indexOf(p) === -1) ts.push(p);\n    }\n\n    var row = 0,\n        column = 0;\n    var text = \"\";\n    tokens.forEach(function (t) {\n      if (typeof t === \"string\") {\n        var lines = t.split(\"\\n\");\n\n        if (lines.length > 1) {\n          column = lines[lines.length - 1].length;\n          row += lines.length - 1;\n        } else column += t.length;\n\n        text += t;\n      } else if (t) {\n        if (!t.start) t.start = {\n          row: row,\n          column: column\n        };else t.end = {\n          row: row,\n          column: column\n        };\n      }\n    });\n    return {\n      text: text,\n      tabstops: tabstops,\n      tokens: tokens\n    };\n  };\n\n  var TabstopManager =\n  /** @class */\n  function () {\n    function TabstopManager(editor) {\n      this.index = 0;\n      this.ranges = [];\n      this.tabstops = [];\n      if (editor.tabstopManager) return editor.tabstopManager;\n      editor.tabstopManager = this;\n      this.$onChange = this.onChange.bind(this);\n      this.$onChangeSelection = lang.delayedCall(this.onChangeSelection.bind(this)).schedule;\n      this.$onChangeSession = this.onChangeSession.bind(this);\n      this.$onAfterExec = this.onAfterExec.bind(this);\n      this.attach(editor);\n    }\n\n    TabstopManager.prototype.attach = function (editor) {\n      this.$openTabstops = null;\n      this.selectedTabstop = null;\n      this.editor = editor;\n      this.session = editor.session;\n      this.editor.on(\"change\", this.$onChange);\n      this.editor.on(\"changeSelection\", this.$onChangeSelection);\n      this.editor.on(\"changeSession\", this.$onChangeSession);\n      this.editor.commands.on(\"afterExec\", this.$onAfterExec);\n      this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n    };\n\n    TabstopManager.prototype.detach = function () {\n      this.tabstops.forEach(this.removeTabstopMarkers, this);\n      this.ranges.length = 0;\n      this.tabstops.length = 0;\n      this.selectedTabstop = null;\n      this.editor.off(\"change\", this.$onChange);\n      this.editor.off(\"changeSelection\", this.$onChangeSelection);\n      this.editor.off(\"changeSession\", this.$onChangeSession);\n      this.editor.commands.off(\"afterExec\", this.$onAfterExec);\n      this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n      this.editor.tabstopManager = null;\n      this.session = null;\n      this.editor = null;\n    };\n\n    TabstopManager.prototype.onChange = function (delta) {\n      var isRemove = delta.action[0] == \"r\";\n      var selectedTabstop = this.selectedTabstop || {};\n      var parents = selectedTabstop.parents || {};\n      var tabstops = this.tabstops.slice();\n\n      for (var i = 0; i < tabstops.length; i++) {\n        var ts = tabstops[i];\n        var active = ts == selectedTabstop || parents[ts.index];\n        ts.rangeList.$bias = active ? 0 : 1;\n\n        if (delta.action == \"remove\" && ts !== selectedTabstop) {\n          var parentActive = ts.parents && ts.parents[selectedTabstop.index];\n          var startIndex = ts.rangeList.pointIndex(delta.start, parentActive);\n          startIndex = startIndex < 0 ? -startIndex - 1 : startIndex + 1;\n          var endIndex = ts.rangeList.pointIndex(delta.end, parentActive);\n          endIndex = endIndex < 0 ? -endIndex - 1 : endIndex - 1;\n          var toRemove = ts.rangeList.ranges.slice(startIndex, endIndex);\n\n          for (var j = 0; j < toRemove.length; j++) {\n            this.removeRange(toRemove[j]);\n          }\n        }\n\n        ts.rangeList.$onChange(delta);\n      }\n\n      var session = this.session;\n      if (!this.$inChange && isRemove && session.getLength() == 1 && !session.getValue()) this.detach();\n    };\n\n    TabstopManager.prototype.updateLinkedFields = function () {\n      var ts = this.selectedTabstop;\n      if (!ts || !ts.hasLinkedRanges || !ts.firstNonLinked) return;\n      this.$inChange = true;\n      var session = this.session;\n      var text = session.getTextRange(ts.firstNonLinked);\n\n      for (var i = 0; i < ts.length; i++) {\n        var range = ts[i];\n        if (!range.linked) continue;\n        var original = range.original;\n        var fmt = exports.snippetManager.tmStrFormat(text, original, this.editor);\n        session.replace(range, fmt);\n      }\n\n      this.$inChange = false;\n    };\n\n    TabstopManager.prototype.onAfterExec = function (e) {\n      if (e.command && !e.command.readOnly) this.updateLinkedFields();\n    };\n\n    TabstopManager.prototype.onChangeSelection = function () {\n      if (!this.editor) return;\n      var lead = this.editor.selection.lead;\n      var anchor = this.editor.selection.anchor;\n      var isEmpty = this.editor.selection.isEmpty();\n\n      for (var i = 0; i < this.ranges.length; i++) {\n        if (this.ranges[i].linked) continue;\n        var containsLead = this.ranges[i].contains(lead.row, lead.column);\n        var containsAnchor = isEmpty || this.ranges[i].contains(anchor.row, anchor.column);\n        if (containsLead && containsAnchor) return;\n      }\n\n      this.detach();\n    };\n\n    TabstopManager.prototype.onChangeSession = function () {\n      this.detach();\n    };\n\n    TabstopManager.prototype.tabNext = function (dir) {\n      var max = this.tabstops.length;\n      var index = this.index + (dir || 1);\n      index = Math.min(Math.max(index, 1), max);\n      if (index == max) index = 0;\n      this.selectTabstop(index);\n      this.updateTabstopMarkers();\n\n      if (index === 0) {\n        this.detach();\n      }\n    };\n\n    TabstopManager.prototype.selectTabstop = function (index) {\n      this.$openTabstops = null;\n      var ts = this.tabstops[this.index];\n      if (ts) this.addTabstopMarkers(ts);\n      this.index = index;\n      ts = this.tabstops[this.index];\n      if (!ts || !ts.length) return;\n      this.selectedTabstop = ts;\n      var range = ts.firstNonLinked || ts;\n      if (ts.choices) range.cursor = range.start;\n\n      if (!this.editor.inVirtualSelectionMode) {\n        var sel = this.editor.multiSelect;\n        sel.toSingleRange(range);\n\n        for (var i = 0; i < ts.length; i++) {\n          if (ts.hasLinkedRanges && ts[i].linked) continue;\n          sel.addRange(ts[i].clone(), true);\n        }\n      } else {\n        this.editor.selection.fromOrientedRange(range);\n      }\n\n      this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n      if (this.selectedTabstop && this.selectedTabstop.choices) this.editor.execCommand(\"startAutocomplete\", {\n        matches: this.selectedTabstop.choices\n      });\n    };\n\n    TabstopManager.prototype.addTabstops = function (tabstops, start, end) {\n      var useLink = this.useLink || !this.editor.getOption(\"enableMultiselect\");\n      if (!this.$openTabstops) this.$openTabstops = [];\n\n      if (!tabstops[0]) {\n        var p = Range.fromPoints(end, end);\n        moveRelative(p.start, start);\n        moveRelative(p.end, start);\n        tabstops[0] = [p];\n        tabstops[0].index = 0;\n      }\n\n      var i = this.index;\n      var arg = [i + 1, 0];\n      var ranges = this.ranges;\n      var snippetId = this.snippetId = (this.snippetId || 0) + 1;\n      tabstops.forEach(function (ts, index) {\n        var dest = this.$openTabstops[index] || ts;\n        dest.snippetId = snippetId;\n\n        for (var i = 0; i < ts.length; i++) {\n          var p = ts[i];\n          var range = Range.fromPoints(p.start, p.end || p.start);\n          movePoint(range.start, start);\n          movePoint(range.end, start);\n          range.original = p;\n          range.tabstop = dest;\n          ranges.push(range);\n          if (dest != ts) dest.unshift(range);else dest[i] = range;\n\n          if (p.fmtString || dest.firstNonLinked && useLink) {\n            range.linked = true;\n            dest.hasLinkedRanges = true;\n          } else if (!dest.firstNonLinked) dest.firstNonLinked = range;\n        }\n\n        if (!dest.firstNonLinked) dest.hasLinkedRanges = false;\n\n        if (dest === ts) {\n          arg.push(dest);\n          this.$openTabstops[index] = dest;\n        }\n\n        this.addTabstopMarkers(dest);\n        dest.rangeList = dest.rangeList || new RangeList();\n        dest.rangeList.$bias = 0;\n        dest.rangeList.addList(dest);\n      }, this);\n\n      if (arg.length > 2) {\n        if (this.tabstops.length) arg.push(arg.splice(2, 1)[0]);\n        this.tabstops.splice.apply(this.tabstops, arg);\n      }\n    };\n\n    TabstopManager.prototype.addTabstopMarkers = function (ts) {\n      var session = this.session;\n      ts.forEach(function (range) {\n        if (!range.markerId) range.markerId = session.addMarker(range, \"ace_snippet-marker\", \"text\");\n      });\n    };\n\n    TabstopManager.prototype.removeTabstopMarkers = function (ts) {\n      var session = this.session;\n      ts.forEach(function (range) {\n        session.removeMarker(range.markerId);\n        range.markerId = null;\n      });\n    };\n\n    TabstopManager.prototype.updateTabstopMarkers = function () {\n      if (!this.selectedTabstop) return;\n      var currentSnippetId = this.selectedTabstop.snippetId;\n\n      if (this.selectedTabstop.index === 0) {\n        currentSnippetId--;\n      }\n\n      this.tabstops.forEach(function (ts) {\n        if (ts.snippetId === currentSnippetId) this.addTabstopMarkers(ts);else this.removeTabstopMarkers(ts);\n      }, this);\n    };\n\n    TabstopManager.prototype.removeRange = function (range) {\n      var i = range.tabstop.indexOf(range);\n      if (i != -1) range.tabstop.splice(i, 1);\n      i = this.ranges.indexOf(range);\n      if (i != -1) this.ranges.splice(i, 1);\n      i = range.tabstop.rangeList.ranges.indexOf(range);\n      if (i != -1) range.tabstop.splice(i, 1);\n      this.session.removeMarker(range.markerId);\n\n      if (!range.tabstop.length) {\n        i = this.tabstops.indexOf(range.tabstop);\n        if (i != -1) this.tabstops.splice(i, 1);\n        if (!this.tabstops.length) this.detach();\n      }\n    };\n\n    return TabstopManager;\n  }();\n\n  TabstopManager.prototype.keyboardHandler = new HashHandler();\n  TabstopManager.prototype.keyboardHandler.bindKeys({\n    \"Tab\": function Tab(editor) {\n      if (exports.snippetManager && exports.snippetManager.expandWithTab(editor)) return;\n      editor.tabstopManager.tabNext(1);\n      editor.renderer.scrollCursorIntoView();\n    },\n    \"Shift-Tab\": function ShiftTab(editor) {\n      editor.tabstopManager.tabNext(-1);\n      editor.renderer.scrollCursorIntoView();\n    },\n    \"Esc\": function Esc(editor) {\n      editor.tabstopManager.detach();\n    }\n  });\n\n  var movePoint = function movePoint(point, diff) {\n    if (point.row == 0) point.column += diff.column;\n    point.row += diff.row;\n  };\n\n  var moveRelative = function moveRelative(point, start) {\n    if (point.row == start.row) point.column -= start.column;\n    point.row -= start.row;\n  };\n\n  dom.importCssString(\"\\n.ace_snippet-marker {\\n    -moz-box-sizing: border-box;\\n    box-sizing: border-box;\\n    background: rgba(194, 193, 208, 0.09);\\n    border: 1px dotted rgba(211, 208, 235, 0.62);\\n    position: absolute;\\n}\", \"snippets.css\", false);\n  exports.snippetManager = new SnippetManager();\n\n  var Editor = require(\"./editor\").Editor;\n\n  (function () {\n    this.insertSnippet = function (content, options) {\n      return exports.snippetManager.insertSnippet(this, content, options);\n    };\n\n    this.expandSnippet = function (options) {\n      return exports.snippetManager.expandWithTab(this, options);\n    };\n  }).call(Editor.prototype);\n});\nace.define(\"ace/autocomplete/popup\", [\"require\", \"exports\", \"module\", \"ace/virtual_renderer\", \"ace/editor\", \"ace/range\", \"ace/lib/event\", \"ace/lib/lang\", \"ace/lib/dom\", \"ace/config\", \"ace/lib/useragent\"], function (require, exports, module) {\n  \"use strict\";\n\n  var Renderer = require(\"../virtual_renderer\").VirtualRenderer;\n\n  var Editor = require(\"../editor\").Editor;\n\n  var Range = require(\"../range\").Range;\n\n  var event = require(\"../lib/event\");\n\n  var lang = require(\"../lib/lang\");\n\n  var dom = require(\"../lib/dom\");\n\n  var nls = require(\"../config\").nls;\n\n  var userAgent = require(\"./../lib/useragent\");\n\n  var getAriaId = function getAriaId(index) {\n    return \"suggest-aria-id:\".concat(index);\n  };\n\n  var popupAriaRole = userAgent.isSafari ? \"menu\" : \"listbox\";\n  var optionAriaRole = userAgent.isSafari ? \"menuitem\" : \"option\";\n  var ariaActiveState = userAgent.isSafari ? \"aria-current\" : \"aria-selected\";\n\n  var $singleLineEditor = function $singleLineEditor(el) {\n    var renderer = new Renderer(el);\n    renderer.$maxLines = 4;\n    var editor = new Editor(renderer);\n    editor.setHighlightActiveLine(false);\n    editor.setShowPrintMargin(false);\n    editor.renderer.setShowGutter(false);\n    editor.renderer.setHighlightGutterLine(false);\n    editor.$mouseHandler.$focusTimeout = 0;\n    editor.$highlightTagPending = true;\n    return editor;\n  };\n\n  var AcePopup =\n  /** @class */\n  function () {\n    function AcePopup(parentNode) {\n      var el = dom.createElement(\"div\");\n      var popup = $singleLineEditor(el);\n\n      if (parentNode) {\n        parentNode.appendChild(el);\n      }\n\n      el.style.display = \"none\";\n      popup.renderer.content.style.cursor = \"default\";\n      popup.renderer.setStyle(\"ace_autocomplete\");\n      popup.renderer.$textLayer.element.setAttribute(\"role\", popupAriaRole);\n      popup.renderer.$textLayer.element.setAttribute(\"aria-roledescription\", nls(\"Autocomplete suggestions\"));\n      popup.renderer.$textLayer.element.setAttribute(\"aria-label\", nls(\"Autocomplete suggestions\"));\n      popup.renderer.textarea.setAttribute(\"aria-hidden\", \"true\");\n      popup.setOption(\"displayIndentGuides\", false);\n      popup.setOption(\"dragDelay\", 150);\n\n      var noop = function noop() {};\n\n      popup.focus = noop;\n      popup.$isFocused = true;\n      popup.renderer.$cursorLayer.restartTimer = noop;\n      popup.renderer.$cursorLayer.element.style.opacity = \"0\";\n      popup.renderer.$maxLines = 8;\n      popup.renderer.$keepTextAreaAtCursor = false;\n      popup.setHighlightActiveLine(false);\n      popup.session.highlight(\"\");\n      popup.session.$searchHighlight.clazz = \"ace_highlight-marker\";\n      popup.on(\"mousedown\", function (e) {\n        var pos = e.getDocumentPosition();\n        popup.selection.moveToPosition(pos);\n        selectionMarker.start.row = selectionMarker.end.row = pos.row;\n        e.stop();\n      });\n      var lastMouseEvent;\n      var hoverMarker = new Range(-1, 0, -1, Infinity);\n      var selectionMarker = new Range(-1, 0, -1, Infinity);\n      selectionMarker.id = popup.session.addMarker(selectionMarker, \"ace_active-line\", \"fullLine\");\n\n      popup.setSelectOnHover = function (val) {\n        if (!val) {\n          hoverMarker.id = popup.session.addMarker(hoverMarker, \"ace_line-hover\", \"fullLine\");\n        } else if (hoverMarker.id) {\n          popup.session.removeMarker(hoverMarker.id);\n          hoverMarker.id = null;\n        }\n      };\n\n      popup.setSelectOnHover(false);\n      popup.on(\"mousemove\", function (e) {\n        if (!lastMouseEvent) {\n          lastMouseEvent = e;\n          return;\n        }\n\n        if (lastMouseEvent.x == e.x && lastMouseEvent.y == e.y) {\n          return;\n        }\n\n        lastMouseEvent = e;\n        lastMouseEvent.scrollTop = popup.renderer.scrollTop;\n        popup.isMouseOver = true;\n        var row = lastMouseEvent.getDocumentPosition().row;\n\n        if (hoverMarker.start.row != row) {\n          if (!hoverMarker.id) popup.setRow(row);\n          setHoverMarker(row);\n        }\n      });\n      popup.renderer.on(\"beforeRender\", function () {\n        if (lastMouseEvent && hoverMarker.start.row != -1) {\n          lastMouseEvent.$pos = null;\n          var row = lastMouseEvent.getDocumentPosition().row;\n          if (!hoverMarker.id) popup.setRow(row);\n          setHoverMarker(row, true);\n        }\n      });\n      popup.renderer.on(\"afterRender\", function () {\n        var row = popup.getRow();\n        var t = popup.renderer.$textLayer;\n        var selected =\n        /** @type {HTMLElement|null} */\n        t.element.childNodes[row - t.config.firstRow];\n        var el = document.activeElement; // Active element is textarea of main editor\n\n        if (selected !== popup.selectedNode && popup.selectedNode) {\n          dom.removeCssClass(popup.selectedNode, \"ace_selected\");\n          el.removeAttribute(\"aria-activedescendant\");\n          popup.selectedNode.removeAttribute(ariaActiveState);\n          popup.selectedNode.removeAttribute(\"id\");\n        }\n\n        popup.selectedNode = selected;\n\n        if (selected) {\n          dom.addCssClass(selected, \"ace_selected\");\n          var ariaId = getAriaId(row);\n          selected.id = ariaId;\n          t.element.setAttribute(\"aria-activedescendant\", ariaId);\n          el.setAttribute(\"aria-activedescendant\", ariaId);\n          selected.setAttribute(\"role\", optionAriaRole);\n          selected.setAttribute(\"aria-roledescription\", nls(\"item\"));\n          selected.setAttribute(\"aria-label\", popup.getData(row).caption || popup.getData(row).value);\n          selected.setAttribute(\"aria-setsize\", popup.data.length);\n          selected.setAttribute(\"aria-posinset\", row + 1);\n          selected.setAttribute(\"aria-describedby\", \"doc-tooltip\");\n          selected.setAttribute(ariaActiveState, \"true\");\n        }\n      });\n\n      var hideHoverMarker = function hideHoverMarker() {\n        setHoverMarker(-1);\n      };\n\n      var setHoverMarker = function setHoverMarker(row, suppressRedraw) {\n        if (row !== hoverMarker.start.row) {\n          hoverMarker.start.row = hoverMarker.end.row = row;\n          if (!suppressRedraw) popup.session._emit(\"changeBackMarker\");\n\n          popup._emit(\"changeHoverMarker\");\n        }\n      };\n\n      popup.getHoveredRow = function () {\n        return hoverMarker.start.row;\n      };\n\n      event.addListener(popup.container, \"mouseout\", function () {\n        popup.isMouseOver = false;\n        hideHoverMarker();\n      });\n      popup.on(\"hide\", hideHoverMarker);\n      popup.on(\"changeSelection\", hideHoverMarker);\n\n      popup.session.doc.getLength = function () {\n        return popup.data.length;\n      };\n\n      popup.session.doc.getLine = function (i) {\n        var data = popup.data[i];\n        if (typeof data == \"string\") return data;\n        return data && data.value || \"\";\n      };\n\n      var bgTokenizer = popup.session.bgTokenizer;\n\n      bgTokenizer.$tokenizeRow = function (row) {\n        var data = popup.data[row];\n        var tokens = [];\n        if (!data) return tokens;\n        if (typeof data == \"string\") data = {\n          value: data\n        };\n        var caption = data.caption || data.value || data.name;\n\n        function addToken(value, className) {\n          value && tokens.push({\n            type: (data.className || \"\") + (className || \"\"),\n            value: value\n          });\n        }\n\n        var lower = caption.toLowerCase();\n        var filterText = (popup.filterText || \"\").toLowerCase();\n        var lastIndex = 0;\n        var lastI = 0;\n\n        for (var i = 0; i <= filterText.length; i++) {\n          if (i != lastI && (data.matchMask & 1 << i || i == filterText.length)) {\n            var sub = filterText.slice(lastI, i);\n            lastI = i;\n            var index = lower.indexOf(sub, lastIndex);\n            if (index == -1) continue;\n            addToken(caption.slice(lastIndex, index), \"\");\n            lastIndex = index + sub.length;\n            addToken(caption.slice(index, lastIndex), \"completion-highlight\");\n          }\n        }\n\n        addToken(caption.slice(lastIndex, caption.length), \"\");\n        tokens.push({\n          type: \"completion-spacer\",\n          value: \" \"\n        });\n        if (data.meta) tokens.push({\n          type: \"completion-meta\",\n          value: data.meta\n        });\n        if (data.message) tokens.push({\n          type: \"completion-message\",\n          value: data.message\n        });\n        return tokens;\n      };\n\n      bgTokenizer.$updateOnChange = noop;\n      bgTokenizer.start = noop;\n\n      popup.session.$computeWidth = function () {\n        return this.screenWidth = 0;\n      };\n\n      popup.isOpen = false;\n      popup.isTopdown = false;\n      popup.autoSelect = true;\n      popup.filterText = \"\";\n      popup.isMouseOver = false;\n      popup.data = [];\n\n      popup.setData = function (list, filterText) {\n        popup.filterText = filterText || \"\";\n        popup.setValue(lang.stringRepeat(\"\\n\", list.length), -1);\n        popup.data = list || [];\n        popup.setRow(0);\n      };\n\n      popup.getData = function (row) {\n        return popup.data[row];\n      };\n\n      popup.getRow = function () {\n        return selectionMarker.start.row;\n      };\n\n      popup.setRow = function (line) {\n        line = Math.max(this.autoSelect ? 0 : -1, Math.min(this.data.length - 1, line));\n\n        if (selectionMarker.start.row != line) {\n          popup.selection.clearSelection();\n          selectionMarker.start.row = selectionMarker.end.row = line || 0;\n\n          popup.session._emit(\"changeBackMarker\");\n\n          popup.moveCursorTo(line || 0, 0);\n          if (popup.isOpen) popup._signal(\"select\");\n        }\n      };\n\n      popup.on(\"changeSelection\", function () {\n        if (popup.isOpen) popup.setRow(popup.selection.lead.row);\n        popup.renderer.scrollCursorIntoView();\n      });\n\n      popup.hide = function () {\n        this.container.style.display = \"none\";\n        popup.anchorPos = null;\n        popup.anchor = null;\n\n        if (popup.isOpen) {\n          popup.isOpen = false;\n\n          this._signal(\"hide\");\n        }\n      };\n\n      popup.tryShow = function (pos, lineHeight, anchor, forceShow) {\n        if (!forceShow && popup.isOpen && popup.anchorPos && popup.anchor && popup.anchorPos.top === pos.top && popup.anchorPos.left === pos.left && popup.anchor === anchor) {\n          return true;\n        }\n\n        var el = this.container;\n        var screenHeight = window.innerHeight;\n        var screenWidth = window.innerWidth;\n        var renderer = this.renderer;\n        var maxH = renderer.$maxLines * lineHeight * 1.4;\n        var dims = {\n          top: 0,\n          bottom: 0,\n          left: 0\n        };\n        var spaceBelow = screenHeight - pos.top - 3 * this.$borderSize - lineHeight;\n        var spaceAbove = pos.top - 3 * this.$borderSize;\n\n        if (!anchor) {\n          if (spaceAbove <= spaceBelow || spaceBelow >= maxH) {\n            anchor = \"bottom\";\n          } else {\n            anchor = \"top\";\n          }\n        }\n\n        if (anchor === \"top\") {\n          dims.bottom = pos.top - this.$borderSize;\n          dims.top = dims.bottom - maxH;\n        } else if (anchor === \"bottom\") {\n          dims.top = pos.top + lineHeight + this.$borderSize;\n          dims.bottom = dims.top + maxH;\n        }\n\n        var fitsX = dims.top >= 0 && dims.bottom <= screenHeight;\n\n        if (!forceShow && !fitsX) {\n          return false;\n        }\n\n        if (!fitsX) {\n          if (anchor === \"top\") {\n            renderer.$maxPixelHeight = spaceAbove;\n          } else {\n            renderer.$maxPixelHeight = spaceBelow;\n          }\n        } else {\n          renderer.$maxPixelHeight = null;\n        }\n\n        if (anchor === \"top\") {\n          el.style.top = \"\";\n          el.style.bottom = screenHeight - dims.bottom + \"px\";\n          popup.isTopdown = false;\n        } else {\n          el.style.top = dims.top + \"px\";\n          el.style.bottom = \"\";\n          popup.isTopdown = true;\n        }\n\n        el.style.display = \"\";\n        var left = pos.left;\n        if (left + el.offsetWidth > screenWidth) left = screenWidth - el.offsetWidth;\n        el.style.left = left + \"px\";\n        el.style.right = \"\";\n\n        if (!popup.isOpen) {\n          popup.isOpen = true;\n\n          this._signal(\"show\");\n\n          lastMouseEvent = null;\n        }\n\n        popup.anchorPos = pos;\n        popup.anchor = anchor;\n        return true;\n      };\n\n      popup.show = function (pos, lineHeight, topdownOnly) {\n        this.tryShow(pos, lineHeight, topdownOnly ? \"bottom\" : undefined, true);\n      };\n\n      popup.goTo = function (where) {\n        var row = this.getRow();\n        var max = this.session.getLength() - 1;\n\n        switch (where) {\n          case \"up\":\n            row = row <= 0 ? max : row - 1;\n            break;\n\n          case \"down\":\n            row = row >= max ? -1 : row + 1;\n            break;\n\n          case \"start\":\n            row = 0;\n            break;\n\n          case \"end\":\n            row = max;\n            break;\n        }\n\n        this.setRow(row);\n      };\n\n      popup.getTextLeftOffset = function () {\n        return this.$borderSize + this.renderer.$padding + this.$imageSize;\n      };\n\n      popup.$imageSize = 0;\n      popup.$borderSize = 1;\n      return popup;\n    }\n\n    return AcePopup;\n  }();\n\n  dom.importCssString(\"\\n.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\n    background-color: #CAD6FA;\\n    z-index: 1;\\n}\\n.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\n    background-color: #3a674e;\\n}\\n.ace_editor.ace_autocomplete .ace_line-hover {\\n    border: 1px solid #abbffe;\\n    margin-top: -1px;\\n    background: rgba(233,233,253,0.4);\\n    position: absolute;\\n    z-index: 2;\\n}\\n.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {\\n    border: 1px solid rgba(109, 150, 13, 0.8);\\n    background: rgba(58, 103, 78, 0.62);\\n}\\n.ace_completion-meta {\\n    opacity: 0.5;\\n    margin-left: 0.9em;\\n}\\n.ace_completion-message {\\n    margin-left: 0.9em;\\n    color: blue;\\n}\\n.ace_editor.ace_autocomplete .ace_completion-highlight{\\n    color: #2d69c7;\\n}\\n.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{\\n    color: #93ca12;\\n}\\n.ace_editor.ace_autocomplete {\\n    width: 300px;\\n    z-index: 200000;\\n    border: 1px lightgray solid;\\n    position: fixed;\\n    box-shadow: 2px 3px 5px rgba(0,0,0,.2);\\n    line-height: 1.4;\\n    background: #fefefe;\\n    color: #111;\\n}\\n.ace_dark.ace_editor.ace_autocomplete {\\n    border: 1px #484747 solid;\\n    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);\\n    line-height: 1.4;\\n    background: #25282c;\\n    color: #c1c1c1;\\n}\\n.ace_autocomplete .ace_text-layer  {\\n    width: calc(100% - 8px);\\n}\\n.ace_autocomplete .ace_line {\\n    display: flex;\\n    align-items: center;\\n}\\n.ace_autocomplete .ace_line > * {\\n    min-width: 0;\\n    flex: 0 0 auto;\\n}\\n.ace_autocomplete .ace_line .ace_ {\\n    flex: 0 1 auto;\\n    overflow: hidden;\\n    white-space: nowrap;\\n    text-overflow: ellipsis;\\n}\\n.ace_autocomplete .ace_completion-spacer {\\n    flex: 1;\\n}\\n.ace_autocomplete.ace_loading:after  {\\n    content: \\\"\\\";\\n    position: absolute;\\n    top: 0px;\\n    height: 2px;\\n    width: 8%;\\n    background: blue;\\n    z-index: 100;\\n    animation: ace_progress 3s infinite linear;\\n    animation-delay: 300ms;\\n    transform: translateX(-100%) scaleX(1);\\n}\\n@keyframes ace_progress {\\n    0% { transform: translateX(-100%) scaleX(1) }\\n    50% { transform: translateX(625%) scaleX(2) } \\n    100% { transform: translateX(1500%) scaleX(3) } \\n}\\n@media (prefers-reduced-motion) {\\n    .ace_autocomplete.ace_loading:after {\\n        transform: translateX(625%) scaleX(2);\\n        animation: none;\\n     }\\n}\\n\", \"autocompletion.css\", false);\n  exports.AcePopup = AcePopup;\n  exports.$singleLineEditor = $singleLineEditor;\n  exports.getAriaId = getAriaId;\n});\nace.define(\"ace/autocomplete/inline_screenreader\", [\"require\", \"exports\", \"module\"], function (require, exports, module) {\n  \"use strict\";\n\n  var AceInlineScreenReader =\n  /** @class */\n  function () {\n    function AceInlineScreenReader(editor) {\n      this.editor = editor;\n      this.screenReaderDiv = document.createElement(\"div\");\n      this.screenReaderDiv.classList.add(\"ace_screenreader-only\");\n      this.editor.container.appendChild(this.screenReaderDiv);\n    }\n\n    AceInlineScreenReader.prototype.setScreenReaderContent = function (content) {\n      if (!this.popup && this.editor.completer &&\n      /**@type{import(\"../autocomplete\").Autocomplete}*/\n      this.editor.completer.popup) {\n        this.popup =\n        /**@type{import(\"../autocomplete\").Autocomplete}*/\n        this.editor.completer.popup;\n        this.popup.renderer.on(\"afterRender\", function () {\n          var row = this.popup.getRow();\n          var t = this.popup.renderer.$textLayer;\n          var selected = t.element.childNodes[row - t.config.firstRow];\n\n          if (selected) {\n            var idString = \"doc-tooltip \";\n\n            for (var lineIndex = 0; lineIndex < this._lines.length; lineIndex++) {\n              idString += \"ace-inline-screenreader-line-\".concat(lineIndex, \" \");\n            }\n\n            selected.setAttribute(\"aria-describedby\", idString);\n          }\n        }.bind(this));\n      }\n\n      while (this.screenReaderDiv.firstChild) {\n        this.screenReaderDiv.removeChild(this.screenReaderDiv.firstChild);\n      }\n\n      this._lines = content.split(/\\r\\n|\\r|\\n/);\n      var codeElement = this.createCodeBlock();\n      this.screenReaderDiv.appendChild(codeElement);\n    };\n\n    AceInlineScreenReader.prototype.destroy = function () {\n      this.screenReaderDiv.remove();\n    };\n\n    AceInlineScreenReader.prototype.createCodeBlock = function () {\n      var container = document.createElement(\"pre\");\n      container.setAttribute(\"id\", \"ace-inline-screenreader\");\n\n      for (var lineIndex = 0; lineIndex < this._lines.length; lineIndex++) {\n        var codeElement = document.createElement(\"code\");\n        codeElement.setAttribute(\"id\", \"ace-inline-screenreader-line-\".concat(lineIndex));\n        var line = document.createTextNode(this._lines[lineIndex]);\n        codeElement.appendChild(line);\n        container.appendChild(codeElement);\n      }\n\n      return container;\n    };\n\n    return AceInlineScreenReader;\n  }();\n\n  exports.AceInlineScreenReader = AceInlineScreenReader;\n});\nace.define(\"ace/autocomplete/inline\", [\"require\", \"exports\", \"module\", \"ace/snippets\", \"ace/autocomplete/inline_screenreader\"], function (require, exports, module) {\n  \"use strict\";\n\n  var snippetManager = require(\"../snippets\").snippetManager;\n\n  var AceInlineScreenReader = require(\"./inline_screenreader\").AceInlineScreenReader;\n\n  var AceInline =\n  /** @class */\n  function () {\n    function AceInline() {\n      this.editor = null;\n    }\n\n    AceInline.prototype.show = function (editor, completion, prefix) {\n      prefix = prefix || \"\";\n\n      if (editor && this.editor && this.editor !== editor) {\n        this.hide();\n        this.editor = null;\n        this.inlineScreenReader = null;\n      }\n\n      if (!editor || !completion) {\n        return false;\n      }\n\n      if (!this.inlineScreenReader) {\n        this.inlineScreenReader = new AceInlineScreenReader(editor);\n      }\n\n      var displayText = completion.snippet ? snippetManager.getDisplayTextForSnippet(editor, completion.snippet) : completion.value;\n\n      if (completion.hideInlinePreview || !displayText || !displayText.startsWith(prefix)) {\n        return false;\n      }\n\n      this.editor = editor;\n      this.inlineScreenReader.setScreenReaderContent(displayText);\n      displayText = displayText.slice(prefix.length);\n\n      if (displayText === \"\") {\n        editor.removeGhostText();\n      } else {\n        editor.setGhostText(displayText);\n      }\n\n      return true;\n    };\n\n    AceInline.prototype.isOpen = function () {\n      if (!this.editor) {\n        return false;\n      }\n\n      return !!this.editor.renderer.$ghostText;\n    };\n\n    AceInline.prototype.hide = function () {\n      if (!this.editor) {\n        return false;\n      }\n\n      this.editor.removeGhostText();\n      return true;\n    };\n\n    AceInline.prototype.destroy = function () {\n      this.hide();\n      this.editor = null;\n\n      if (this.inlineScreenReader) {\n        this.inlineScreenReader.destroy();\n        this.inlineScreenReader = null;\n      }\n    };\n\n    return AceInline;\n  }();\n\n  exports.AceInline = AceInline;\n});\nace.define(\"ace/autocomplete/util\", [\"require\", \"exports\", \"module\"], function (require, exports, module) {\n  \"use strict\";\n\n  exports.parForEach = function (array, fn, callback) {\n    var completed = 0;\n    var arLength = array.length;\n    if (arLength === 0) callback();\n\n    for (var i = 0; i < arLength; i++) {\n      fn(array[i], function (result, err) {\n        completed++;\n        if (completed === arLength) callback(result, err);\n      });\n    }\n  };\n\n  var ID_REGEX = /[a-zA-Z_0-9\\$\\-\\u00A2-\\u2000\\u2070-\\uFFFF]/;\n\n  exports.retrievePrecedingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n\n    for (var i = pos - 1; i >= 0; i--) {\n      if (regex.test(text[i])) buf.push(text[i]);else break;\n    }\n\n    return buf.reverse().join(\"\");\n  };\n\n  exports.retrieveFollowingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n\n    for (var i = pos; i < text.length; i++) {\n      if (regex.test(text[i])) buf.push(text[i]);else break;\n    }\n\n    return buf;\n  };\n\n  exports.getCompletionPrefix = function (editor) {\n    var pos = editor.getCursorPosition();\n    var line = editor.session.getLine(pos.row);\n    var prefix;\n    editor.completers.forEach(function (completer) {\n      if (completer.identifierRegexps) {\n        completer.identifierRegexps.forEach(function (identifierRegex) {\n          if (!prefix && identifierRegex) prefix = this.retrievePrecedingIdentifier(line, pos.column, identifierRegex);\n        }.bind(this));\n      }\n    }.bind(this));\n    return prefix || this.retrievePrecedingIdentifier(line, pos.column);\n  };\n\n  exports.triggerAutocomplete = function (editor, previousChar) {\n    var previousChar = previousChar == null ? editor.session.getPrecedingCharacter() : previousChar;\n    return editor.completers.some(function (completer) {\n      if (completer.triggerCharacters && Array.isArray(completer.triggerCharacters)) {\n        return completer.triggerCharacters.includes(previousChar);\n      }\n    });\n  };\n});\nace.define(\"ace/autocomplete\", [\"require\", \"exports\", \"module\", \"ace/keyboard/hash_handler\", \"ace/autocomplete/popup\", \"ace/autocomplete/inline\", \"ace/autocomplete/popup\", \"ace/autocomplete/util\", \"ace/lib/lang\", \"ace/lib/dom\", \"ace/snippets\", \"ace/config\", \"ace/lib/event\", \"ace/lib/scroll\"], function (require, exports, module) {\n  \"use strict\";\n\n  var HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\n\n  var AcePopup = require(\"./autocomplete/popup\").AcePopup;\n\n  var AceInline = require(\"./autocomplete/inline\").AceInline;\n\n  var getAriaId = require(\"./autocomplete/popup\").getAriaId;\n\n  var util = require(\"./autocomplete/util\");\n\n  var lang = require(\"./lib/lang\");\n\n  var dom = require(\"./lib/dom\");\n\n  var snippetManager = require(\"./snippets\").snippetManager;\n\n  var config = require(\"./config\");\n\n  var event = require(\"./lib/event\");\n\n  var preventParentScroll = require(\"./lib/scroll\").preventParentScroll;\n\n  var destroyCompleter = function destroyCompleter(e, editor) {\n    editor.completer && editor.completer.destroy();\n  };\n\n  var Autocomplete =\n  /** @class */\n  function () {\n    function Autocomplete() {\n      this.autoInsert = false;\n      this.autoSelect = true;\n      this.autoShown = false;\n      this.exactMatch = false;\n      this.inlineEnabled = false;\n      this.keyboardHandler = new HashHandler();\n      this.keyboardHandler.bindKeys(this.commands);\n      this.parentNode = null;\n      this.setSelectOnHover = false;\n      this.hasSeen = new Set();\n      this.showLoadingState = false;\n      this.stickySelectionDelay = 500;\n      this.blurListener = this.blurListener.bind(this);\n      this.changeListener = this.changeListener.bind(this);\n      this.mousedownListener = this.mousedownListener.bind(this);\n      this.mousewheelListener = this.mousewheelListener.bind(this);\n      this.onLayoutChange = this.onLayoutChange.bind(this);\n      this.changeTimer = lang.delayedCall(function () {\n        this.updateCompletions(true);\n      }.bind(this));\n      this.tooltipTimer = lang.delayedCall(this.updateDocTooltip.bind(this), 50);\n      this.popupTimer = lang.delayedCall(this.$updatePopupPosition.bind(this), 50);\n      this.stickySelectionTimer = lang.delayedCall(function () {\n        this.stickySelection = true;\n      }.bind(this), this.stickySelectionDelay);\n      this.$firstOpenTimer = lang.delayedCall(\n      /**@this{Autocomplete}*/\n      function () {\n        var initialPosition = this.completionProvider && this.completionProvider.initialPosition;\n        if (this.autoShown || this.popup && this.popup.isOpen || !initialPosition || this.editor.completers.length === 0) return;\n        this.completions = new FilteredList(Autocomplete.completionsForLoading);\n        this.openPopup(this.editor, initialPosition.prefix, false);\n        this.popup.renderer.setStyle(\"ace_loading\", true);\n      }.bind(this), this.stickySelectionDelay);\n    }\n\n    Object.defineProperty(Autocomplete, \"completionsForLoading\", {\n      get: function get() {\n        return [{\n          caption: config.nls(\"Loading...\"),\n          value: \"\"\n        }];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    Autocomplete.prototype.$init = function () {\n      this.popup = new AcePopup(this.parentNode || document.body || document.documentElement);\n      this.popup.on(\"click\", function (e) {\n        this.insertMatch();\n        e.stop();\n      }.bind(this));\n      this.popup.focus = this.editor.focus.bind(this.editor);\n      this.popup.on(\"show\", this.$onPopupShow.bind(this));\n      this.popup.on(\"hide\", this.$onHidePopup.bind(this));\n      this.popup.on(\"select\", this.$onPopupChange.bind(this));\n      event.addListener(this.popup.container, \"mouseout\", this.mouseOutListener.bind(this));\n      this.popup.on(\"changeHoverMarker\", this.tooltipTimer.bind(null, null));\n      this.popup.renderer.on(\"afterRender\", this.$onPopupRender.bind(this));\n      return this.popup;\n    };\n\n    Autocomplete.prototype.$initInline = function () {\n      if (!this.inlineEnabled || this.inlineRenderer) return;\n      this.inlineRenderer = new AceInline();\n      return this.inlineRenderer;\n    };\n\n    Autocomplete.prototype.getPopup = function () {\n      return this.popup || this.$init();\n    };\n\n    Autocomplete.prototype.$onHidePopup = function () {\n      if (this.inlineRenderer) {\n        this.inlineRenderer.hide();\n      }\n\n      this.hideDocTooltip();\n      this.stickySelectionTimer.cancel();\n      this.popupTimer.cancel();\n      this.stickySelection = false;\n    };\n\n    Autocomplete.prototype.$seen = function (completion) {\n      if (!this.hasSeen.has(completion) && completion && completion.completer && completion.completer.onSeen && typeof completion.completer.onSeen === \"function\") {\n        completion.completer.onSeen(this.editor, completion);\n        this.hasSeen.add(completion);\n      }\n    };\n\n    Autocomplete.prototype.$onPopupChange = function (hide) {\n      if (this.inlineRenderer && this.inlineEnabled) {\n        var completion = hide ? null : this.popup.getData(this.popup.getRow());\n        this.$updateGhostText(completion);\n\n        if (this.popup.isMouseOver && this.setSelectOnHover) {\n          this.tooltipTimer.call(null, null);\n          return;\n        }\n\n        this.popupTimer.schedule();\n        this.tooltipTimer.schedule();\n      } else {\n        this.popupTimer.call(null, null);\n        this.tooltipTimer.call(null, null);\n      }\n    };\n\n    Autocomplete.prototype.$updateGhostText = function (completion) {\n      var row = this.base.row;\n      var column = this.base.column;\n      var cursorColumn = this.editor.getCursorPosition().column;\n      var prefix = this.editor.session.getLine(row).slice(column, cursorColumn);\n\n      if (!this.inlineRenderer.show(this.editor, completion, prefix)) {\n        this.inlineRenderer.hide();\n      } else {\n        this.$seen(completion);\n      }\n    };\n\n    Autocomplete.prototype.$onPopupRender = function () {\n      var inlineEnabled = this.inlineRenderer && this.inlineEnabled;\n\n      if (this.completions && this.completions.filtered && this.completions.filtered.length > 0) {\n        for (var i = this.popup.getFirstVisibleRow(); i <= this.popup.getLastVisibleRow(); i++) {\n          var completion = this.popup.getData(i);\n\n          if (completion && (!inlineEnabled || completion.hideInlinePreview)) {\n            this.$seen(completion);\n          }\n        }\n      }\n    };\n\n    Autocomplete.prototype.$onPopupShow = function (hide) {\n      this.$onPopupChange(hide);\n      this.stickySelection = false;\n      if (this.stickySelectionDelay >= 0) this.stickySelectionTimer.schedule(this.stickySelectionDelay);\n    };\n\n    Autocomplete.prototype.observeLayoutChanges = function () {\n      if (this.$elements || !this.editor) return;\n      window.addEventListener(\"resize\", this.onLayoutChange, {\n        passive: true\n      });\n      window.addEventListener(\"wheel\", this.mousewheelListener);\n      var el = this.editor.container.parentNode;\n      var elements = [];\n\n      while (el) {\n        elements.push(el);\n        el.addEventListener(\"scroll\", this.onLayoutChange, {\n          passive: true\n        });\n        el = el.parentNode;\n      }\n\n      this.$elements = elements;\n    };\n\n    Autocomplete.prototype.unObserveLayoutChanges = function () {\n      var _this = this;\n\n      window.removeEventListener(\"resize\", this.onLayoutChange, {\n        passive: true\n      });\n      window.removeEventListener(\"wheel\", this.mousewheelListener);\n      this.$elements && this.$elements.forEach(function (el) {\n        el.removeEventListener(\"scroll\", _this.onLayoutChange, {\n          passive: true\n        });\n      });\n      this.$elements = null;\n    };\n\n    Autocomplete.prototype.onLayoutChange = function () {\n      if (!this.popup.isOpen) return this.unObserveLayoutChanges();\n      this.$updatePopupPosition();\n      this.updateDocTooltip();\n    };\n\n    Autocomplete.prototype.$updatePopupPosition = function () {\n      var editor = this.editor;\n      var renderer = editor.renderer;\n      var lineHeight = renderer.layerConfig.lineHeight;\n      var pos = renderer.$cursorLayer.getPixelPosition(this.base, true);\n      pos.left -= this.popup.getTextLeftOffset();\n      var rect = editor.container.getBoundingClientRect();\n      pos.top += rect.top - renderer.layerConfig.offset;\n      pos.left += rect.left - editor.renderer.scrollLeft;\n      pos.left += renderer.gutterWidth;\n      var posGhostText = {\n        top: pos.top,\n        left: pos.left\n      };\n\n      if (renderer.$ghostText && renderer.$ghostTextWidget) {\n        if (this.base.row === renderer.$ghostText.position.row) {\n          posGhostText.top += renderer.$ghostTextWidget.el.offsetHeight;\n        }\n      }\n\n      var editorContainerBottom = editor.container.getBoundingClientRect().bottom - lineHeight;\n      var lowestPosition = editorContainerBottom < posGhostText.top ? {\n        top: editorContainerBottom,\n        left: posGhostText.left\n      } : posGhostText;\n\n      if (this.popup.tryShow(lowestPosition, lineHeight, \"bottom\")) {\n        return;\n      }\n\n      if (this.popup.tryShow(pos, lineHeight, \"top\")) {\n        return;\n      }\n\n      this.popup.show(pos, lineHeight);\n    };\n\n    Autocomplete.prototype.openPopup = function (editor, prefix, keepPopupPosition) {\n      this.$firstOpenTimer.cancel();\n      if (!this.popup) this.$init();\n      if (this.inlineEnabled && !this.inlineRenderer) this.$initInline();\n      this.popup.autoSelect = this.autoSelect;\n      this.popup.setSelectOnHover(this.setSelectOnHover);\n      var oldRow = this.popup.getRow();\n      var previousSelectedItem = this.popup.data[oldRow];\n      this.popup.setData(this.completions.filtered, this.completions.filterText);\n\n      if (this.editor.textInput.setAriaOptions) {\n        this.editor.textInput.setAriaOptions({\n          activeDescendant: getAriaId(this.popup.getRow()),\n          inline: this.inlineEnabled\n        });\n      }\n\n      editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n      var newRow;\n      if (this.stickySelection) newRow = this.popup.data.indexOf(previousSelectedItem);\n      if (!newRow || newRow === -1) newRow = 0;\n      this.popup.setRow(this.autoSelect ? newRow : -1);\n      if (newRow === oldRow && previousSelectedItem !== this.completions.filtered[newRow]) this.$onPopupChange();\n      var inlineEnabled = this.inlineRenderer && this.inlineEnabled;\n\n      if (newRow === oldRow && inlineEnabled) {\n        var completion = this.popup.getData(this.popup.getRow());\n        this.$updateGhostText(completion);\n      }\n\n      if (!keepPopupPosition) {\n        this.popup.setTheme(editor.getTheme());\n        this.popup.setFontSize(editor.getFontSize());\n        this.$updatePopupPosition();\n\n        if (this.tooltipNode) {\n          this.updateDocTooltip();\n        }\n      }\n\n      this.changeTimer.cancel();\n      this.observeLayoutChanges();\n    };\n\n    Autocomplete.prototype.detach = function () {\n      if (this.editor) {\n        this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n        this.editor.off(\"changeSelection\", this.changeListener);\n        this.editor.off(\"blur\", this.blurListener);\n        this.editor.off(\"mousedown\", this.mousedownListener);\n        this.editor.off(\"mousewheel\", this.mousewheelListener);\n      }\n\n      this.$firstOpenTimer.cancel();\n      this.changeTimer.cancel();\n      this.hideDocTooltip();\n\n      if (this.completionProvider) {\n        this.completionProvider.detach();\n      }\n\n      if (this.popup && this.popup.isOpen) this.popup.hide();\n\n      if (this.popup && this.popup.renderer) {\n        this.popup.renderer.off(\"afterRender\", this.$onPopupRender);\n      }\n\n      if (this.base) this.base.detach();\n      this.activated = false;\n      this.completionProvider = this.completions = this.base = null;\n      this.unObserveLayoutChanges();\n    };\n\n    Autocomplete.prototype.changeListener = function (e) {\n      var cursor = this.editor.selection.lead;\n\n      if (cursor.row != this.base.row || cursor.column < this.base.column) {\n        this.detach();\n      }\n\n      if (this.activated) this.changeTimer.schedule();else this.detach();\n    };\n\n    Autocomplete.prototype.blurListener = function (e) {\n      var el = document.activeElement;\n      var text = this.editor.textInput.getElement();\n      var fromTooltip = e.relatedTarget && this.tooltipNode && this.tooltipNode.contains(e.relatedTarget);\n      var container = this.popup && this.popup.container;\n\n      if (el != text && el.parentNode != container && !fromTooltip && el != this.tooltipNode && e.relatedTarget != text) {\n        this.detach();\n      }\n    };\n\n    Autocomplete.prototype.mousedownListener = function (e) {\n      this.detach();\n    };\n\n    Autocomplete.prototype.mousewheelListener = function (e) {\n      if (!this.popup.isMouseOver) this.detach();\n    };\n\n    Autocomplete.prototype.mouseOutListener = function (e) {\n      if (this.popup.isOpen) this.$updatePopupPosition();\n    };\n\n    Autocomplete.prototype.goTo = function (where) {\n      this.popup.goTo(where);\n    };\n\n    Autocomplete.prototype.insertMatch = function (data, options) {\n      if (!data) data = this.popup.getData(this.popup.getRow());\n      if (!data) return false;\n      if (data.value === \"\") // Explicitly given nothing to insert, e.g. \"No suggestion state\"\n        return this.detach();\n      var completions = this.completions;\n      var result = this.getCompletionProvider().insertMatch(this.editor, data, completions.filterText, options);\n      if (this.completions == completions) this.detach();\n      return result;\n    };\n\n    Autocomplete.prototype.showPopup = function (editor, options) {\n      if (this.editor) this.detach();\n      this.activated = true;\n      this.editor = editor;\n\n      if (editor.completer != this) {\n        if (editor.completer) editor.completer.detach();\n        editor.completer = this;\n      }\n\n      editor.on(\"changeSelection\", this.changeListener);\n      editor.on(\"blur\", this.blurListener);\n      editor.on(\"mousedown\", this.mousedownListener);\n      editor.on(\"mousewheel\", this.mousewheelListener);\n      this.updateCompletions(false, options);\n    };\n\n    Autocomplete.prototype.getCompletionProvider = function (initialPosition) {\n      if (!this.completionProvider) this.completionProvider = new CompletionProvider(initialPosition);\n      return this.completionProvider;\n    };\n\n    Autocomplete.prototype.gatherCompletions = function (editor, callback) {\n      return this.getCompletionProvider().gatherCompletions(editor, callback);\n    };\n\n    Autocomplete.prototype.updateCompletions = function (keepPopupPosition, options) {\n      if (keepPopupPosition && this.base && this.completions) {\n        var pos = this.editor.getCursorPosition();\n        var prefix = this.editor.session.getTextRange({\n          start: this.base,\n          end: pos\n        });\n        if (prefix == this.completions.filterText) return;\n        this.completions.setFilter(prefix);\n        if (!this.completions.filtered.length) return this.detach();\n        if (this.completions.filtered.length == 1 && this.completions.filtered[0].value == prefix && !this.completions.filtered[0].snippet) return this.detach();\n        this.openPopup(this.editor, prefix, keepPopupPosition);\n        return;\n      }\n\n      if (options && options.matches) {\n        var pos = this.editor.getSelectionRange().start;\n        this.base = this.editor.session.doc.createAnchor(pos.row, pos.column);\n        this.base.$insertRight = true;\n        this.completions = new FilteredList(options.matches);\n        this.getCompletionProvider().completions = this.completions;\n        return this.openPopup(this.editor, \"\", keepPopupPosition);\n      }\n\n      var session = this.editor.getSession();\n      var pos = this.editor.getCursorPosition();\n      var prefix = util.getCompletionPrefix(this.editor);\n      this.base = session.doc.createAnchor(pos.row, pos.column - prefix.length);\n      this.base.$insertRight = true;\n      var completionOptions = {\n        exactMatch: this.exactMatch,\n        ignoreCaption: this.ignoreCaption\n      };\n      this.getCompletionProvider({\n        prefix: prefix,\n        pos: pos\n      }).provideCompletions(this.editor, completionOptions, function (err, completions, finished) {\n        var filtered = completions.filtered;\n        var prefix = util.getCompletionPrefix(this.editor);\n        this.$firstOpenTimer.cancel();\n\n        if (finished) {\n          if (!filtered.length) {\n            var emptyMessage = !this.autoShown && this.emptyMessage;\n            if (typeof emptyMessage == \"function\") emptyMessage = this.emptyMessage(prefix);\n\n            if (emptyMessage) {\n              var completionsForEmpty = [{\n                caption: emptyMessage,\n                value: \"\"\n              }];\n              this.completions = new FilteredList(completionsForEmpty);\n              this.openPopup(this.editor, prefix, keepPopupPosition);\n              this.popup.renderer.setStyle(\"ace_loading\", false);\n              this.popup.renderer.setStyle(\"ace_empty-message\", true);\n              return;\n            }\n\n            return this.detach();\n          }\n\n          if (filtered.length == 1 && filtered[0].value == prefix && !filtered[0].snippet) return this.detach();\n          if (this.autoInsert && !this.autoShown && filtered.length == 1) return this.insertMatch(filtered[0]);\n        }\n\n        this.completions = !finished && this.showLoadingState ? new FilteredList(Autocomplete.completionsForLoading.concat(filtered), completions.filterText) : completions;\n        this.openPopup(this.editor, prefix, keepPopupPosition);\n        this.popup.renderer.setStyle(\"ace_empty-message\", false);\n        this.popup.renderer.setStyle(\"ace_loading\", !finished);\n      }.bind(this));\n\n      if (this.showLoadingState && !this.autoShown && !(this.popup && this.popup.isOpen)) {\n        this.$firstOpenTimer.delay(this.stickySelectionDelay / 2);\n      }\n    };\n\n    Autocomplete.prototype.cancelContextMenu = function () {\n      this.editor.$mouseHandler.cancelContextMenu();\n    };\n\n    Autocomplete.prototype.updateDocTooltip = function () {\n      var popup = this.popup;\n      var all = this.completions.filtered;\n      var selected = all && (all[popup.getHoveredRow()] || all[popup.getRow()]);\n      var doc = null;\n      if (!selected || !this.editor || !this.popup.isOpen) return this.hideDocTooltip();\n      var completersLength = this.editor.completers.length;\n\n      for (var i = 0; i < completersLength; i++) {\n        var completer = this.editor.completers[i];\n\n        if (completer.getDocTooltip && selected.completerId === completer.id) {\n          doc = completer.getDocTooltip(selected);\n          break;\n        }\n      }\n\n      if (!doc && typeof selected != \"string\") doc = selected;\n      if (typeof doc == \"string\") doc = {\n        docText: doc\n      };\n      if (!doc || !(doc.docHTML || doc.docText)) return this.hideDocTooltip();\n      this.showDocTooltip(doc);\n    };\n\n    Autocomplete.prototype.showDocTooltip = function (item) {\n      if (!this.tooltipNode) {\n        this.tooltipNode = dom.createElement(\"div\");\n        this.tooltipNode.style.margin = \"0\";\n        this.tooltipNode.style.pointerEvents = \"auto\";\n        this.tooltipNode.style.overscrollBehavior = \"contain\";\n        this.tooltipNode.tabIndex = -1;\n        this.tooltipNode.onblur = this.blurListener.bind(this);\n        this.tooltipNode.onclick = this.onTooltipClick.bind(this);\n        this.tooltipNode.id = \"doc-tooltip\";\n        this.tooltipNode.setAttribute(\"role\", \"tooltip\");\n        this.tooltipNode.addEventListener(\"wheel\", preventParentScroll);\n      }\n\n      var theme = this.editor.renderer.theme;\n      this.tooltipNode.className = \"ace_tooltip ace_doc-tooltip \" + (theme.isDark ? \"ace_dark \" : \"\") + (theme.cssClass || \"\");\n      var tooltipNode = this.tooltipNode;\n\n      if (item.docHTML) {\n        tooltipNode.innerHTML = item.docHTML;\n      } else if (item.docText) {\n        tooltipNode.textContent = item.docText;\n      }\n\n      if (!tooltipNode.parentNode) this.popup.container.appendChild(this.tooltipNode);\n      var popup = this.popup;\n      var rect = popup.container.getBoundingClientRect();\n      tooltipNode.style.top = popup.container.style.top;\n      tooltipNode.style.bottom = popup.container.style.bottom;\n      tooltipNode.style.display = \"block\";\n\n      if (window.innerWidth - rect.right < 320) {\n        if (rect.left < 320) {\n          if (popup.isTopdown) {\n            tooltipNode.style.top = rect.bottom + \"px\";\n            tooltipNode.style.left = rect.left + \"px\";\n            tooltipNode.style.right = \"\";\n            tooltipNode.style.bottom = \"\";\n          } else {\n            tooltipNode.style.top = popup.container.offsetTop - tooltipNode.offsetHeight + \"px\";\n            tooltipNode.style.left = rect.left + \"px\";\n            tooltipNode.style.right = \"\";\n            tooltipNode.style.bottom = \"\";\n          }\n        } else {\n          tooltipNode.style.right = window.innerWidth - rect.left + \"px\";\n          tooltipNode.style.left = \"\";\n        }\n      } else {\n        tooltipNode.style.left = rect.right + 1 + \"px\";\n        tooltipNode.style.right = \"\";\n      }\n    };\n\n    Autocomplete.prototype.hideDocTooltip = function () {\n      this.tooltipTimer.cancel();\n      if (!this.tooltipNode) return;\n      var el = this.tooltipNode;\n      if (!this.editor.isFocused() && document.activeElement == el) this.editor.focus();\n      this.tooltipNode = null;\n      if (el.parentNode) el.parentNode.removeChild(el);\n    };\n\n    Autocomplete.prototype.onTooltipClick = function (e) {\n      var a = e.target;\n\n      while (a && a != this.tooltipNode) {\n        if (a.nodeName == \"A\" && a.href) {\n          a.rel = \"noreferrer\";\n          a.target = \"_blank\";\n          break;\n        }\n\n        a = a.parentNode;\n      }\n    };\n\n    Autocomplete.prototype.destroy = function () {\n      this.detach();\n\n      if (this.popup) {\n        this.popup.destroy();\n        var el = this.popup.container;\n        if (el && el.parentNode) el.parentNode.removeChild(el);\n      }\n\n      if (this.editor && this.editor.completer == this) {\n        this.editor.off(\"destroy\", destroyCompleter);\n        this.editor.completer = null;\n      }\n\n      this.inlineRenderer = this.popup = this.editor = null;\n    };\n\n    return Autocomplete;\n  }();\n\n  Autocomplete.prototype.commands = {\n    \"Up\": function Up(editor) {\n      editor.completer.goTo(\"up\");\n    },\n    \"Down\": function Down(editor) {\n      editor.completer.goTo(\"down\");\n    },\n    \"Ctrl-Up|Ctrl-Home\": function CtrlUpCtrlHome(editor) {\n      editor.completer.goTo(\"start\");\n    },\n    \"Ctrl-Down|Ctrl-End\": function CtrlDownCtrlEnd(editor) {\n      editor.completer.goTo(\"end\");\n    },\n    \"Esc\": function Esc(editor) {\n      editor.completer.detach();\n    },\n    \"Return\": function Return(editor) {\n      return editor.completer.insertMatch();\n    },\n    \"Shift-Return\": function ShiftReturn(editor) {\n      editor.completer.insertMatch(null, {\n        deleteSuffix: true\n      });\n    },\n    \"Tab\": function Tab(editor) {\n      var result = editor.completer.insertMatch();\n      if (!result && !editor.tabstopManager) editor.completer.goTo(\"down\");else return result;\n    },\n    \"Backspace\": function Backspace(editor) {\n      editor.execCommand(\"backspace\");\n      var prefix = util.getCompletionPrefix(editor);\n      if (!prefix && editor.completer) editor.completer.detach();\n    },\n    \"PageUp\": function PageUp(editor) {\n      editor.completer.popup.gotoPageUp();\n    },\n    \"PageDown\": function PageDown(editor) {\n      editor.completer.popup.gotoPageDown();\n    }\n  };\n\n  Autocomplete.for = function (editor) {\n    if (editor.completer instanceof Autocomplete) {\n      return editor.completer;\n    }\n\n    if (editor.completer) {\n      editor.completer.destroy();\n      editor.completer = null;\n    }\n\n    if (config.get(\"sharedPopups\")) {\n      if (!Autocomplete[\"$sharedInstance\"]) Autocomplete[\"$sharedInstance\"] = new Autocomplete();\n      editor.completer = Autocomplete[\"$sharedInstance\"];\n    } else {\n      editor.completer = new Autocomplete();\n      editor.once(\"destroy\", destroyCompleter);\n    }\n\n    return editor.completer;\n  };\n\n  Autocomplete.startCommand = {\n    name: \"startAutocomplete\",\n    exec: function exec(editor, options) {\n      var completer = Autocomplete.for(editor);\n      completer.autoInsert = false;\n      completer.autoSelect = true;\n      completer.autoShown = false;\n      completer.showPopup(editor, options);\n      completer.cancelContextMenu();\n    },\n    bindKey: \"Ctrl-Space|Ctrl-Shift-Space|Alt-Space\"\n  };\n\n  var CompletionProvider =\n  /** @class */\n  function () {\n    function CompletionProvider(initialPosition) {\n      this.initialPosition = initialPosition;\n      this.active = true;\n    }\n\n    CompletionProvider.prototype.insertByIndex = function (editor, index, options) {\n      if (!this.completions || !this.completions.filtered) {\n        return false;\n      }\n\n      return this.insertMatch(editor, this.completions.filtered[index], options);\n    };\n\n    CompletionProvider.prototype.insertMatch = function (editor, data, options) {\n      if (!data) return false;\n      editor.startOperation({\n        command: {\n          name: \"insertMatch\"\n        }\n      });\n\n      if (data.completer && data.completer.insertMatch) {\n        data.completer.insertMatch(editor, data);\n      } else {\n        if (!this.completions) return false;\n        var replaceBefore = this.completions.filterText.length;\n        var replaceAfter = 0;\n\n        if (data.range && data.range.start.row === data.range.end.row) {\n          replaceBefore -= this.initialPosition.prefix.length;\n          replaceBefore += this.initialPosition.pos.column - data.range.start.column;\n          replaceAfter += data.range.end.column - this.initialPosition.pos.column;\n        }\n\n        if (replaceBefore || replaceAfter) {\n          var ranges;\n\n          if (editor.selection.getAllRanges) {\n            ranges = editor.selection.getAllRanges();\n          } else {\n            ranges = [editor.getSelectionRange()];\n          }\n\n          for (var i = 0, range; range = ranges[i]; i++) {\n            range.start.column -= replaceBefore;\n            range.end.column += replaceAfter;\n            editor.session.remove(range);\n          }\n        }\n\n        if (data.snippet) {\n          snippetManager.insertSnippet(editor, data.snippet);\n        } else {\n          this.$insertString(editor, data);\n        }\n\n        if (data.completer && data.completer.onInsert && typeof data.completer.onInsert == \"function\") {\n          data.completer.onInsert(editor, data);\n        }\n\n        if (data.command && data.command === \"startAutocomplete\") {\n          editor.execCommand(data.command);\n        }\n      }\n\n      editor.endOperation();\n      return true;\n    };\n\n    CompletionProvider.prototype.$insertString = function (editor, data) {\n      var text = data.value || data;\n      editor.execCommand(\"insertstring\", text);\n    };\n\n    CompletionProvider.prototype.gatherCompletions = function (editor, callback) {\n      var session = editor.getSession();\n      var pos = editor.getCursorPosition();\n      var prefix = util.getCompletionPrefix(editor);\n      var matches = [];\n      this.completers = editor.completers;\n      var total = editor.completers.length;\n      editor.completers.forEach(function (completer, i) {\n        completer.getCompletions(editor, session, pos, prefix, function (err, results) {\n          if (completer.hideInlinePreview) results = results.map(function (result) {\n            return Object.assign(result, {\n              hideInlinePreview: completer.hideInlinePreview\n            });\n          });\n          if (!err && results) matches = matches.concat(results);\n          callback(null, {\n            prefix: util.getCompletionPrefix(editor),\n            matches: matches,\n            finished: --total === 0\n          });\n        });\n      });\n      return true;\n    };\n\n    CompletionProvider.prototype.provideCompletions = function (editor, options, callback) {\n      var processResults = function (results) {\n        var prefix = results.prefix;\n        var matches = results.matches;\n        this.completions = new FilteredList(matches);\n        if (options.exactMatch) this.completions.exactMatch = true;\n        if (options.ignoreCaption) this.completions.ignoreCaption = true;\n        this.completions.setFilter(prefix);\n        if (results.finished || this.completions.filtered.length) callback(null, this.completions, results.finished);\n      }.bind(this);\n\n      var isImmediate = true;\n      var immediateResults = null;\n      this.gatherCompletions(editor, function (err, results) {\n        if (!this.active) {\n          return;\n        }\n\n        if (err) {\n          callback(err, [], true);\n          this.detach();\n        }\n\n        var prefix = results.prefix;\n        if (prefix.indexOf(results.prefix) !== 0) return;\n\n        if (isImmediate) {\n          immediateResults = results;\n          return;\n        }\n\n        processResults(results);\n      }.bind(this));\n      isImmediate = false;\n\n      if (immediateResults) {\n        var results = immediateResults;\n        immediateResults = null;\n        processResults(results);\n      }\n    };\n\n    CompletionProvider.prototype.detach = function () {\n      this.active = false;\n      this.completers && this.completers.forEach(function (completer) {\n        if (typeof completer.cancel === \"function\") {\n          completer.cancel();\n        }\n      });\n    };\n\n    return CompletionProvider;\n  }();\n\n  var FilteredList =\n  /** @class */\n  function () {\n    function FilteredList(array, filterText) {\n      this.all = array;\n      this.filtered = array;\n      this.filterText = filterText || \"\";\n      this.exactMatch = false;\n      this.ignoreCaption = false;\n    }\n\n    FilteredList.prototype.setFilter = function (str) {\n      if (str.length > this.filterText && str.lastIndexOf(this.filterText, 0) === 0) var matches = this.filtered;else var matches = this.all;\n      this.filterText = str;\n      matches = this.filterCompletions(matches, this.filterText);\n      matches = matches.sort(function (a, b) {\n        return b.exactMatch - a.exactMatch || b.$score - a.$score || (a.caption || a.value).localeCompare(b.caption || b.value);\n      });\n      var prev = null;\n      matches = matches.filter(function (item) {\n        var caption = item.snippet || item.caption || item.value;\n        if (caption === prev) return false;\n        prev = caption;\n        return true;\n      });\n      this.filtered = matches;\n    };\n\n    FilteredList.prototype.filterCompletions = function (items, needle) {\n      var results = [];\n      var upper = needle.toUpperCase();\n      var lower = needle.toLowerCase();\n\n      loop: for (var i = 0, item; item = items[i]; i++) {\n        var caption = !this.ignoreCaption && item.caption || item.value || item.snippet;\n        if (!caption) continue;\n        var lastIndex = -1;\n        var matchMask = 0;\n        var penalty = 0;\n        var index, distance;\n\n        if (this.exactMatch) {\n          if (needle !== caption.substr(0, needle.length)) continue loop;\n        } else {\n          var fullMatchIndex = caption.toLowerCase().indexOf(lower);\n\n          if (fullMatchIndex > -1) {\n            penalty = fullMatchIndex;\n          } else {\n            for (var j = 0; j < needle.length; j++) {\n              var i1 = caption.indexOf(lower[j], lastIndex + 1);\n              var i2 = caption.indexOf(upper[j], lastIndex + 1);\n              index = i1 >= 0 ? i2 < 0 || i1 < i2 ? i1 : i2 : i2;\n              if (index < 0) continue loop;\n              distance = index - lastIndex - 1;\n\n              if (distance > 0) {\n                if (lastIndex === -1) penalty += 10;\n                penalty += distance;\n                matchMask = matchMask | 1 << j;\n              }\n\n              lastIndex = index;\n            }\n          }\n        }\n\n        item.matchMask = matchMask;\n        item.exactMatch = penalty ? 0 : 1;\n        item.$score = (item.score || 0) - penalty;\n        results.push(item);\n      }\n\n      return results;\n    };\n\n    return FilteredList;\n  }();\n\n  exports.Autocomplete = Autocomplete;\n  exports.CompletionProvider = CompletionProvider;\n  exports.FilteredList = FilteredList;\n});\nace.define(\"ace/autocomplete/text_completer\", [\"require\", \"exports\", \"module\", \"ace/range\"], function (require, exports, module) {\n  var Range = require(\"../range\").Range;\n\n  var splitRegex = /[^a-zA-Z_0-9\\$\\-\\u00C0-\\u1FFF\\u2C00-\\uD7FF\\w]+/;\n\n  function getWordIndex(doc, pos) {\n    var textBefore = doc.getTextRange(Range.fromPoints({\n      row: 0,\n      column: 0\n    }, pos));\n    return textBefore.split(splitRegex).length - 1;\n  }\n\n  function wordDistance(doc, pos) {\n    var prefixPos = getWordIndex(doc, pos);\n    var words = doc.getValue().split(splitRegex);\n    var wordScores = Object.create(null);\n    var currentWord = words[prefixPos];\n    words.forEach(function (word, idx) {\n      if (!word || word === currentWord) return;\n      var distance = Math.abs(prefixPos - idx);\n      var score = words.length - distance;\n\n      if (wordScores[word]) {\n        wordScores[word] = Math.max(score, wordScores[word]);\n      } else {\n        wordScores[word] = score;\n      }\n    });\n    return wordScores;\n  }\n\n  exports.getCompletions = function (editor, session, pos, prefix, callback) {\n    var wordScore = wordDistance(session, pos);\n    var wordList = Object.keys(wordScore);\n    callback(null, wordList.map(function (word) {\n      return {\n        caption: word,\n        value: word,\n        score: wordScore[word],\n        meta: \"local\"\n      };\n    }));\n  };\n});\nace.define(\"ace/ext/language_tools\", [\"require\", \"exports\", \"module\", \"ace/snippets\", \"ace/autocomplete\", \"ace/config\", \"ace/lib/lang\", \"ace/autocomplete/util\", \"ace/autocomplete/text_completer\", \"ace/editor\", \"ace/config\"], function (require, exports, module) {\n  \"use strict\";\n\n  var snippetManager = require(\"../snippets\").snippetManager;\n\n  var Autocomplete = require(\"../autocomplete\").Autocomplete;\n\n  var config = require(\"../config\");\n\n  var lang = require(\"../lib/lang\");\n\n  var util = require(\"../autocomplete/util\");\n\n  var textCompleter = require(\"../autocomplete/text_completer\");\n\n  var keyWordCompleter = {\n    getCompletions: function getCompletions(editor, session, pos, prefix, callback) {\n      if (session.$mode.completer) {\n        return session.$mode.completer.getCompletions(editor, session, pos, prefix, callback);\n      }\n\n      var state = editor.session.getState(pos.row);\n      var completions = session.$mode.getCompletions(state, session, pos, prefix);\n      completions = completions.map(function (el) {\n        el.completerId = keyWordCompleter.id;\n        return el;\n      });\n      callback(null, completions);\n    },\n    id: \"keywordCompleter\"\n  };\n\n  var transformSnippetTooltip = function transformSnippetTooltip(str) {\n    var record = {};\n    return str.replace(/\\${(\\d+)(:(.*?))?}/g, function (_, p1, p2, p3) {\n      return record[p1] = p3 || '';\n    }).replace(/\\$(\\d+?)/g, function (_, p1) {\n      return record[p1];\n    });\n  };\n\n  var snippetCompleter = {\n    getCompletions: function getCompletions(editor, session, pos, prefix, callback) {\n      var scopes = [];\n      var token = session.getTokenAt(pos.row, pos.column);\n      if (token && token.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\\.xml$/)) scopes.push('html-tag');else scopes = snippetManager.getActiveScopes(editor);\n      var snippetMap = snippetManager.snippetMap;\n      var completions = [];\n      scopes.forEach(function (scope) {\n        var snippets = snippetMap[scope] || [];\n\n        for (var i = snippets.length; i--;) {\n          var s = snippets[i];\n          var caption = s.name || s.tabTrigger;\n          if (!caption) continue;\n          completions.push({\n            caption: caption,\n            snippet: s.content,\n            meta: s.tabTrigger && !s.name ? s.tabTrigger + \"\\u21E5 \" : \"snippet\",\n            completerId: snippetCompleter.id\n          });\n        }\n      }, this);\n      callback(null, completions);\n    },\n    getDocTooltip: function getDocTooltip(item) {\n      if (item.snippet && !item.docHTML) {\n        item.docHTML = [\"<b>\", lang.escapeHTML(item.caption), \"</b>\", \"<hr></hr>\", lang.escapeHTML(transformSnippetTooltip(item.snippet))].join(\"\");\n      }\n    },\n    id: \"snippetCompleter\"\n  };\n  var completers = [snippetCompleter, textCompleter, keyWordCompleter];\n\n  exports.setCompleters = function (val) {\n    completers.length = 0;\n    if (val) completers.push.apply(completers, val);\n  };\n\n  exports.addCompleter = function (completer) {\n    completers.push(completer);\n  };\n\n  exports.textCompleter = textCompleter;\n  exports.keyWordCompleter = keyWordCompleter;\n  exports.snippetCompleter = snippetCompleter;\n  var expandSnippet = {\n    name: \"expandSnippet\",\n    exec: function exec(editor) {\n      return snippetManager.expandWithTab(editor);\n    },\n    bindKey: \"Tab\"\n  };\n\n  var onChangeMode = function onChangeMode(e, editor) {\n    loadSnippetsForMode(editor.session.$mode);\n  };\n\n  var loadSnippetsForMode = function loadSnippetsForMode(mode) {\n    if (typeof mode == \"string\") mode = config.$modes[mode];\n    if (!mode) return;\n    if (!snippetManager.files) snippetManager.files = {};\n    loadSnippetFile(mode.$id, mode.snippetFileId);\n    if (mode.modes) mode.modes.forEach(loadSnippetsForMode);\n  };\n\n  var loadSnippetFile = function loadSnippetFile(id, snippetFilePath) {\n    if (!snippetFilePath || !id || snippetManager.files[id]) return;\n    snippetManager.files[id] = {};\n    config.loadModule(snippetFilePath, function (m) {\n      if (!m) return;\n      snippetManager.files[id] = m;\n      if (!m.snippets && m.snippetText) m.snippets = snippetManager.parseSnippetFile(m.snippetText);\n      snippetManager.register(m.snippets || [], m.scope);\n\n      if (m.includeScopes) {\n        snippetManager.snippetMap[m.scope].includeScopes = m.includeScopes;\n        m.includeScopes.forEach(function (x) {\n          loadSnippetsForMode(\"ace/mode/\" + x);\n        });\n      }\n    });\n  };\n\n  var doLiveAutocomplete = function doLiveAutocomplete(e) {\n    var editor = e.editor;\n    var hasCompleter = editor.completer && editor.completer.activated;\n\n    if (e.command.name === \"backspace\") {\n      if (hasCompleter && !util.getCompletionPrefix(editor)) editor.completer.detach();\n    } else if (e.command.name === \"insertstring\" && !hasCompleter) {\n      lastExecEvent = e;\n      var delay = e.editor.$liveAutocompletionDelay;\n\n      if (delay) {\n        liveAutocompleteTimer.delay(delay);\n      } else {\n        showLiveAutocomplete(e);\n      }\n    }\n  };\n\n  var lastExecEvent;\n  var liveAutocompleteTimer = lang.delayedCall(function () {\n    showLiveAutocomplete(lastExecEvent);\n  }, 0);\n\n  var showLiveAutocomplete = function showLiveAutocomplete(e) {\n    var editor = e.editor;\n    var prefix = util.getCompletionPrefix(editor);\n    var previousChar = e.args;\n    var triggerAutocomplete = util.triggerAutocomplete(editor, previousChar);\n\n    if (prefix && prefix.length >= editor.$liveAutocompletionThreshold || triggerAutocomplete) {\n      var completer = Autocomplete.for(editor);\n      completer.autoShown = true;\n      completer.showPopup(editor);\n    }\n  };\n\n  var Editor = require(\"../editor\").Editor;\n\n  require(\"../config\").defineOptions(Editor.prototype, \"editor\", {\n    enableBasicAutocompletion: {\n      set: function set(val) {\n        if (val) {\n          if (!this.completers) this.completers = Array.isArray(val) ? val : completers;\n          this.commands.addCommand(Autocomplete.startCommand);\n        } else {\n          this.commands.removeCommand(Autocomplete.startCommand);\n        }\n      },\n      value: false\n    },\n    enableLiveAutocompletion: {\n      set: function set(val) {\n        if (val) {\n          if (!this.completers) this.completers = Array.isArray(val) ? val : completers;\n          this.commands.on('afterExec', doLiveAutocomplete);\n        } else {\n          this.commands.off('afterExec', doLiveAutocomplete);\n        }\n      },\n      value: false\n    },\n    liveAutocompletionDelay: {\n      initialValue: 0\n    },\n    liveAutocompletionThreshold: {\n      initialValue: 0\n    },\n    enableSnippets: {\n      set: function set(val) {\n        if (val) {\n          this.commands.addCommand(expandSnippet);\n          this.on(\"changeMode\", onChangeMode);\n          onChangeMode(null, this);\n        } else {\n          this.commands.removeCommand(expandSnippet);\n          this.off(\"changeMode\", onChangeMode);\n        }\n      },\n      value: false\n    }\n  });\n});\n\n(function () {\n  ace.require([\"ace/ext/language_tools\"], function (m) {\n    if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n      module.exports = m;\n    }\n  });\n})();","map":{"version":3,"sources":["/home/amogha/Documents/sem-6/btp-1/deploy/deployed/vreqst/node_modules/ace-builds/src-noconflict/ext-language_tools.js"],"names":["ace","define","require","exports","module","dom","oop","EventEmitter","lang","Range","RangeList","HashHandler","Tokenizer","clipboard","VARIABLES","CURRENT_WORD","editor","session","getTextRange","getWordRange","SELECTION","name","indentation","text","replace","CURRENT_LINE","getLine","getCursorPosition","row","PREV_LINE","LINE_INDEX","LINE_NUMBER","SOFT_TABS","getUseSoftTabs","TAB_SIZE","getTabSize","CLIPBOARD","getText","FILENAME","exec","FILEPATH","FILENAME_BASE","DIRECTORY","WORKSPACE_NAME","FULLNAME","BLOCK_COMMENT_START","mode","$mode","blockComment","start","BLOCK_COMMENT_END","end","LINE_COMMENT","lineCommentStart","CURRENT_YEAR","date","bind","year","CURRENT_YEAR_SHORT","CURRENT_MONTH","month","CURRENT_MONTH_NAME","CURRENT_MONTH_NAME_SHORT","CURRENT_DATE","day","CURRENT_DAY_NAME","weekday","CURRENT_DAY_NAME_SHORT","CURRENT_HOUR","hour","hour12","CURRENT_MINUTE","minute","CURRENT_SECOND","second","SELECTED_TEXT","dateFormat","str","Date","toLocaleString","length","SnippetManager","snippetMap","snippetNameMap","variables","prototype","getTokenizer","createTokenizer","TabstopToken","substr","test","tabstopId","parseInt","escape","ch","formatMatcher","regex","onMatch","val","state","stack","ts","fmtString","guard","slice","flag","next","indexOf","shift","t","unshift","token","merge","snippetVar","choices","operator","split","map","value","formatString","expectElse","ifEnd","elseEnd","changeCase","local","formatStringVar","formatFunction","tokenizeTmSnippet","startState","getLineTokens","tokens","x","getVariableValue","__","hasOwnProperty","tmStrFormat","fmt","re","RegExp","fmtTokens","_self","formatted","oldArgs","call","arguments","fmtParts","resolveVariables","gChangeCase","i","toUpperCase","toLowerCase","join","tmFormatFunction","snippet","result","afterNewLine","push","j","gotoNext","i1","getDisplayTextForSnippet","snippetText","processedSnippet","processSnippetText","insertSnippetForSelection","options","range","getSelectionRange","tabstopManager","TabstopManager","selectionId","inVirtualSelectionMode","selection","index","addTabstops","tabstops","insertSnippet","self","forEachSelection","keepOrder","tabNext","$getScope","scope","$id","pop","inlinePhp","c","getState","substring","getActiveScopes","scopes","includeScopes","apply","expandWithTab","expandSnippetForSelection","cursor","line","before","column","after","some","snippets","findMatchingSnippet","dryRun","doc","removeInLine","replaceBefore","replaceAfter","M__","matchBefore","T__","matchAfter","content","snippetList","s","startRe","endRe","triggerRe","endTriggerRe","register","wrapRegexp","src","guardedRegexp","opening","addSnippet","old","unregister","prefix","tabTrigger","body","Array","isArray","trigger","escapeRegExp","endTrigger","endGuard","forEach","Object","keys","key","_signal","removeSnippet","nameMap","splice","parseSnippetFile","list","m","JSON","parse","e","guardRe","match","getSnippetByName","implement","tabString","getTabString","indentString","excludeExtraIndent","p","id","parents","isNested","expanding","copyValue","copy","lastIndexOf","parentId","Math","max","concat","lines","ranges","$onChange","onChange","$onChangeSelection","delayedCall","onChangeSelection","schedule","$onChangeSession","onChangeSession","$onAfterExec","onAfterExec","attach","$openTabstops","selectedTabstop","on","commands","keyBinding","addKeyboardHandler","keyboardHandler","detach","removeTabstopMarkers","off","removeKeyboardHandler","delta","isRemove","action","active","rangeList","$bias","parentActive","startIndex","pointIndex","endIndex","toRemove","removeRange","$inChange","getLength","getValue","updateLinkedFields","hasLinkedRanges","firstNonLinked","linked","original","snippetManager","command","readOnly","lead","anchor","isEmpty","containsLead","contains","containsAnchor","dir","min","selectTabstop","updateTabstopMarkers","addTabstopMarkers","sel","multiSelect","toSingleRange","addRange","clone","fromOrientedRange","execCommand","matches","useLink","getOption","fromPoints","moveRelative","arg","snippetId","dest","movePoint","tabstop","addList","markerId","addMarker","removeMarker","currentSnippetId","bindKeys","renderer","scrollCursorIntoView","point","diff","importCssString","Editor","expandSnippet","Renderer","VirtualRenderer","event","nls","userAgent","getAriaId","popupAriaRole","isSafari","optionAriaRole","ariaActiveState","$singleLineEditor","el","$maxLines","setHighlightActiveLine","setShowPrintMargin","setShowGutter","setHighlightGutterLine","$mouseHandler","$focusTimeout","$highlightTagPending","AcePopup","parentNode","createElement","popup","appendChild","style","display","setStyle","$textLayer","element","setAttribute","textarea","setOption","noop","focus","$isFocused","$cursorLayer","restartTimer","opacity","$keepTextAreaAtCursor","highlight","$searchHighlight","clazz","pos","getDocumentPosition","moveToPosition","selectionMarker","stop","lastMouseEvent","hoverMarker","Infinity","setSelectOnHover","y","scrollTop","isMouseOver","setRow","setHoverMarker","$pos","getRow","selected","childNodes","config","firstRow","document","activeElement","selectedNode","removeCssClass","removeAttribute","addCssClass","ariaId","getData","caption","data","hideHoverMarker","suppressRedraw","_emit","getHoveredRow","addListener","container","bgTokenizer","$tokenizeRow","addToken","className","type","lower","filterText","lastIndex","lastI","matchMask","sub","meta","message","$updateOnChange","$computeWidth","screenWidth","isOpen","isTopdown","autoSelect","setData","setValue","stringRepeat","clearSelection","moveCursorTo","hide","anchorPos","tryShow","lineHeight","forceShow","top","left","screenHeight","window","innerHeight","innerWidth","maxH","dims","bottom","spaceBelow","$borderSize","spaceAbove","fitsX","$maxPixelHeight","offsetWidth","right","show","topdownOnly","undefined","goTo","where","getTextLeftOffset","$padding","$imageSize","AceInlineScreenReader","screenReaderDiv","classList","add","setScreenReaderContent","completer","idString","lineIndex","_lines","firstChild","removeChild","codeElement","createCodeBlock","destroy","remove","createTextNode","AceInline","completion","inlineScreenReader","displayText","hideInlinePreview","startsWith","removeGhostText","setGhostText","$ghostText","parForEach","array","fn","callback","completed","arLength","err","ID_REGEX","retrievePrecedingIdentifier","buf","reverse","retrieveFollowingIdentifier","getCompletionPrefix","completers","identifierRegexps","identifierRegex","triggerAutocomplete","previousChar","getPrecedingCharacter","triggerCharacters","includes","util","preventParentScroll","destroyCompleter","Autocomplete","autoInsert","autoShown","exactMatch","inlineEnabled","hasSeen","Set","showLoadingState","stickySelectionDelay","blurListener","changeListener","mousedownListener","mousewheelListener","onLayoutChange","changeTimer","updateCompletions","tooltipTimer","updateDocTooltip","popupTimer","$updatePopupPosition","stickySelectionTimer","stickySelection","$firstOpenTimer","initialPosition","completionProvider","completions","FilteredList","completionsForLoading","openPopup","defineProperty","get","enumerable","configurable","$init","documentElement","insertMatch","$onPopupShow","$onHidePopup","$onPopupChange","mouseOutListener","$onPopupRender","$initInline","inlineRenderer","getPopup","hideDocTooltip","cancel","$seen","has","onSeen","$updateGhostText","base","cursorColumn","filtered","getFirstVisibleRow","getLastVisibleRow","observeLayoutChanges","$elements","addEventListener","passive","elements","unObserveLayoutChanges","_this","removeEventListener","layerConfig","getPixelPosition","rect","getBoundingClientRect","offset","scrollLeft","gutterWidth","posGhostText","$ghostTextWidget","position","offsetHeight","editorContainerBottom","lowestPosition","keepPopupPosition","oldRow","previousSelectedItem","textInput","setAriaOptions","activeDescendant","inline","newRow","setTheme","getTheme","setFontSize","getFontSize","tooltipNode","activated","getElement","fromTooltip","relatedTarget","getCompletionProvider","showPopup","CompletionProvider","gatherCompletions","setFilter","createAnchor","$insertRight","getSession","completionOptions","ignoreCaption","provideCompletions","finished","emptyMessage","completionsForEmpty","delay","cancelContextMenu","all","completersLength","getDocTooltip","completerId","docText","docHTML","showDocTooltip","item","margin","pointerEvents","overscrollBehavior","tabIndex","onblur","onclick","onTooltipClick","theme","isDark","cssClass","innerHTML","textContent","offsetTop","isFocused","a","target","nodeName","href","rel","deleteSuffix","gotoPageUp","gotoPageDown","for","once","startCommand","bindKey","insertByIndex","startOperation","getAllRanges","$insertString","onInsert","endOperation","total","getCompletions","results","assign","processResults","isImmediate","immediateResults","filterCompletions","sort","b","$score","localeCompare","prev","filter","items","needle","upper","loop","penalty","distance","fullMatchIndex","i2","score","splitRegex","getWordIndex","textBefore","wordDistance","prefixPos","words","wordScores","create","currentWord","word","idx","abs","wordScore","wordList","textCompleter","keyWordCompleter","transformSnippetTooltip","record","_","p1","p2","p3","snippetCompleter","getTokenAt","escapeHTML","setCompleters","addCompleter","onChangeMode","loadSnippetsForMode","$modes","files","loadSnippetFile","snippetFileId","modes","snippetFilePath","loadModule","doLiveAutocomplete","hasCompleter","lastExecEvent","$liveAutocompletionDelay","liveAutocompleteTimer","showLiveAutocomplete","args","$liveAutocompletionThreshold","defineOptions","enableBasicAutocompletion","set","addCommand","removeCommand","enableLiveAutocompletion","liveAutocompletionDelay","initialValue","liveAutocompletionThreshold","enableSnippets"],"mappings":"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","sourcesContent":["ace.define(\"ace/snippets\",[\"require\",\"exports\",\"module\",\"ace/lib/dom\",\"ace/lib/oop\",\"ace/lib/event_emitter\",\"ace/lib/lang\",\"ace/range\",\"ace/range_list\",\"ace/keyboard/hash_handler\",\"ace/tokenizer\",\"ace/clipboard\",\"ace/editor\"], function(require, exports, module){\"use strict\";\nvar dom = require(\"./lib/dom\");\nvar oop = require(\"./lib/oop\");\nvar EventEmitter = require(\"./lib/event_emitter\").EventEmitter;\nvar lang = require(\"./lib/lang\");\nvar Range = require(\"./range\").Range;\nvar RangeList = require(\"./range_list\").RangeList;\nvar HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\nvar Tokenizer = require(\"./tokenizer\").Tokenizer;\nvar clipboard = require(\"./clipboard\");\nvar VARIABLES = {\n    CURRENT_WORD: function (editor) {\n        return editor.session.getTextRange(editor.session.getWordRange());\n    },\n    SELECTION: function (editor, name, indentation) {\n        var text = editor.session.getTextRange();\n        if (indentation)\n            return text.replace(/\\n\\r?([ \\t]*\\S)/g, \"\\n\" + indentation + \"$1\");\n        return text;\n    },\n    CURRENT_LINE: function (editor) {\n        return editor.session.getLine(editor.getCursorPosition().row);\n    },\n    PREV_LINE: function (editor) {\n        return editor.session.getLine(editor.getCursorPosition().row - 1);\n    },\n    LINE_INDEX: function (editor) {\n        return editor.getCursorPosition().row;\n    },\n    LINE_NUMBER: function (editor) {\n        return editor.getCursorPosition().row + 1;\n    },\n    SOFT_TABS: function (editor) {\n        return editor.session.getUseSoftTabs() ? \"YES\" : \"NO\";\n    },\n    TAB_SIZE: function (editor) {\n        return editor.session.getTabSize();\n    },\n    CLIPBOARD: function (editor) {\n        return clipboard.getText && clipboard.getText();\n    },\n    FILENAME: function (editor) {\n        return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0];\n    },\n    FILENAME_BASE: function (editor) {\n        return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0].replace(/\\.[^.]*$/, \"\");\n    },\n    DIRECTORY: function (editor) {\n        return this.FILEPATH(editor).replace(/[^/\\\\]*$/, \"\");\n    },\n    FILEPATH: function (editor) { return \"/not implemented.txt\"; },\n    WORKSPACE_NAME: function () { return \"Unknown\"; },\n    FULLNAME: function () { return \"Unknown\"; },\n    BLOCK_COMMENT_START: function (editor) {\n        var mode = editor.session.$mode || {};\n        return mode.blockComment && mode.blockComment.start || \"\";\n    },\n    BLOCK_COMMENT_END: function (editor) {\n        var mode = editor.session.$mode || {};\n        return mode.blockComment && mode.blockComment.end || \"\";\n    },\n    LINE_COMMENT: function (editor) {\n        var mode = editor.session.$mode || {};\n        return mode.lineCommentStart || \"\";\n    },\n    CURRENT_YEAR: date.bind(null, { year: \"numeric\" }),\n    CURRENT_YEAR_SHORT: date.bind(null, { year: \"2-digit\" }),\n    CURRENT_MONTH: date.bind(null, { month: \"numeric\" }),\n    CURRENT_MONTH_NAME: date.bind(null, { month: \"long\" }),\n    CURRENT_MONTH_NAME_SHORT: date.bind(null, { month: \"short\" }),\n    CURRENT_DATE: date.bind(null, { day: \"2-digit\" }),\n    CURRENT_DAY_NAME: date.bind(null, { weekday: \"long\" }),\n    CURRENT_DAY_NAME_SHORT: date.bind(null, { weekday: \"short\" }),\n    CURRENT_HOUR: date.bind(null, { hour: \"2-digit\", hour12: false }),\n    CURRENT_MINUTE: date.bind(null, { minute: \"2-digit\" }),\n    CURRENT_SECOND: date.bind(null, { second: \"2-digit\" })\n};\nVARIABLES.SELECTED_TEXT = VARIABLES.SELECTION;\nfunction date(dateFormat) {\n    var str = new Date().toLocaleString(\"en-us\", dateFormat);\n    return str.length == 1 ? \"0\" + str : str;\n}\nvar SnippetManager = /** @class */ (function () {\n    function SnippetManager() {\n        this.snippetMap = {};\n        this.snippetNameMap = {};\n        this.variables = VARIABLES;\n    }\n    SnippetManager.prototype.getTokenizer = function () {\n        return SnippetManager[\"$tokenizer\"] || this.createTokenizer();\n    };\n    SnippetManager.prototype.createTokenizer = function () {\n        function TabstopToken(str) {\n            str = str.substr(1);\n            if (/^\\d+$/.test(str))\n                return [{ tabstopId: parseInt(str, 10) }];\n            return [{ text: str }];\n        }\n        function escape(ch) {\n            return \"(?:[^\\\\\\\\\" + ch + \"]|\\\\\\\\.)\";\n        }\n        var formatMatcher = {\n            regex: \"/(\" + escape(\"/\") + \"+)/\",\n            onMatch: function (val, state, stack) {\n                var ts = stack[0];\n                ts.fmtString = true;\n                ts.guard = val.slice(1, -1);\n                ts.flag = \"\";\n                return \"\";\n            },\n            next: \"formatString\"\n        };\n        SnippetManager[\"$tokenizer\"] = new Tokenizer({\n            start: [\n                { regex: /\\\\./, onMatch: function (val, state, stack) {\n                        var ch = val[1];\n                        if (ch == \"}\" && stack.length) {\n                            val = ch;\n                        }\n                        else if (\"`$\\\\\".indexOf(ch) != -1) {\n                            val = ch;\n                        }\n                        return [val];\n                    } },\n                { regex: /}/, onMatch: function (val, state, stack) {\n                        return [stack.length ? stack.shift() : val];\n                    } },\n                { regex: /\\$(?:\\d+|\\w+)/, onMatch: TabstopToken },\n                { regex: /\\$\\{[\\dA-Z_a-z]+/, onMatch: function (str, state, stack) {\n                        var t = TabstopToken(str.substr(1));\n                        stack.unshift(t[0]);\n                        return t;\n                    }, next: \"snippetVar\" },\n                { regex: /\\n/, token: \"newline\", merge: false }\n            ],\n            snippetVar: [\n                { regex: \"\\\\|\" + escape(\"\\\\|\") + \"*\\\\|\", onMatch: function (val, state, stack) {\n                        var choices = val.slice(1, -1).replace(/\\\\[,|\\\\]|,/g, function (operator) {\n                            return operator.length == 2 ? operator[1] : \"\\x00\";\n                        }).split(\"\\x00\").map(function (value) {\n                            return { value: value };\n                        });\n                        stack[0].choices = choices;\n                        return [choices[0]];\n                    }, next: \"start\" },\n                formatMatcher,\n                { regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\", token: \"\", next: \"start\" }\n            ],\n            formatString: [\n                { regex: /:/, onMatch: function (val, state, stack) {\n                        if (stack.length && stack[0].expectElse) {\n                            stack[0].expectElse = false;\n                            stack[0].ifEnd = { elseEnd: stack[0] };\n                            return [stack[0].ifEnd];\n                        }\n                        return \":\";\n                    } },\n                { regex: /\\\\./, onMatch: function (val, state, stack) {\n                        var ch = val[1];\n                        if (ch == \"}\" && stack.length)\n                            val = ch;\n                        else if (\"`$\\\\\".indexOf(ch) != -1)\n                            val = ch;\n                        else if (ch == \"n\")\n                            val = \"\\n\";\n                        else if (ch == \"t\")\n                            val = \"\\t\";\n                        else if (\"ulULE\".indexOf(ch) != -1)\n                            val = { changeCase: ch, local: ch > \"a\" };\n                        return [val];\n                    } },\n                { regex: \"/\\\\w*}\", onMatch: function (val, state, stack) {\n                        var next = stack.shift();\n                        if (next)\n                            next.flag = val.slice(1, -1);\n                        this.next = next && next.tabstopId ? \"start\" : \"\";\n                        return [next || val];\n                    }, next: \"start\" },\n                { regex: /\\$(?:\\d+|\\w+)/, onMatch: function (val, state, stack) {\n                        return [{ text: val.slice(1) }];\n                    } },\n                { regex: /\\${\\w+/, onMatch: function (val, state, stack) {\n                        var token = { text: val.slice(2) };\n                        stack.unshift(token);\n                        return [token];\n                    }, next: \"formatStringVar\" },\n                { regex: /\\n/, token: \"newline\", merge: false },\n                { regex: /}/, onMatch: function (val, state, stack) {\n                        var next = stack.shift();\n                        this.next = next && next.tabstopId ? \"start\" : \"\";\n                        return [next || val];\n                    }, next: \"start\" }\n            ],\n            formatStringVar: [\n                { regex: /:\\/\\w+}/, onMatch: function (val, state, stack) {\n                        var ts = stack[0];\n                        ts.formatFunction = val.slice(2, -1);\n                        return [stack.shift()];\n                    }, next: \"formatString\" },\n                formatMatcher,\n                { regex: /:[\\?\\-+]?/, onMatch: function (val, state, stack) {\n                        if (val[1] == \"+\")\n                            stack[0].ifEnd = stack[0];\n                        if (val[1] == \"?\")\n                            stack[0].expectElse = true;\n                    }, next: \"formatString\" },\n                { regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\", token: \"\", next: \"formatString\" }\n            ]\n        });\n        return SnippetManager[\"$tokenizer\"];\n    };\n    SnippetManager.prototype.tokenizeTmSnippet = function (str, startState) {\n        return this.getTokenizer().getLineTokens(str, startState).tokens.map(function (x) {\n            return x.value || x;\n        });\n    };\n    SnippetManager.prototype.getVariableValue = function (editor, name, indentation) {\n        if (/^\\d+$/.test(name))\n            return (this.variables.__ || {})[name] || \"\";\n        if (/^[A-Z]\\d+$/.test(name))\n            return (this.variables[name[0] + \"__\"] || {})[name.substr(1)] || \"\";\n        name = name.replace(/^TM_/, \"\");\n        if (!this.variables.hasOwnProperty(name))\n            return \"\";\n        var value = this.variables[name];\n        if (typeof value == \"function\")\n            value = this.variables[name](editor, name, indentation);\n        return value == null ? \"\" : value;\n    };\n    SnippetManager.prototype.tmStrFormat = function (str, ch, editor) {\n        if (!ch.fmt)\n            return str;\n        var flag = ch.flag || \"\";\n        var re = ch.guard;\n        re = new RegExp(re, flag.replace(/[^gim]/g, \"\"));\n        var fmtTokens = typeof ch.fmt == \"string\" ? this.tokenizeTmSnippet(ch.fmt, \"formatString\") : ch.fmt;\n        var _self = this;\n        var formatted = str.replace(re, function () {\n            var oldArgs = _self.variables.__;\n            _self.variables.__ = [].slice.call(arguments);\n            var fmtParts = _self.resolveVariables(fmtTokens, editor);\n            var gChangeCase = \"E\";\n            for (var i = 0; i < fmtParts.length; i++) {\n                var ch = fmtParts[i];\n                if (typeof ch == \"object\") {\n                    fmtParts[i] = \"\";\n                    if (ch.changeCase && ch.local) {\n                        var next = fmtParts[i + 1];\n                        if (next && typeof next == \"string\") {\n                            if (ch.changeCase == \"u\")\n                                fmtParts[i] = next[0].toUpperCase();\n                            else\n                                fmtParts[i] = next[0].toLowerCase();\n                            fmtParts[i + 1] = next.substr(1);\n                        }\n                    }\n                    else if (ch.changeCase) {\n                        gChangeCase = ch.changeCase;\n                    }\n                }\n                else if (gChangeCase == \"U\") {\n                    fmtParts[i] = ch.toUpperCase();\n                }\n                else if (gChangeCase == \"L\") {\n                    fmtParts[i] = ch.toLowerCase();\n                }\n            }\n            _self.variables.__ = oldArgs;\n            return fmtParts.join(\"\");\n        });\n        return formatted;\n    };\n    SnippetManager.prototype.tmFormatFunction = function (str, ch, editor) {\n        if (ch.formatFunction == \"upcase\")\n            return str.toUpperCase();\n        if (ch.formatFunction == \"downcase\")\n            return str.toLowerCase();\n        return str;\n    };\n    SnippetManager.prototype.resolveVariables = function (snippet, editor) {\n        var result = [];\n        var indentation = \"\";\n        var afterNewLine = true;\n        for (var i = 0; i < snippet.length; i++) {\n            var ch = snippet[i];\n            if (typeof ch == \"string\") {\n                result.push(ch);\n                if (ch == \"\\n\") {\n                    afterNewLine = true;\n                    indentation = \"\";\n                }\n                else if (afterNewLine) {\n                    indentation = /^\\t*/.exec(ch)[0];\n                    afterNewLine = /\\S/.test(ch);\n                }\n                continue;\n            }\n            if (!ch)\n                continue;\n            afterNewLine = false;\n            if (ch.fmtString) {\n                var j = snippet.indexOf(ch, i + 1);\n                if (j == -1)\n                    j = snippet.length;\n                ch.fmt = snippet.slice(i + 1, j);\n                i = j;\n            }\n            if (ch.text) {\n                var value = this.getVariableValue(editor, ch.text, indentation) + \"\";\n                if (ch.fmtString)\n                    value = this.tmStrFormat(value, ch, editor);\n                if (ch.formatFunction)\n                    value = this.tmFormatFunction(value, ch, editor);\n                if (value && !ch.ifEnd) {\n                    result.push(value);\n                    gotoNext(ch);\n                }\n                else if (!value && ch.ifEnd) {\n                    gotoNext(ch.ifEnd);\n                }\n            }\n            else if (ch.elseEnd) {\n                gotoNext(ch.elseEnd);\n            }\n            else if (ch.tabstopId != null) {\n                result.push(ch);\n            }\n            else if (ch.changeCase != null) {\n                result.push(ch);\n            }\n        }\n        function gotoNext(ch) {\n            var i1 = snippet.indexOf(ch, i + 1);\n            if (i1 != -1)\n                i = i1;\n        }\n        return result;\n    };\n    SnippetManager.prototype.getDisplayTextForSnippet = function (editor, snippetText) {\n        var processedSnippet = processSnippetText.call(this, editor, snippetText);\n        return processedSnippet.text;\n    };\n    SnippetManager.prototype.insertSnippetForSelection = function (editor, snippetText, options) {\n        if (options === void 0) { options = {}; }\n        var processedSnippet = processSnippetText.call(this, editor, snippetText, options);\n        var range = editor.getSelectionRange();\n        var end = editor.session.replace(range, processedSnippet.text);\n        var tabstopManager = new TabstopManager(editor);\n        var selectionId = editor.inVirtualSelectionMode && editor.selection.index;\n        tabstopManager.addTabstops(processedSnippet.tabstops, range.start, end, selectionId);\n    };\n    SnippetManager.prototype.insertSnippet = function (editor, snippetText, options) {\n        if (options === void 0) { options = {}; }\n        var self = this;\n        if (editor.inVirtualSelectionMode)\n            return self.insertSnippetForSelection(editor, snippetText, options);\n        editor.forEachSelection(function () {\n            self.insertSnippetForSelection(editor, snippetText, options);\n        }, null, { keepOrder: true });\n        if (editor.tabstopManager)\n            editor.tabstopManager.tabNext();\n    };\n    SnippetManager.prototype.$getScope = function (editor) {\n        var scope = editor.session.$mode.$id || \"\";\n        scope = scope.split(\"/\").pop();\n        if (scope === \"html\" || scope === \"php\") {\n            if (scope === \"php\" && !editor.session.$mode.inlinePhp)\n                scope = \"html\";\n            var c = editor.getCursorPosition();\n            var state = editor.session.getState(c.row);\n            if (typeof state === \"object\") {\n                state = state[0];\n            }\n            if (state.substring) {\n                if (state.substring(0, 3) == \"js-\")\n                    scope = \"javascript\";\n                else if (state.substring(0, 4) == \"css-\")\n                    scope = \"css\";\n                else if (state.substring(0, 4) == \"php-\")\n                    scope = \"php\";\n            }\n        }\n        return scope;\n    };\n    SnippetManager.prototype.getActiveScopes = function (editor) {\n        var scope = this.$getScope(editor);\n        var scopes = [scope];\n        var snippetMap = this.snippetMap;\n        if (snippetMap[scope] && snippetMap[scope].includeScopes) {\n            scopes.push.apply(scopes, snippetMap[scope].includeScopes);\n        }\n        scopes.push(\"_\");\n        return scopes;\n    };\n    SnippetManager.prototype.expandWithTab = function (editor, options) {\n        var self = this;\n        var result = editor.forEachSelection(function () {\n            return self.expandSnippetForSelection(editor, options);\n        }, null, { keepOrder: true });\n        if (result && editor.tabstopManager)\n            editor.tabstopManager.tabNext();\n        return result;\n    };\n    SnippetManager.prototype.expandSnippetForSelection = function (editor, options) {\n        var cursor = editor.getCursorPosition();\n        var line = editor.session.getLine(cursor.row);\n        var before = line.substring(0, cursor.column);\n        var after = line.substr(cursor.column);\n        var snippetMap = this.snippetMap;\n        var snippet;\n        this.getActiveScopes(editor).some(function (scope) {\n            var snippets = snippetMap[scope];\n            if (snippets)\n                snippet = this.findMatchingSnippet(snippets, before, after);\n            return !!snippet;\n        }, this);\n        if (!snippet)\n            return false;\n        if (options && options.dryRun)\n            return true;\n        editor.session.doc.removeInLine(cursor.row, cursor.column - snippet.replaceBefore.length, cursor.column + snippet.replaceAfter.length);\n        this.variables.M__ = snippet.matchBefore;\n        this.variables.T__ = snippet.matchAfter;\n        this.insertSnippetForSelection(editor, snippet.content);\n        this.variables.M__ = this.variables.T__ = null;\n        return true;\n    };\n    SnippetManager.prototype.findMatchingSnippet = function (snippetList, before, after) {\n        for (var i = snippetList.length; i--;) {\n            var s = snippetList[i];\n            if (s.startRe && !s.startRe.test(before))\n                continue;\n            if (s.endRe && !s.endRe.test(after))\n                continue;\n            if (!s.startRe && !s.endRe)\n                continue;\n            s.matchBefore = s.startRe ? s.startRe.exec(before) : [\"\"];\n            s.matchAfter = s.endRe ? s.endRe.exec(after) : [\"\"];\n            s.replaceBefore = s.triggerRe ? s.triggerRe.exec(before)[0] : \"\";\n            s.replaceAfter = s.endTriggerRe ? s.endTriggerRe.exec(after)[0] : \"\";\n            return s;\n        }\n    };\n    SnippetManager.prototype.register = function (snippets, scope) {\n        var snippetMap = this.snippetMap;\n        var snippetNameMap = this.snippetNameMap;\n        var self = this;\n        if (!snippets)\n            snippets = [];\n        function wrapRegexp(src) {\n            if (src && !/^\\^?\\(.*\\)\\$?$|^\\\\b$/.test(src))\n                src = \"(?:\" + src + \")\";\n            return src || \"\";\n        }\n        function guardedRegexp(re, guard, opening) {\n            re = wrapRegexp(re);\n            guard = wrapRegexp(guard);\n            if (opening) {\n                re = guard + re;\n                if (re && re[re.length - 1] != \"$\")\n                    re = re + \"$\";\n            }\n            else {\n                re = re + guard;\n                if (re && re[0] != \"^\")\n                    re = \"^\" + re;\n            }\n            return new RegExp(re);\n        }\n        function addSnippet(s) {\n            if (!s.scope)\n                s.scope = scope || \"_\";\n            scope = s.scope;\n            if (!snippetMap[scope]) {\n                snippetMap[scope] = [];\n                snippetNameMap[scope] = {};\n            }\n            var map = snippetNameMap[scope];\n            if (s.name) {\n                var old = map[s.name];\n                if (old)\n                    self.unregister(old);\n                map[s.name] = s;\n            }\n            snippetMap[scope].push(s);\n            if (s.prefix)\n                s.tabTrigger = s.prefix;\n            if (!s.content && s.body)\n                s.content = Array.isArray(s.body) ? s.body.join(\"\\n\") : s.body;\n            if (s.tabTrigger && !s.trigger) {\n                if (!s.guard && /^\\w/.test(s.tabTrigger))\n                    s.guard = \"\\\\b\";\n                s.trigger = lang.escapeRegExp(s.tabTrigger);\n            }\n            if (!s.trigger && !s.guard && !s.endTrigger && !s.endGuard)\n                return;\n            s.startRe = guardedRegexp(s.trigger, s.guard, true);\n            s.triggerRe = new RegExp(s.trigger);\n            s.endRe = guardedRegexp(s.endTrigger, s.endGuard, true);\n            s.endTriggerRe = new RegExp(s.endTrigger);\n        }\n        if (Array.isArray(snippets)) {\n            snippets.forEach(addSnippet);\n        }\n        else {\n            Object.keys(snippets).forEach(function (key) {\n                addSnippet(snippets[key]);\n            });\n        }\n        this._signal(\"registerSnippets\", { scope: scope });\n    };\n    SnippetManager.prototype.unregister = function (snippets, scope) {\n        var snippetMap = this.snippetMap;\n        var snippetNameMap = this.snippetNameMap;\n        function removeSnippet(s) {\n            var nameMap = snippetNameMap[s.scope || scope];\n            if (nameMap && nameMap[s.name]) {\n                delete nameMap[s.name];\n                var map = snippetMap[s.scope || scope];\n                var i = map && map.indexOf(s);\n                if (i >= 0)\n                    map.splice(i, 1);\n            }\n        }\n        if (snippets.content)\n            removeSnippet(snippets);\n        else if (Array.isArray(snippets))\n            snippets.forEach(removeSnippet);\n    };\n    SnippetManager.prototype.parseSnippetFile = function (str) {\n        str = str.replace(/\\r/g, \"\");\n        var list = [], /**@type{Snippet}*/ snippet = {};\n        var re = /^#.*|^({[\\s\\S]*})\\s*$|^(\\S+) (.*)$|^((?:\\n*\\t.*)+)/gm;\n        var m;\n        while (m = re.exec(str)) {\n            if (m[1]) {\n                try {\n                    snippet = JSON.parse(m[1]);\n                    list.push(snippet);\n                }\n                catch (e) { }\n            }\n            if (m[4]) {\n                snippet.content = m[4].replace(/^\\t/gm, \"\");\n                list.push(snippet);\n                snippet = {};\n            }\n            else {\n                var key = m[2], val = m[3];\n                if (key == \"regex\") {\n                    var guardRe = /\\/((?:[^\\/\\\\]|\\\\.)*)|$/g;\n                    snippet.guard = guardRe.exec(val)[1];\n                    snippet.trigger = guardRe.exec(val)[1];\n                    snippet.endTrigger = guardRe.exec(val)[1];\n                    snippet.endGuard = guardRe.exec(val)[1];\n                }\n                else if (key == \"snippet\") {\n                    snippet.tabTrigger = val.match(/^\\S*/)[0];\n                    if (!snippet.name)\n                        snippet.name = val;\n                }\n                else if (key) {\n                    snippet[key] = val;\n                }\n            }\n        }\n        return list;\n    };\n    SnippetManager.prototype.getSnippetByName = function (name, editor) {\n        var snippetMap = this.snippetNameMap;\n        var snippet;\n        this.getActiveScopes(editor).some(function (scope) {\n            var snippets = snippetMap[scope];\n            if (snippets)\n                snippet = snippets[name];\n            return !!snippet;\n        }, this);\n        return snippet;\n    };\n    return SnippetManager;\n}());\noop.implement(SnippetManager.prototype, EventEmitter);\nvar processSnippetText = function (editor, snippetText, options) {\n    if (options === void 0) { options = {}; }\n    var cursor = editor.getCursorPosition();\n    var line = editor.session.getLine(cursor.row);\n    var tabString = editor.session.getTabString();\n    var indentString = line.match(/^\\s*/)[0];\n    if (cursor.column < indentString.length)\n        indentString = indentString.slice(0, cursor.column);\n    snippetText = snippetText.replace(/\\r/g, \"\");\n    var tokens = this.tokenizeTmSnippet(snippetText);\n    tokens = this.resolveVariables(tokens, editor);\n    tokens = tokens.map(function (x) {\n        if (x == \"\\n\" && !options.excludeExtraIndent)\n            return x + indentString;\n        if (typeof x == \"string\")\n            return x.replace(/\\t/g, tabString);\n        return x;\n    });\n    var tabstops = [];\n    tokens.forEach(function (p, i) {\n        if (typeof p != \"object\")\n            return;\n        var id = p.tabstopId;\n        var ts = tabstops[id];\n        if (!ts) {\n            ts = tabstops[id] = [];\n            ts.index = id;\n            ts.value = \"\";\n            ts.parents = {};\n        }\n        if (ts.indexOf(p) !== -1)\n            return;\n        if (p.choices && !ts.choices)\n            ts.choices = p.choices;\n        ts.push(p);\n        var i1 = tokens.indexOf(p, i + 1);\n        if (i1 === -1)\n            return;\n        var value = tokens.slice(i + 1, i1);\n        var isNested = value.some(function (t) { return typeof t === \"object\"; });\n        if (isNested && !ts.value) {\n            ts.value = value;\n        }\n        else if (value.length && (!ts.value || typeof ts.value !== \"string\")) {\n            ts.value = value.join(\"\");\n        }\n    });\n    tabstops.forEach(function (ts) { ts.length = 0; });\n    var expanding = {};\n    function copyValue(val) {\n        var copy = [];\n        for (var i = 0; i < val.length; i++) {\n            var p = val[i];\n            if (typeof p == \"object\") {\n                if (expanding[p.tabstopId])\n                    continue;\n                var j = val.lastIndexOf(p, i - 1);\n                p = copy[j] || { tabstopId: p.tabstopId };\n            }\n            copy[i] = p;\n        }\n        return copy;\n    }\n    for (var i = 0; i < tokens.length; i++) {\n        var p = tokens[i];\n        if (typeof p != \"object\")\n            continue;\n        var id = p.tabstopId;\n        var ts = tabstops[id];\n        var i1 = tokens.indexOf(p, i + 1);\n        if (expanding[id]) {\n            if (expanding[id] === p) {\n                delete expanding[id];\n                Object.keys(expanding).forEach(function (parentId) {\n                    ts.parents[parentId] = true;\n                });\n            }\n            continue;\n        }\n        expanding[id] = p;\n        var value = ts.value;\n        if (typeof value !== \"string\")\n            value = copyValue(value);\n        else if (p.fmt)\n            value = this.tmStrFormat(value, p, editor);\n        tokens.splice.apply(tokens, [i + 1, Math.max(0, i1 - i)].concat(value, p));\n        if (ts.indexOf(p) === -1)\n            ts.push(p);\n    }\n    var row = 0, column = 0;\n    var text = \"\";\n    tokens.forEach(function (t) {\n        if (typeof t === \"string\") {\n            var lines = t.split(\"\\n\");\n            if (lines.length > 1) {\n                column = lines[lines.length - 1].length;\n                row += lines.length - 1;\n            }\n            else\n                column += t.length;\n            text += t;\n        }\n        else if (t) {\n            if (!t.start)\n                t.start = { row: row, column: column };\n            else\n                t.end = { row: row, column: column };\n        }\n    });\n    return {\n        text: text,\n        tabstops: tabstops,\n        tokens: tokens\n    };\n};\nvar TabstopManager = /** @class */ (function () {\n    function TabstopManager(editor) {\n        this.index = 0;\n        this.ranges = [];\n        this.tabstops = [];\n        if (editor.tabstopManager)\n            return editor.tabstopManager;\n        editor.tabstopManager = this;\n        this.$onChange = this.onChange.bind(this);\n        this.$onChangeSelection = lang.delayedCall(this.onChangeSelection.bind(this)).schedule;\n        this.$onChangeSession = this.onChangeSession.bind(this);\n        this.$onAfterExec = this.onAfterExec.bind(this);\n        this.attach(editor);\n    }\n    TabstopManager.prototype.attach = function (editor) {\n        this.$openTabstops = null;\n        this.selectedTabstop = null;\n        this.editor = editor;\n        this.session = editor.session;\n        this.editor.on(\"change\", this.$onChange);\n        this.editor.on(\"changeSelection\", this.$onChangeSelection);\n        this.editor.on(\"changeSession\", this.$onChangeSession);\n        this.editor.commands.on(\"afterExec\", this.$onAfterExec);\n        this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n    };\n    TabstopManager.prototype.detach = function () {\n        this.tabstops.forEach(this.removeTabstopMarkers, this);\n        this.ranges.length = 0;\n        this.tabstops.length = 0;\n        this.selectedTabstop = null;\n        this.editor.off(\"change\", this.$onChange);\n        this.editor.off(\"changeSelection\", this.$onChangeSelection);\n        this.editor.off(\"changeSession\", this.$onChangeSession);\n        this.editor.commands.off(\"afterExec\", this.$onAfterExec);\n        this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n        this.editor.tabstopManager = null;\n        this.session = null;\n        this.editor = null;\n    };\n    TabstopManager.prototype.onChange = function (delta) {\n        var isRemove = delta.action[0] == \"r\";\n        var selectedTabstop = this.selectedTabstop || {};\n        var parents = selectedTabstop.parents || {};\n        var tabstops = this.tabstops.slice();\n        for (var i = 0; i < tabstops.length; i++) {\n            var ts = tabstops[i];\n            var active = ts == selectedTabstop || parents[ts.index];\n            ts.rangeList.$bias = active ? 0 : 1;\n            if (delta.action == \"remove\" && ts !== selectedTabstop) {\n                var parentActive = ts.parents && ts.parents[selectedTabstop.index];\n                var startIndex = ts.rangeList.pointIndex(delta.start, parentActive);\n                startIndex = startIndex < 0 ? -startIndex - 1 : startIndex + 1;\n                var endIndex = ts.rangeList.pointIndex(delta.end, parentActive);\n                endIndex = endIndex < 0 ? -endIndex - 1 : endIndex - 1;\n                var toRemove = ts.rangeList.ranges.slice(startIndex, endIndex);\n                for (var j = 0; j < toRemove.length; j++)\n                    this.removeRange(toRemove[j]);\n            }\n            ts.rangeList.$onChange(delta);\n        }\n        var session = this.session;\n        if (!this.$inChange && isRemove && session.getLength() == 1 && !session.getValue())\n            this.detach();\n    };\n    TabstopManager.prototype.updateLinkedFields = function () {\n        var ts = this.selectedTabstop;\n        if (!ts || !ts.hasLinkedRanges || !ts.firstNonLinked)\n            return;\n        this.$inChange = true;\n        var session = this.session;\n        var text = session.getTextRange(ts.firstNonLinked);\n        for (var i = 0; i < ts.length; i++) {\n            var range = ts[i];\n            if (!range.linked)\n                continue;\n            var original = range.original;\n            var fmt = exports.snippetManager.tmStrFormat(text, original, this.editor);\n            session.replace(range, fmt);\n        }\n        this.$inChange = false;\n    };\n    TabstopManager.prototype.onAfterExec = function (e) {\n        if (e.command && !e.command.readOnly)\n            this.updateLinkedFields();\n    };\n    TabstopManager.prototype.onChangeSelection = function () {\n        if (!this.editor)\n            return;\n        var lead = this.editor.selection.lead;\n        var anchor = this.editor.selection.anchor;\n        var isEmpty = this.editor.selection.isEmpty();\n        for (var i = 0; i < this.ranges.length; i++) {\n            if (this.ranges[i].linked)\n                continue;\n            var containsLead = this.ranges[i].contains(lead.row, lead.column);\n            var containsAnchor = isEmpty || this.ranges[i].contains(anchor.row, anchor.column);\n            if (containsLead && containsAnchor)\n                return;\n        }\n        this.detach();\n    };\n    TabstopManager.prototype.onChangeSession = function () {\n        this.detach();\n    };\n    TabstopManager.prototype.tabNext = function (dir) {\n        var max = this.tabstops.length;\n        var index = this.index + (dir || 1);\n        index = Math.min(Math.max(index, 1), max);\n        if (index == max)\n            index = 0;\n        this.selectTabstop(index);\n        this.updateTabstopMarkers();\n        if (index === 0) {\n            this.detach();\n        }\n    };\n    TabstopManager.prototype.selectTabstop = function (index) {\n        this.$openTabstops = null;\n        var ts = this.tabstops[this.index];\n        if (ts)\n            this.addTabstopMarkers(ts);\n        this.index = index;\n        ts = this.tabstops[this.index];\n        if (!ts || !ts.length)\n            return;\n        this.selectedTabstop = ts;\n        var range = ts.firstNonLinked || ts;\n        if (ts.choices)\n            range.cursor = range.start;\n        if (!this.editor.inVirtualSelectionMode) {\n            var sel = this.editor.multiSelect;\n            sel.toSingleRange(range);\n            for (var i = 0; i < ts.length; i++) {\n                if (ts.hasLinkedRanges && ts[i].linked)\n                    continue;\n                sel.addRange(ts[i].clone(), true);\n            }\n        }\n        else {\n            this.editor.selection.fromOrientedRange(range);\n        }\n        this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n        if (this.selectedTabstop && this.selectedTabstop.choices)\n            this.editor.execCommand(\"startAutocomplete\", { matches: this.selectedTabstop.choices });\n    };\n    TabstopManager.prototype.addTabstops = function (tabstops, start, end) {\n        var useLink = this.useLink || !this.editor.getOption(\"enableMultiselect\");\n        if (!this.$openTabstops)\n            this.$openTabstops = [];\n        if (!tabstops[0]) {\n            var p = Range.fromPoints(end, end);\n            moveRelative(p.start, start);\n            moveRelative(p.end, start);\n            tabstops[0] = [p];\n            tabstops[0].index = 0;\n        }\n        var i = this.index;\n        var arg = [i + 1, 0];\n        var ranges = this.ranges;\n        var snippetId = this.snippetId = (this.snippetId || 0) + 1;\n        tabstops.forEach(function (ts, index) {\n            var dest = this.$openTabstops[index] || ts;\n            dest.snippetId = snippetId;\n            for (var i = 0; i < ts.length; i++) {\n                var p = ts[i];\n                var range = Range.fromPoints(p.start, p.end || p.start);\n                movePoint(range.start, start);\n                movePoint(range.end, start);\n                range.original = p;\n                range.tabstop = dest;\n                ranges.push(range);\n                if (dest != ts)\n                    dest.unshift(range);\n                else\n                    dest[i] = range;\n                if (p.fmtString || (dest.firstNonLinked && useLink)) {\n                    range.linked = true;\n                    dest.hasLinkedRanges = true;\n                }\n                else if (!dest.firstNonLinked)\n                    dest.firstNonLinked = range;\n            }\n            if (!dest.firstNonLinked)\n                dest.hasLinkedRanges = false;\n            if (dest === ts) {\n                arg.push(dest);\n                this.$openTabstops[index] = dest;\n            }\n            this.addTabstopMarkers(dest);\n            dest.rangeList = dest.rangeList || new RangeList();\n            dest.rangeList.$bias = 0;\n            dest.rangeList.addList(dest);\n        }, this);\n        if (arg.length > 2) {\n            if (this.tabstops.length)\n                arg.push(arg.splice(2, 1)[0]);\n            this.tabstops.splice.apply(this.tabstops, arg);\n        }\n    };\n    TabstopManager.prototype.addTabstopMarkers = function (ts) {\n        var session = this.session;\n        ts.forEach(function (range) {\n            if (!range.markerId)\n                range.markerId = session.addMarker(range, \"ace_snippet-marker\", \"text\");\n        });\n    };\n    TabstopManager.prototype.removeTabstopMarkers = function (ts) {\n        var session = this.session;\n        ts.forEach(function (range) {\n            session.removeMarker(range.markerId);\n            range.markerId = null;\n        });\n    };\n    TabstopManager.prototype.updateTabstopMarkers = function () {\n        if (!this.selectedTabstop)\n            return;\n        var currentSnippetId = this.selectedTabstop.snippetId;\n        if (this.selectedTabstop.index === 0) {\n            currentSnippetId--;\n        }\n        this.tabstops.forEach(function (ts) {\n            if (ts.snippetId === currentSnippetId)\n                this.addTabstopMarkers(ts);\n            else\n                this.removeTabstopMarkers(ts);\n        }, this);\n    };\n    TabstopManager.prototype.removeRange = function (range) {\n        var i = range.tabstop.indexOf(range);\n        if (i != -1)\n            range.tabstop.splice(i, 1);\n        i = this.ranges.indexOf(range);\n        if (i != -1)\n            this.ranges.splice(i, 1);\n        i = range.tabstop.rangeList.ranges.indexOf(range);\n        if (i != -1)\n            range.tabstop.splice(i, 1);\n        this.session.removeMarker(range.markerId);\n        if (!range.tabstop.length) {\n            i = this.tabstops.indexOf(range.tabstop);\n            if (i != -1)\n                this.tabstops.splice(i, 1);\n            if (!this.tabstops.length)\n                this.detach();\n        }\n    };\n    return TabstopManager;\n}());\nTabstopManager.prototype.keyboardHandler = new HashHandler();\nTabstopManager.prototype.keyboardHandler.bindKeys({\n    \"Tab\": function (editor) {\n        if (exports.snippetManager && exports.snippetManager.expandWithTab(editor))\n            return;\n        editor.tabstopManager.tabNext(1);\n        editor.renderer.scrollCursorIntoView();\n    },\n    \"Shift-Tab\": function (editor) {\n        editor.tabstopManager.tabNext(-1);\n        editor.renderer.scrollCursorIntoView();\n    },\n    \"Esc\": function (editor) {\n        editor.tabstopManager.detach();\n    }\n});\nvar movePoint = function (point, diff) {\n    if (point.row == 0)\n        point.column += diff.column;\n    point.row += diff.row;\n};\nvar moveRelative = function (point, start) {\n    if (point.row == start.row)\n        point.column -= start.column;\n    point.row -= start.row;\n};\ndom.importCssString(\"\\n.ace_snippet-marker {\\n    -moz-box-sizing: border-box;\\n    box-sizing: border-box;\\n    background: rgba(194, 193, 208, 0.09);\\n    border: 1px dotted rgba(211, 208, 235, 0.62);\\n    position: absolute;\\n}\", \"snippets.css\", false);\nexports.snippetManager = new SnippetManager();\nvar Editor = require(\"./editor\").Editor;\n(function () {\n    this.insertSnippet = function (content, options) {\n        return exports.snippetManager.insertSnippet(this, content, options);\n    };\n    this.expandSnippet = function (options) {\n        return exports.snippetManager.expandWithTab(this, options);\n    };\n}).call(Editor.prototype);\n\n});\n\nace.define(\"ace/autocomplete/popup\",[\"require\",\"exports\",\"module\",\"ace/virtual_renderer\",\"ace/editor\",\"ace/range\",\"ace/lib/event\",\"ace/lib/lang\",\"ace/lib/dom\",\"ace/config\",\"ace/lib/useragent\"], function(require, exports, module){\"use strict\";\nvar Renderer = require(\"../virtual_renderer\").VirtualRenderer;\nvar Editor = require(\"../editor\").Editor;\nvar Range = require(\"../range\").Range;\nvar event = require(\"../lib/event\");\nvar lang = require(\"../lib/lang\");\nvar dom = require(\"../lib/dom\");\nvar nls = require(\"../config\").nls;\nvar userAgent = require(\"./../lib/useragent\");\nvar getAriaId = function (index) {\n    return \"suggest-aria-id:\".concat(index);\n};\nvar popupAriaRole = userAgent.isSafari ? \"menu\" : \"listbox\";\nvar optionAriaRole = userAgent.isSafari ? \"menuitem\" : \"option\";\nvar ariaActiveState = userAgent.isSafari ? \"aria-current\" : \"aria-selected\";\nvar $singleLineEditor = function (el) {\n    var renderer = new Renderer(el);\n    renderer.$maxLines = 4;\n    var editor = new Editor(renderer);\n    editor.setHighlightActiveLine(false);\n    editor.setShowPrintMargin(false);\n    editor.renderer.setShowGutter(false);\n    editor.renderer.setHighlightGutterLine(false);\n    editor.$mouseHandler.$focusTimeout = 0;\n    editor.$highlightTagPending = true;\n    return editor;\n};\nvar AcePopup = /** @class */ (function () {\n    function AcePopup(parentNode) {\n        var el = dom.createElement(\"div\");\n        var popup = $singleLineEditor(el);\n        if (parentNode) {\n            parentNode.appendChild(el);\n        }\n        el.style.display = \"none\";\n        popup.renderer.content.style.cursor = \"default\";\n        popup.renderer.setStyle(\"ace_autocomplete\");\n        popup.renderer.$textLayer.element.setAttribute(\"role\", popupAriaRole);\n        popup.renderer.$textLayer.element.setAttribute(\"aria-roledescription\", nls(\"Autocomplete suggestions\"));\n        popup.renderer.$textLayer.element.setAttribute(\"aria-label\", nls(\"Autocomplete suggestions\"));\n        popup.renderer.textarea.setAttribute(\"aria-hidden\", \"true\");\n        popup.setOption(\"displayIndentGuides\", false);\n        popup.setOption(\"dragDelay\", 150);\n        var noop = function () { };\n        popup.focus = noop;\n        popup.$isFocused = true;\n        popup.renderer.$cursorLayer.restartTimer = noop;\n        popup.renderer.$cursorLayer.element.style.opacity = \"0\";\n        popup.renderer.$maxLines = 8;\n        popup.renderer.$keepTextAreaAtCursor = false;\n        popup.setHighlightActiveLine(false);\n        popup.session.highlight(\"\");\n        popup.session.$searchHighlight.clazz = \"ace_highlight-marker\";\n        popup.on(\"mousedown\", function (e) {\n            var pos = e.getDocumentPosition();\n            popup.selection.moveToPosition(pos);\n            selectionMarker.start.row = selectionMarker.end.row = pos.row;\n            e.stop();\n        });\n        var lastMouseEvent;\n        var hoverMarker = new Range(-1, 0, -1, Infinity);\n        var selectionMarker = new Range(-1, 0, -1, Infinity);\n        selectionMarker.id = popup.session.addMarker(selectionMarker, \"ace_active-line\", \"fullLine\");\n        popup.setSelectOnHover = function (val) {\n            if (!val) {\n                hoverMarker.id = popup.session.addMarker(hoverMarker, \"ace_line-hover\", \"fullLine\");\n            }\n            else if (hoverMarker.id) {\n                popup.session.removeMarker(hoverMarker.id);\n                hoverMarker.id = null;\n            }\n        };\n        popup.setSelectOnHover(false);\n        popup.on(\"mousemove\", function (e) {\n            if (!lastMouseEvent) {\n                lastMouseEvent = e;\n                return;\n            }\n            if (lastMouseEvent.x == e.x && lastMouseEvent.y == e.y) {\n                return;\n            }\n            lastMouseEvent = e;\n            lastMouseEvent.scrollTop = popup.renderer.scrollTop;\n            popup.isMouseOver = true;\n            var row = lastMouseEvent.getDocumentPosition().row;\n            if (hoverMarker.start.row != row) {\n                if (!hoverMarker.id)\n                    popup.setRow(row);\n                setHoverMarker(row);\n            }\n        });\n        popup.renderer.on(\"beforeRender\", function () {\n            if (lastMouseEvent && hoverMarker.start.row != -1) {\n                lastMouseEvent.$pos = null;\n                var row = lastMouseEvent.getDocumentPosition().row;\n                if (!hoverMarker.id)\n                    popup.setRow(row);\n                setHoverMarker(row, true);\n            }\n        });\n        popup.renderer.on(\"afterRender\", function () {\n            var row = popup.getRow();\n            var t = popup.renderer.$textLayer;\n            var selected = /** @type {HTMLElement|null} */ (t.element.childNodes[row - t.config.firstRow]);\n            var el = document.activeElement; // Active element is textarea of main editor\n            if (selected !== popup.selectedNode && popup.selectedNode) {\n                dom.removeCssClass(popup.selectedNode, \"ace_selected\");\n                el.removeAttribute(\"aria-activedescendant\");\n                popup.selectedNode.removeAttribute(ariaActiveState);\n                popup.selectedNode.removeAttribute(\"id\");\n            }\n            popup.selectedNode = selected;\n            if (selected) {\n                dom.addCssClass(selected, \"ace_selected\");\n                var ariaId = getAriaId(row);\n                selected.id = ariaId;\n                t.element.setAttribute(\"aria-activedescendant\", ariaId);\n                el.setAttribute(\"aria-activedescendant\", ariaId);\n                selected.setAttribute(\"role\", optionAriaRole);\n                selected.setAttribute(\"aria-roledescription\", nls(\"item\"));\n                selected.setAttribute(\"aria-label\", popup.getData(row).caption || popup.getData(row).value);\n                selected.setAttribute(\"aria-setsize\", popup.data.length);\n                selected.setAttribute(\"aria-posinset\", row + 1);\n                selected.setAttribute(\"aria-describedby\", \"doc-tooltip\");\n                selected.setAttribute(ariaActiveState, \"true\");\n            }\n        });\n        var hideHoverMarker = function () { setHoverMarker(-1); };\n        var setHoverMarker = function (row, suppressRedraw) {\n            if (row !== hoverMarker.start.row) {\n                hoverMarker.start.row = hoverMarker.end.row = row;\n                if (!suppressRedraw)\n                    popup.session._emit(\"changeBackMarker\");\n                popup._emit(\"changeHoverMarker\");\n            }\n        };\n        popup.getHoveredRow = function () {\n            return hoverMarker.start.row;\n        };\n        event.addListener(popup.container, \"mouseout\", function () {\n            popup.isMouseOver = false;\n            hideHoverMarker();\n        });\n        popup.on(\"hide\", hideHoverMarker);\n        popup.on(\"changeSelection\", hideHoverMarker);\n        popup.session.doc.getLength = function () {\n            return popup.data.length;\n        };\n        popup.session.doc.getLine = function (i) {\n            var data = popup.data[i];\n            if (typeof data == \"string\")\n                return data;\n            return (data && data.value) || \"\";\n        };\n        var bgTokenizer = popup.session.bgTokenizer;\n        bgTokenizer.$tokenizeRow = function (row) {\n            var data = popup.data[row];\n            var tokens = [];\n            if (!data)\n                return tokens;\n            if (typeof data == \"string\")\n                data = { value: data };\n            var caption = data.caption || data.value || data.name;\n            function addToken(value, className) {\n                value && tokens.push({\n                    type: (data.className || \"\") + (className || \"\"),\n                    value: value\n                });\n            }\n            var lower = caption.toLowerCase();\n            var filterText = (popup.filterText || \"\").toLowerCase();\n            var lastIndex = 0;\n            var lastI = 0;\n            for (var i = 0; i <= filterText.length; i++) {\n                if (i != lastI && (data.matchMask & (1 << i) || i == filterText.length)) {\n                    var sub = filterText.slice(lastI, i);\n                    lastI = i;\n                    var index = lower.indexOf(sub, lastIndex);\n                    if (index == -1)\n                        continue;\n                    addToken(caption.slice(lastIndex, index), \"\");\n                    lastIndex = index + sub.length;\n                    addToken(caption.slice(index, lastIndex), \"completion-highlight\");\n                }\n            }\n            addToken(caption.slice(lastIndex, caption.length), \"\");\n            tokens.push({ type: \"completion-spacer\", value: \" \" });\n            if (data.meta)\n                tokens.push({ type: \"completion-meta\", value: data.meta });\n            if (data.message)\n                tokens.push({ type: \"completion-message\", value: data.message });\n            return tokens;\n        };\n        bgTokenizer.$updateOnChange = noop;\n        bgTokenizer.start = noop;\n        popup.session.$computeWidth = function () {\n            return this.screenWidth = 0;\n        };\n        popup.isOpen = false;\n        popup.isTopdown = false;\n        popup.autoSelect = true;\n        popup.filterText = \"\";\n        popup.isMouseOver = false;\n        popup.data = [];\n        popup.setData = function (list, filterText) {\n            popup.filterText = filterText || \"\";\n            popup.setValue(lang.stringRepeat(\"\\n\", list.length), -1);\n            popup.data = list || [];\n            popup.setRow(0);\n        };\n        popup.getData = function (row) {\n            return popup.data[row];\n        };\n        popup.getRow = function () {\n            return selectionMarker.start.row;\n        };\n        popup.setRow = function (line) {\n            line = Math.max(this.autoSelect ? 0 : -1, Math.min(this.data.length - 1, line));\n            if (selectionMarker.start.row != line) {\n                popup.selection.clearSelection();\n                selectionMarker.start.row = selectionMarker.end.row = line || 0;\n                popup.session._emit(\"changeBackMarker\");\n                popup.moveCursorTo(line || 0, 0);\n                if (popup.isOpen)\n                    popup._signal(\"select\");\n            }\n        };\n        popup.on(\"changeSelection\", function () {\n            if (popup.isOpen)\n                popup.setRow(popup.selection.lead.row);\n            popup.renderer.scrollCursorIntoView();\n        });\n        popup.hide = function () {\n            this.container.style.display = \"none\";\n            popup.anchorPos = null;\n            popup.anchor = null;\n            if (popup.isOpen) {\n                popup.isOpen = false;\n                this._signal(\"hide\");\n            }\n        };\n        popup.tryShow = function (pos, lineHeight, anchor, forceShow) {\n            if (!forceShow && popup.isOpen && popup.anchorPos && popup.anchor &&\n                popup.anchorPos.top === pos.top && popup.anchorPos.left === pos.left &&\n                popup.anchor === anchor) {\n                return true;\n            }\n            var el = this.container;\n            var screenHeight = window.innerHeight;\n            var screenWidth = window.innerWidth;\n            var renderer = this.renderer;\n            var maxH = renderer.$maxLines * lineHeight * 1.4;\n            var dims = { top: 0, bottom: 0, left: 0 };\n            var spaceBelow = screenHeight - pos.top - 3 * this.$borderSize - lineHeight;\n            var spaceAbove = pos.top - 3 * this.$borderSize;\n            if (!anchor) {\n                if (spaceAbove <= spaceBelow || spaceBelow >= maxH) {\n                    anchor = \"bottom\";\n                }\n                else {\n                    anchor = \"top\";\n                }\n            }\n            if (anchor === \"top\") {\n                dims.bottom = pos.top - this.$borderSize;\n                dims.top = dims.bottom - maxH;\n            }\n            else if (anchor === \"bottom\") {\n                dims.top = pos.top + lineHeight + this.$borderSize;\n                dims.bottom = dims.top + maxH;\n            }\n            var fitsX = dims.top >= 0 && dims.bottom <= screenHeight;\n            if (!forceShow && !fitsX) {\n                return false;\n            }\n            if (!fitsX) {\n                if (anchor === \"top\") {\n                    renderer.$maxPixelHeight = spaceAbove;\n                }\n                else {\n                    renderer.$maxPixelHeight = spaceBelow;\n                }\n            }\n            else {\n                renderer.$maxPixelHeight = null;\n            }\n            if (anchor === \"top\") {\n                el.style.top = \"\";\n                el.style.bottom = (screenHeight - dims.bottom) + \"px\";\n                popup.isTopdown = false;\n            }\n            else {\n                el.style.top = dims.top + \"px\";\n                el.style.bottom = \"\";\n                popup.isTopdown = true;\n            }\n            el.style.display = \"\";\n            var left = pos.left;\n            if (left + el.offsetWidth > screenWidth)\n                left = screenWidth - el.offsetWidth;\n            el.style.left = left + \"px\";\n            el.style.right = \"\";\n            if (!popup.isOpen) {\n                popup.isOpen = true;\n                this._signal(\"show\");\n                lastMouseEvent = null;\n            }\n            popup.anchorPos = pos;\n            popup.anchor = anchor;\n            return true;\n        };\n        popup.show = function (pos, lineHeight, topdownOnly) {\n            this.tryShow(pos, lineHeight, topdownOnly ? \"bottom\" : undefined, true);\n        };\n        popup.goTo = function (where) {\n            var row = this.getRow();\n            var max = this.session.getLength() - 1;\n            switch (where) {\n                case \"up\":\n                    row = row <= 0 ? max : row - 1;\n                    break;\n                case \"down\":\n                    row = row >= max ? -1 : row + 1;\n                    break;\n                case \"start\":\n                    row = 0;\n                    break;\n                case \"end\":\n                    row = max;\n                    break;\n            }\n            this.setRow(row);\n        };\n        popup.getTextLeftOffset = function () {\n            return this.$borderSize + this.renderer.$padding + this.$imageSize;\n        };\n        popup.$imageSize = 0;\n        popup.$borderSize = 1;\n        return popup;\n    }\n    return AcePopup;\n}());\ndom.importCssString(\"\\n.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\n    background-color: #CAD6FA;\\n    z-index: 1;\\n}\\n.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\n    background-color: #3a674e;\\n}\\n.ace_editor.ace_autocomplete .ace_line-hover {\\n    border: 1px solid #abbffe;\\n    margin-top: -1px;\\n    background: rgba(233,233,253,0.4);\\n    position: absolute;\\n    z-index: 2;\\n}\\n.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {\\n    border: 1px solid rgba(109, 150, 13, 0.8);\\n    background: rgba(58, 103, 78, 0.62);\\n}\\n.ace_completion-meta {\\n    opacity: 0.5;\\n    margin-left: 0.9em;\\n}\\n.ace_completion-message {\\n    margin-left: 0.9em;\\n    color: blue;\\n}\\n.ace_editor.ace_autocomplete .ace_completion-highlight{\\n    color: #2d69c7;\\n}\\n.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{\\n    color: #93ca12;\\n}\\n.ace_editor.ace_autocomplete {\\n    width: 300px;\\n    z-index: 200000;\\n    border: 1px lightgray solid;\\n    position: fixed;\\n    box-shadow: 2px 3px 5px rgba(0,0,0,.2);\\n    line-height: 1.4;\\n    background: #fefefe;\\n    color: #111;\\n}\\n.ace_dark.ace_editor.ace_autocomplete {\\n    border: 1px #484747 solid;\\n    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);\\n    line-height: 1.4;\\n    background: #25282c;\\n    color: #c1c1c1;\\n}\\n.ace_autocomplete .ace_text-layer  {\\n    width: calc(100% - 8px);\\n}\\n.ace_autocomplete .ace_line {\\n    display: flex;\\n    align-items: center;\\n}\\n.ace_autocomplete .ace_line > * {\\n    min-width: 0;\\n    flex: 0 0 auto;\\n}\\n.ace_autocomplete .ace_line .ace_ {\\n    flex: 0 1 auto;\\n    overflow: hidden;\\n    white-space: nowrap;\\n    text-overflow: ellipsis;\\n}\\n.ace_autocomplete .ace_completion-spacer {\\n    flex: 1;\\n}\\n.ace_autocomplete.ace_loading:after  {\\n    content: \\\"\\\";\\n    position: absolute;\\n    top: 0px;\\n    height: 2px;\\n    width: 8%;\\n    background: blue;\\n    z-index: 100;\\n    animation: ace_progress 3s infinite linear;\\n    animation-delay: 300ms;\\n    transform: translateX(-100%) scaleX(1);\\n}\\n@keyframes ace_progress {\\n    0% { transform: translateX(-100%) scaleX(1) }\\n    50% { transform: translateX(625%) scaleX(2) } \\n    100% { transform: translateX(1500%) scaleX(3) } \\n}\\n@media (prefers-reduced-motion) {\\n    .ace_autocomplete.ace_loading:after {\\n        transform: translateX(625%) scaleX(2);\\n        animation: none;\\n     }\\n}\\n\", \"autocompletion.css\", false);\nexports.AcePopup = AcePopup;\nexports.$singleLineEditor = $singleLineEditor;\nexports.getAriaId = getAriaId;\n\n});\n\nace.define(\"ace/autocomplete/inline_screenreader\",[\"require\",\"exports\",\"module\"], function(require, exports, module){\"use strict\";\nvar AceInlineScreenReader = /** @class */ (function () {\n    function AceInlineScreenReader(editor) {\n        this.editor = editor;\n        this.screenReaderDiv = document.createElement(\"div\");\n        this.screenReaderDiv.classList.add(\"ace_screenreader-only\");\n        this.editor.container.appendChild(this.screenReaderDiv);\n    }\n    AceInlineScreenReader.prototype.setScreenReaderContent = function (content) {\n        if (!this.popup && this.editor.completer && /**@type{import(\"../autocomplete\").Autocomplete}*/ (this.editor.completer).popup) {\n            this.popup = /**@type{import(\"../autocomplete\").Autocomplete}*/ (this.editor.completer).popup;\n            this.popup.renderer.on(\"afterRender\", function () {\n                var row = this.popup.getRow();\n                var t = this.popup.renderer.$textLayer;\n                var selected = t.element.childNodes[row - t.config.firstRow];\n                if (selected) {\n                    var idString = \"doc-tooltip \";\n                    for (var lineIndex = 0; lineIndex < this._lines.length; lineIndex++) {\n                        idString += \"ace-inline-screenreader-line-\".concat(lineIndex, \" \");\n                    }\n                    selected.setAttribute(\"aria-describedby\", idString);\n                }\n            }.bind(this));\n        }\n        while (this.screenReaderDiv.firstChild) {\n            this.screenReaderDiv.removeChild(this.screenReaderDiv.firstChild);\n        }\n        this._lines = content.split(/\\r\\n|\\r|\\n/);\n        var codeElement = this.createCodeBlock();\n        this.screenReaderDiv.appendChild(codeElement);\n    };\n    AceInlineScreenReader.prototype.destroy = function () {\n        this.screenReaderDiv.remove();\n    };\n    AceInlineScreenReader.prototype.createCodeBlock = function () {\n        var container = document.createElement(\"pre\");\n        container.setAttribute(\"id\", \"ace-inline-screenreader\");\n        for (var lineIndex = 0; lineIndex < this._lines.length; lineIndex++) {\n            var codeElement = document.createElement(\"code\");\n            codeElement.setAttribute(\"id\", \"ace-inline-screenreader-line-\".concat(lineIndex));\n            var line = document.createTextNode(this._lines[lineIndex]);\n            codeElement.appendChild(line);\n            container.appendChild(codeElement);\n        }\n        return container;\n    };\n    return AceInlineScreenReader;\n}());\nexports.AceInlineScreenReader = AceInlineScreenReader;\n\n});\n\nace.define(\"ace/autocomplete/inline\",[\"require\",\"exports\",\"module\",\"ace/snippets\",\"ace/autocomplete/inline_screenreader\"], function(require, exports, module){\"use strict\";\nvar snippetManager = require(\"../snippets\").snippetManager;\nvar AceInlineScreenReader = require(\"./inline_screenreader\").AceInlineScreenReader;\nvar AceInline = /** @class */ (function () {\n    function AceInline() {\n        this.editor = null;\n    }\n    AceInline.prototype.show = function (editor, completion, prefix) {\n        prefix = prefix || \"\";\n        if (editor && this.editor && this.editor !== editor) {\n            this.hide();\n            this.editor = null;\n            this.inlineScreenReader = null;\n        }\n        if (!editor || !completion) {\n            return false;\n        }\n        if (!this.inlineScreenReader) {\n            this.inlineScreenReader = new AceInlineScreenReader(editor);\n        }\n        var displayText = completion.snippet ? snippetManager.getDisplayTextForSnippet(editor, completion.snippet) : completion.value;\n        if (completion.hideInlinePreview || !displayText || !displayText.startsWith(prefix)) {\n            return false;\n        }\n        this.editor = editor;\n        this.inlineScreenReader.setScreenReaderContent(displayText);\n        displayText = displayText.slice(prefix.length);\n        if (displayText === \"\") {\n            editor.removeGhostText();\n        }\n        else {\n            editor.setGhostText(displayText);\n        }\n        return true;\n    };\n    AceInline.prototype.isOpen = function () {\n        if (!this.editor) {\n            return false;\n        }\n        return !!this.editor.renderer.$ghostText;\n    };\n    AceInline.prototype.hide = function () {\n        if (!this.editor) {\n            return false;\n        }\n        this.editor.removeGhostText();\n        return true;\n    };\n    AceInline.prototype.destroy = function () {\n        this.hide();\n        this.editor = null;\n        if (this.inlineScreenReader) {\n            this.inlineScreenReader.destroy();\n            this.inlineScreenReader = null;\n        }\n    };\n    return AceInline;\n}());\nexports.AceInline = AceInline;\n\n});\n\nace.define(\"ace/autocomplete/util\",[\"require\",\"exports\",\"module\"], function(require, exports, module){\"use strict\";\nexports.parForEach = function (array, fn, callback) {\n    var completed = 0;\n    var arLength = array.length;\n    if (arLength === 0)\n        callback();\n    for (var i = 0; i < arLength; i++) {\n        fn(array[i], function (result, err) {\n            completed++;\n            if (completed === arLength)\n                callback(result, err);\n        });\n    }\n};\nvar ID_REGEX = /[a-zA-Z_0-9\\$\\-\\u00A2-\\u2000\\u2070-\\uFFFF]/;\nexports.retrievePrecedingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n    for (var i = pos - 1; i >= 0; i--) {\n        if (regex.test(text[i]))\n            buf.push(text[i]);\n        else\n            break;\n    }\n    return buf.reverse().join(\"\");\n};\nexports.retrieveFollowingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n    for (var i = pos; i < text.length; i++) {\n        if (regex.test(text[i]))\n            buf.push(text[i]);\n        else\n            break;\n    }\n    return buf;\n};\nexports.getCompletionPrefix = function (editor) {\n    var pos = editor.getCursorPosition();\n    var line = editor.session.getLine(pos.row);\n    var prefix;\n    editor.completers.forEach(function (completer) {\n        if (completer.identifierRegexps) {\n            completer.identifierRegexps.forEach(function (identifierRegex) {\n                if (!prefix && identifierRegex)\n                    prefix = this.retrievePrecedingIdentifier(line, pos.column, identifierRegex);\n            }.bind(this));\n        }\n    }.bind(this));\n    return prefix || this.retrievePrecedingIdentifier(line, pos.column);\n};\nexports.triggerAutocomplete = function (editor, previousChar) {\n    var previousChar = previousChar == null\n        ? editor.session.getPrecedingCharacter()\n        : previousChar;\n    return editor.completers.some(function (completer) {\n        if (completer.triggerCharacters && Array.isArray(completer.triggerCharacters)) {\n            return completer.triggerCharacters.includes(previousChar);\n        }\n    });\n};\n\n});\n\nace.define(\"ace/autocomplete\",[\"require\",\"exports\",\"module\",\"ace/keyboard/hash_handler\",\"ace/autocomplete/popup\",\"ace/autocomplete/inline\",\"ace/autocomplete/popup\",\"ace/autocomplete/util\",\"ace/lib/lang\",\"ace/lib/dom\",\"ace/snippets\",\"ace/config\",\"ace/lib/event\",\"ace/lib/scroll\"], function(require, exports, module){\"use strict\";\nvar HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\nvar AcePopup = require(\"./autocomplete/popup\").AcePopup;\nvar AceInline = require(\"./autocomplete/inline\").AceInline;\nvar getAriaId = require(\"./autocomplete/popup\").getAriaId;\nvar util = require(\"./autocomplete/util\");\nvar lang = require(\"./lib/lang\");\nvar dom = require(\"./lib/dom\");\nvar snippetManager = require(\"./snippets\").snippetManager;\nvar config = require(\"./config\");\nvar event = require(\"./lib/event\");\nvar preventParentScroll = require(\"./lib/scroll\").preventParentScroll;\nvar destroyCompleter = function (e, editor) {\n    editor.completer && editor.completer.destroy();\n};\nvar Autocomplete = /** @class */ (function () {\n    function Autocomplete() {\n        this.autoInsert = false;\n        this.autoSelect = true;\n        this.autoShown = false;\n        this.exactMatch = false;\n        this.inlineEnabled = false;\n        this.keyboardHandler = new HashHandler();\n        this.keyboardHandler.bindKeys(this.commands);\n        this.parentNode = null;\n        this.setSelectOnHover = false;\n        this.hasSeen = new Set();\n        this.showLoadingState = false;\n        this.stickySelectionDelay = 500;\n        this.blurListener = this.blurListener.bind(this);\n        this.changeListener = this.changeListener.bind(this);\n        this.mousedownListener = this.mousedownListener.bind(this);\n        this.mousewheelListener = this.mousewheelListener.bind(this);\n        this.onLayoutChange = this.onLayoutChange.bind(this);\n        this.changeTimer = lang.delayedCall(function () {\n            this.updateCompletions(true);\n        }.bind(this));\n        this.tooltipTimer = lang.delayedCall(this.updateDocTooltip.bind(this), 50);\n        this.popupTimer = lang.delayedCall(this.$updatePopupPosition.bind(this), 50);\n        this.stickySelectionTimer = lang.delayedCall(function () {\n            this.stickySelection = true;\n        }.bind(this), this.stickySelectionDelay);\n        this.$firstOpenTimer = lang.delayedCall(/**@this{Autocomplete}*/ function () {\n            var initialPosition = this.completionProvider && this.completionProvider.initialPosition;\n            if (this.autoShown || (this.popup && this.popup.isOpen) || !initialPosition || this.editor.completers.length === 0)\n                return;\n            this.completions = new FilteredList(Autocomplete.completionsForLoading);\n            this.openPopup(this.editor, initialPosition.prefix, false);\n            this.popup.renderer.setStyle(\"ace_loading\", true);\n        }.bind(this), this.stickySelectionDelay);\n    }\n    Object.defineProperty(Autocomplete, \"completionsForLoading\", {\n        get: function () {\n            return [{\n                    caption: config.nls(\"Loading...\"),\n                    value: \"\"\n                }];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Autocomplete.prototype.$init = function () {\n        this.popup = new AcePopup(this.parentNode || document.body || document.documentElement);\n        this.popup.on(\"click\", function (e) {\n            this.insertMatch();\n            e.stop();\n        }.bind(this));\n        this.popup.focus = this.editor.focus.bind(this.editor);\n        this.popup.on(\"show\", this.$onPopupShow.bind(this));\n        this.popup.on(\"hide\", this.$onHidePopup.bind(this));\n        this.popup.on(\"select\", this.$onPopupChange.bind(this));\n        event.addListener(this.popup.container, \"mouseout\", this.mouseOutListener.bind(this));\n        this.popup.on(\"changeHoverMarker\", this.tooltipTimer.bind(null, null));\n        this.popup.renderer.on(\"afterRender\", this.$onPopupRender.bind(this));\n        return this.popup;\n    };\n    Autocomplete.prototype.$initInline = function () {\n        if (!this.inlineEnabled || this.inlineRenderer)\n            return;\n        this.inlineRenderer = new AceInline();\n        return this.inlineRenderer;\n    };\n    Autocomplete.prototype.getPopup = function () {\n        return this.popup || this.$init();\n    };\n    Autocomplete.prototype.$onHidePopup = function () {\n        if (this.inlineRenderer) {\n            this.inlineRenderer.hide();\n        }\n        this.hideDocTooltip();\n        this.stickySelectionTimer.cancel();\n        this.popupTimer.cancel();\n        this.stickySelection = false;\n    };\n    Autocomplete.prototype.$seen = function (completion) {\n        if (!this.hasSeen.has(completion) && completion && completion.completer && completion.completer.onSeen && typeof completion.completer.onSeen === \"function\") {\n            completion.completer.onSeen(this.editor, completion);\n            this.hasSeen.add(completion);\n        }\n    };\n    Autocomplete.prototype.$onPopupChange = function (hide) {\n        if (this.inlineRenderer && this.inlineEnabled) {\n            var completion = hide ? null : this.popup.getData(this.popup.getRow());\n            this.$updateGhostText(completion);\n            if (this.popup.isMouseOver && this.setSelectOnHover) {\n                this.tooltipTimer.call(null, null);\n                return;\n            }\n            this.popupTimer.schedule();\n            this.tooltipTimer.schedule();\n        }\n        else {\n            this.popupTimer.call(null, null);\n            this.tooltipTimer.call(null, null);\n        }\n    };\n    Autocomplete.prototype.$updateGhostText = function (completion) {\n        var row = this.base.row;\n        var column = this.base.column;\n        var cursorColumn = this.editor.getCursorPosition().column;\n        var prefix = this.editor.session.getLine(row).slice(column, cursorColumn);\n        if (!this.inlineRenderer.show(this.editor, completion, prefix)) {\n            this.inlineRenderer.hide();\n        }\n        else {\n            this.$seen(completion);\n        }\n    };\n    Autocomplete.prototype.$onPopupRender = function () {\n        var inlineEnabled = this.inlineRenderer && this.inlineEnabled;\n        if (this.completions && this.completions.filtered && this.completions.filtered.length > 0) {\n            for (var i = this.popup.getFirstVisibleRow(); i <= this.popup.getLastVisibleRow(); i++) {\n                var completion = this.popup.getData(i);\n                if (completion && (!inlineEnabled || completion.hideInlinePreview)) {\n                    this.$seen(completion);\n                }\n            }\n        }\n    };\n    Autocomplete.prototype.$onPopupShow = function (hide) {\n        this.$onPopupChange(hide);\n        this.stickySelection = false;\n        if (this.stickySelectionDelay >= 0)\n            this.stickySelectionTimer.schedule(this.stickySelectionDelay);\n    };\n    Autocomplete.prototype.observeLayoutChanges = function () {\n        if (this.$elements || !this.editor)\n            return;\n        window.addEventListener(\"resize\", this.onLayoutChange, { passive: true });\n        window.addEventListener(\"wheel\", this.mousewheelListener);\n        var el = this.editor.container.parentNode;\n        var elements = [];\n        while (el) {\n            elements.push(el);\n            el.addEventListener(\"scroll\", this.onLayoutChange, { passive: true });\n            el = el.parentNode;\n        }\n        this.$elements = elements;\n    };\n    Autocomplete.prototype.unObserveLayoutChanges = function () {\n        var _this = this;\n        window.removeEventListener(\"resize\", this.onLayoutChange, { passive: true });\n        window.removeEventListener(\"wheel\", this.mousewheelListener);\n        this.$elements && this.$elements.forEach(function (el) {\n            el.removeEventListener(\"scroll\", _this.onLayoutChange, { passive: true });\n        });\n        this.$elements = null;\n    };\n    Autocomplete.prototype.onLayoutChange = function () {\n        if (!this.popup.isOpen)\n            return this.unObserveLayoutChanges();\n        this.$updatePopupPosition();\n        this.updateDocTooltip();\n    };\n    Autocomplete.prototype.$updatePopupPosition = function () {\n        var editor = this.editor;\n        var renderer = editor.renderer;\n        var lineHeight = renderer.layerConfig.lineHeight;\n        var pos = renderer.$cursorLayer.getPixelPosition(this.base, true);\n        pos.left -= this.popup.getTextLeftOffset();\n        var rect = editor.container.getBoundingClientRect();\n        pos.top += rect.top - renderer.layerConfig.offset;\n        pos.left += rect.left - editor.renderer.scrollLeft;\n        pos.left += renderer.gutterWidth;\n        var posGhostText = {\n            top: pos.top,\n            left: pos.left\n        };\n        if (renderer.$ghostText && renderer.$ghostTextWidget) {\n            if (this.base.row === renderer.$ghostText.position.row) {\n                posGhostText.top += renderer.$ghostTextWidget.el.offsetHeight;\n            }\n        }\n        var editorContainerBottom = editor.container.getBoundingClientRect().bottom - lineHeight;\n        var lowestPosition = editorContainerBottom < posGhostText.top ?\n            { top: editorContainerBottom, left: posGhostText.left } :\n            posGhostText;\n        if (this.popup.tryShow(lowestPosition, lineHeight, \"bottom\")) {\n            return;\n        }\n        if (this.popup.tryShow(pos, lineHeight, \"top\")) {\n            return;\n        }\n        this.popup.show(pos, lineHeight);\n    };\n    Autocomplete.prototype.openPopup = function (editor, prefix, keepPopupPosition) {\n        this.$firstOpenTimer.cancel();\n        if (!this.popup)\n            this.$init();\n        if (this.inlineEnabled && !this.inlineRenderer)\n            this.$initInline();\n        this.popup.autoSelect = this.autoSelect;\n        this.popup.setSelectOnHover(this.setSelectOnHover);\n        var oldRow = this.popup.getRow();\n        var previousSelectedItem = this.popup.data[oldRow];\n        this.popup.setData(this.completions.filtered, this.completions.filterText);\n        if (this.editor.textInput.setAriaOptions) {\n            this.editor.textInput.setAriaOptions({\n                activeDescendant: getAriaId(this.popup.getRow()),\n                inline: this.inlineEnabled\n            });\n        }\n        editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n        var newRow;\n        if (this.stickySelection)\n            newRow = this.popup.data.indexOf(previousSelectedItem);\n        if (!newRow || newRow === -1)\n            newRow = 0;\n        this.popup.setRow(this.autoSelect ? newRow : -1);\n        if (newRow === oldRow && previousSelectedItem !== this.completions.filtered[newRow])\n            this.$onPopupChange();\n        var inlineEnabled = this.inlineRenderer && this.inlineEnabled;\n        if (newRow === oldRow && inlineEnabled) {\n            var completion = this.popup.getData(this.popup.getRow());\n            this.$updateGhostText(completion);\n        }\n        if (!keepPopupPosition) {\n            this.popup.setTheme(editor.getTheme());\n            this.popup.setFontSize(editor.getFontSize());\n            this.$updatePopupPosition();\n            if (this.tooltipNode) {\n                this.updateDocTooltip();\n            }\n        }\n        this.changeTimer.cancel();\n        this.observeLayoutChanges();\n    };\n    Autocomplete.prototype.detach = function () {\n        if (this.editor) {\n            this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n            this.editor.off(\"changeSelection\", this.changeListener);\n            this.editor.off(\"blur\", this.blurListener);\n            this.editor.off(\"mousedown\", this.mousedownListener);\n            this.editor.off(\"mousewheel\", this.mousewheelListener);\n        }\n        this.$firstOpenTimer.cancel();\n        this.changeTimer.cancel();\n        this.hideDocTooltip();\n        if (this.completionProvider) {\n            this.completionProvider.detach();\n        }\n        if (this.popup && this.popup.isOpen)\n            this.popup.hide();\n        if (this.popup && this.popup.renderer) {\n            this.popup.renderer.off(\"afterRender\", this.$onPopupRender);\n        }\n        if (this.base)\n            this.base.detach();\n        this.activated = false;\n        this.completionProvider = this.completions = this.base = null;\n        this.unObserveLayoutChanges();\n    };\n    Autocomplete.prototype.changeListener = function (e) {\n        var cursor = this.editor.selection.lead;\n        if (cursor.row != this.base.row || cursor.column < this.base.column) {\n            this.detach();\n        }\n        if (this.activated)\n            this.changeTimer.schedule();\n        else\n            this.detach();\n    };\n    Autocomplete.prototype.blurListener = function (e) {\n        var el = document.activeElement;\n        var text = this.editor.textInput.getElement();\n        var fromTooltip = e.relatedTarget && this.tooltipNode && this.tooltipNode.contains(e.relatedTarget);\n        var container = this.popup && this.popup.container;\n        if (el != text && el.parentNode != container && !fromTooltip\n            && el != this.tooltipNode && e.relatedTarget != text) {\n            this.detach();\n        }\n    };\n    Autocomplete.prototype.mousedownListener = function (e) {\n        this.detach();\n    };\n    Autocomplete.prototype.mousewheelListener = function (e) {\n        if (!this.popup.isMouseOver)\n            this.detach();\n    };\n    Autocomplete.prototype.mouseOutListener = function (e) {\n        if (this.popup.isOpen)\n            this.$updatePopupPosition();\n    };\n    Autocomplete.prototype.goTo = function (where) {\n        this.popup.goTo(where);\n    };\n    Autocomplete.prototype.insertMatch = function (data, options) {\n        if (!data)\n            data = this.popup.getData(this.popup.getRow());\n        if (!data)\n            return false;\n        if (data.value === \"\") // Explicitly given nothing to insert, e.g. \"No suggestion state\"\n            return this.detach();\n        var completions = this.completions;\n        var result = this.getCompletionProvider().insertMatch(this.editor, data, completions.filterText, options);\n        if (this.completions == completions)\n            this.detach();\n        return result;\n    };\n    Autocomplete.prototype.showPopup = function (editor, options) {\n        if (this.editor)\n            this.detach();\n        this.activated = true;\n        this.editor = editor;\n        if (editor.completer != this) {\n            if (editor.completer)\n                editor.completer.detach();\n            editor.completer = this;\n        }\n        editor.on(\"changeSelection\", this.changeListener);\n        editor.on(\"blur\", this.blurListener);\n        editor.on(\"mousedown\", this.mousedownListener);\n        editor.on(\"mousewheel\", this.mousewheelListener);\n        this.updateCompletions(false, options);\n    };\n    Autocomplete.prototype.getCompletionProvider = function (initialPosition) {\n        if (!this.completionProvider)\n            this.completionProvider = new CompletionProvider(initialPosition);\n        return this.completionProvider;\n    };\n    Autocomplete.prototype.gatherCompletions = function (editor, callback) {\n        return this.getCompletionProvider().gatherCompletions(editor, callback);\n    };\n    Autocomplete.prototype.updateCompletions = function (keepPopupPosition, options) {\n        if (keepPopupPosition && this.base && this.completions) {\n            var pos = this.editor.getCursorPosition();\n            var prefix = this.editor.session.getTextRange({ start: this.base, end: pos });\n            if (prefix == this.completions.filterText)\n                return;\n            this.completions.setFilter(prefix);\n            if (!this.completions.filtered.length)\n                return this.detach();\n            if (this.completions.filtered.length == 1\n                && this.completions.filtered[0].value == prefix\n                && !this.completions.filtered[0].snippet)\n                return this.detach();\n            this.openPopup(this.editor, prefix, keepPopupPosition);\n            return;\n        }\n        if (options && options.matches) {\n            var pos = this.editor.getSelectionRange().start;\n            this.base = this.editor.session.doc.createAnchor(pos.row, pos.column);\n            this.base.$insertRight = true;\n            this.completions = new FilteredList(options.matches);\n            this.getCompletionProvider().completions = this.completions;\n            return this.openPopup(this.editor, \"\", keepPopupPosition);\n        }\n        var session = this.editor.getSession();\n        var pos = this.editor.getCursorPosition();\n        var prefix = util.getCompletionPrefix(this.editor);\n        this.base = session.doc.createAnchor(pos.row, pos.column - prefix.length);\n        this.base.$insertRight = true;\n        var completionOptions = {\n            exactMatch: this.exactMatch,\n            ignoreCaption: this.ignoreCaption\n        };\n        this.getCompletionProvider({\n            prefix: prefix,\n            pos: pos\n        }).provideCompletions(this.editor, completionOptions, \n        function (err, completions, finished) {\n            var filtered = completions.filtered;\n            var prefix = util.getCompletionPrefix(this.editor);\n            this.$firstOpenTimer.cancel();\n            if (finished) {\n                if (!filtered.length) {\n                    var emptyMessage = !this.autoShown && this.emptyMessage;\n                    if (typeof emptyMessage == \"function\")\n                        emptyMessage = this.emptyMessage(prefix);\n                    if (emptyMessage) {\n                        var completionsForEmpty = [{\n                                caption: emptyMessage,\n                                value: \"\"\n                            }\n                        ];\n                        this.completions = new FilteredList(completionsForEmpty);\n                        this.openPopup(this.editor, prefix, keepPopupPosition);\n                        this.popup.renderer.setStyle(\"ace_loading\", false);\n                        this.popup.renderer.setStyle(\"ace_empty-message\", true);\n                        return;\n                    }\n                    return this.detach();\n                }\n                if (filtered.length == 1 && filtered[0].value == prefix\n                    && !filtered[0].snippet)\n                    return this.detach();\n                if (this.autoInsert && !this.autoShown && filtered.length == 1)\n                    return this.insertMatch(filtered[0]);\n            }\n            this.completions = !finished && this.showLoadingState ?\n                new FilteredList(Autocomplete.completionsForLoading.concat(filtered), completions.filterText) :\n                completions;\n            this.openPopup(this.editor, prefix, keepPopupPosition);\n            this.popup.renderer.setStyle(\"ace_empty-message\", false);\n            this.popup.renderer.setStyle(\"ace_loading\", !finished);\n        }.bind(this));\n        if (this.showLoadingState && !this.autoShown && !(this.popup && this.popup.isOpen)) {\n            this.$firstOpenTimer.delay(this.stickySelectionDelay / 2);\n        }\n    };\n    Autocomplete.prototype.cancelContextMenu = function () {\n        this.editor.$mouseHandler.cancelContextMenu();\n    };\n    Autocomplete.prototype.updateDocTooltip = function () {\n        var popup = this.popup;\n        var all = this.completions.filtered;\n        var selected = all && (all[popup.getHoveredRow()] || all[popup.getRow()]);\n        var doc = null;\n        if (!selected || !this.editor || !this.popup.isOpen)\n            return this.hideDocTooltip();\n        var completersLength = this.editor.completers.length;\n        for (var i = 0; i < completersLength; i++) {\n            var completer = this.editor.completers[i];\n            if (completer.getDocTooltip && selected.completerId === completer.id) {\n                doc = completer.getDocTooltip(selected);\n                break;\n            }\n        }\n        if (!doc && typeof selected != \"string\")\n            doc = selected;\n        if (typeof doc == \"string\")\n            doc = { docText: doc };\n        if (!doc || !(doc.docHTML || doc.docText))\n            return this.hideDocTooltip();\n        this.showDocTooltip(doc);\n    };\n    Autocomplete.prototype.showDocTooltip = function (item) {\n        if (!this.tooltipNode) {\n            this.tooltipNode = dom.createElement(\"div\");\n            this.tooltipNode.style.margin = \"0\";\n            this.tooltipNode.style.pointerEvents = \"auto\";\n            this.tooltipNode.style.overscrollBehavior = \"contain\";\n            this.tooltipNode.tabIndex = -1;\n            this.tooltipNode.onblur = this.blurListener.bind(this);\n            this.tooltipNode.onclick = this.onTooltipClick.bind(this);\n            this.tooltipNode.id = \"doc-tooltip\";\n            this.tooltipNode.setAttribute(\"role\", \"tooltip\");\n            this.tooltipNode.addEventListener(\"wheel\", preventParentScroll);\n        }\n        var theme = this.editor.renderer.theme;\n        this.tooltipNode.className = \"ace_tooltip ace_doc-tooltip \" +\n            (theme.isDark ? \"ace_dark \" : \"\") + (theme.cssClass || \"\");\n        var tooltipNode = this.tooltipNode;\n        if (item.docHTML) {\n            tooltipNode.innerHTML = item.docHTML;\n        }\n        else if (item.docText) {\n            tooltipNode.textContent = item.docText;\n        }\n        if (!tooltipNode.parentNode)\n            this.popup.container.appendChild(this.tooltipNode);\n        var popup = this.popup;\n        var rect = popup.container.getBoundingClientRect();\n        tooltipNode.style.top = popup.container.style.top;\n        tooltipNode.style.bottom = popup.container.style.bottom;\n        tooltipNode.style.display = \"block\";\n        if (window.innerWidth - rect.right < 320) {\n            if (rect.left < 320) {\n                if (popup.isTopdown) {\n                    tooltipNode.style.top = rect.bottom + \"px\";\n                    tooltipNode.style.left = rect.left + \"px\";\n                    tooltipNode.style.right = \"\";\n                    tooltipNode.style.bottom = \"\";\n                }\n                else {\n                    tooltipNode.style.top = popup.container.offsetTop - tooltipNode.offsetHeight + \"px\";\n                    tooltipNode.style.left = rect.left + \"px\";\n                    tooltipNode.style.right = \"\";\n                    tooltipNode.style.bottom = \"\";\n                }\n            }\n            else {\n                tooltipNode.style.right = window.innerWidth - rect.left + \"px\";\n                tooltipNode.style.left = \"\";\n            }\n        }\n        else {\n            tooltipNode.style.left = (rect.right + 1) + \"px\";\n            tooltipNode.style.right = \"\";\n        }\n    };\n    Autocomplete.prototype.hideDocTooltip = function () {\n        this.tooltipTimer.cancel();\n        if (!this.tooltipNode)\n            return;\n        var el = this.tooltipNode;\n        if (!this.editor.isFocused() && document.activeElement == el)\n            this.editor.focus();\n        this.tooltipNode = null;\n        if (el.parentNode)\n            el.parentNode.removeChild(el);\n    };\n    Autocomplete.prototype.onTooltipClick = function (e) {\n        var a = e.target;\n        while (a && a != this.tooltipNode) {\n            if (a.nodeName == \"A\" && a.href) {\n                a.rel = \"noreferrer\";\n                a.target = \"_blank\";\n                break;\n            }\n            a = a.parentNode;\n        }\n    };\n    Autocomplete.prototype.destroy = function () {\n        this.detach();\n        if (this.popup) {\n            this.popup.destroy();\n            var el = this.popup.container;\n            if (el && el.parentNode)\n                el.parentNode.removeChild(el);\n        }\n        if (this.editor && this.editor.completer == this) {\n            this.editor.off(\"destroy\", destroyCompleter);\n            this.editor.completer = null;\n        }\n        this.inlineRenderer = this.popup = this.editor = null;\n    };\n    return Autocomplete;\n}());\nAutocomplete.prototype.commands = {\n    \"Up\": function (editor) { editor.completer.goTo(\"up\"); },\n    \"Down\": function (editor) { editor.completer.goTo(\"down\"); },\n    \"Ctrl-Up|Ctrl-Home\": function (editor) { editor.completer.goTo(\"start\"); },\n    \"Ctrl-Down|Ctrl-End\": function (editor) { editor.completer.goTo(\"end\"); },\n    \"Esc\": function (editor) { editor.completer.detach(); },\n    \"Return\": function (editor) { return editor.completer.insertMatch(); },\n    \"Shift-Return\": function (editor) { editor.completer.insertMatch(null, { deleteSuffix: true }); },\n    \"Tab\": function (editor) {\n        var result = editor.completer.insertMatch();\n        if (!result && !editor.tabstopManager)\n            editor.completer.goTo(\"down\");\n        else\n            return result;\n    },\n    \"Backspace\": function (editor) {\n        editor.execCommand(\"backspace\");\n        var prefix = util.getCompletionPrefix(editor);\n        if (!prefix && editor.completer)\n            editor.completer.detach();\n    },\n    \"PageUp\": function (editor) { editor.completer.popup.gotoPageUp(); },\n    \"PageDown\": function (editor) { editor.completer.popup.gotoPageDown(); }\n};\nAutocomplete.for = function (editor) {\n    if (editor.completer instanceof Autocomplete) {\n        return editor.completer;\n    }\n    if (editor.completer) {\n        editor.completer.destroy();\n        editor.completer = null;\n    }\n    if (config.get(\"sharedPopups\")) {\n        if (!Autocomplete[\"$sharedInstance\"])\n            Autocomplete[\"$sharedInstance\"] = new Autocomplete();\n        editor.completer = Autocomplete[\"$sharedInstance\"];\n    }\n    else {\n        editor.completer = new Autocomplete();\n        editor.once(\"destroy\", destroyCompleter);\n    }\n    return editor.completer;\n};\nAutocomplete.startCommand = {\n    name: \"startAutocomplete\",\n    exec: function (editor, options) {\n        var completer = Autocomplete.for(editor);\n        completer.autoInsert = false;\n        completer.autoSelect = true;\n        completer.autoShown = false;\n        completer.showPopup(editor, options);\n        completer.cancelContextMenu();\n    },\n    bindKey: \"Ctrl-Space|Ctrl-Shift-Space|Alt-Space\"\n};\nvar CompletionProvider = /** @class */ (function () {\n    function CompletionProvider(initialPosition) {\n        this.initialPosition = initialPosition;\n        this.active = true;\n    }\n    CompletionProvider.prototype.insertByIndex = function (editor, index, options) {\n        if (!this.completions || !this.completions.filtered) {\n            return false;\n        }\n        return this.insertMatch(editor, this.completions.filtered[index], options);\n    };\n    CompletionProvider.prototype.insertMatch = function (editor, data, options) {\n        if (!data)\n            return false;\n        editor.startOperation({ command: { name: \"insertMatch\" } });\n        if (data.completer && data.completer.insertMatch) {\n            data.completer.insertMatch(editor, data);\n        }\n        else {\n            if (!this.completions)\n                return false;\n            var replaceBefore = this.completions.filterText.length;\n            var replaceAfter = 0;\n            if (data.range && data.range.start.row === data.range.end.row) {\n                replaceBefore -= this.initialPosition.prefix.length;\n                replaceBefore += this.initialPosition.pos.column - data.range.start.column;\n                replaceAfter += data.range.end.column - this.initialPosition.pos.column;\n            }\n            if (replaceBefore || replaceAfter) {\n                var ranges;\n                if (editor.selection.getAllRanges) {\n                    ranges = editor.selection.getAllRanges();\n                }\n                else {\n                    ranges = [editor.getSelectionRange()];\n                }\n                for (var i = 0, range; range = ranges[i]; i++) {\n                    range.start.column -= replaceBefore;\n                    range.end.column += replaceAfter;\n                    editor.session.remove(range);\n                }\n            }\n            if (data.snippet) {\n                snippetManager.insertSnippet(editor, data.snippet);\n            }\n            else {\n                this.$insertString(editor, data);\n            }\n            if (data.completer && data.completer.onInsert && typeof data.completer.onInsert == \"function\") {\n                data.completer.onInsert(editor, data);\n            }\n            if (data.command && data.command === \"startAutocomplete\") {\n                editor.execCommand(data.command);\n            }\n        }\n        editor.endOperation();\n        return true;\n    };\n    CompletionProvider.prototype.$insertString = function (editor, data) {\n        var text = data.value || data;\n        editor.execCommand(\"insertstring\", text);\n    };\n    CompletionProvider.prototype.gatherCompletions = function (editor, callback) {\n        var session = editor.getSession();\n        var pos = editor.getCursorPosition();\n        var prefix = util.getCompletionPrefix(editor);\n        var matches = [];\n        this.completers = editor.completers;\n        var total = editor.completers.length;\n        editor.completers.forEach(function (completer, i) {\n            completer.getCompletions(editor, session, pos, prefix, function (err, results) {\n                if (completer.hideInlinePreview)\n                    results = results.map(function (result) {\n                        return Object.assign(result, { hideInlinePreview: completer.hideInlinePreview });\n                    });\n                if (!err && results)\n                    matches = matches.concat(results);\n                callback(null, {\n                    prefix: util.getCompletionPrefix(editor),\n                    matches: matches,\n                    finished: (--total === 0)\n                });\n            });\n        });\n        return true;\n    };\n    CompletionProvider.prototype.provideCompletions = function (editor, options, callback) {\n        var processResults = function (results) {\n            var prefix = results.prefix;\n            var matches = results.matches;\n            this.completions = new FilteredList(matches);\n            if (options.exactMatch)\n                this.completions.exactMatch = true;\n            if (options.ignoreCaption)\n                this.completions.ignoreCaption = true;\n            this.completions.setFilter(prefix);\n            if (results.finished || this.completions.filtered.length)\n                callback(null, this.completions, results.finished);\n        }.bind(this);\n        var isImmediate = true;\n        var immediateResults = null;\n        this.gatherCompletions(editor, function (err, results) {\n            if (!this.active) {\n                return;\n            }\n            if (err) {\n                callback(err, [], true);\n                this.detach();\n            }\n            var prefix = results.prefix;\n            if (prefix.indexOf(results.prefix) !== 0)\n                return;\n            if (isImmediate) {\n                immediateResults = results;\n                return;\n            }\n            processResults(results);\n        }.bind(this));\n        isImmediate = false;\n        if (immediateResults) {\n            var results = immediateResults;\n            immediateResults = null;\n            processResults(results);\n        }\n    };\n    CompletionProvider.prototype.detach = function () {\n        this.active = false;\n        this.completers && this.completers.forEach(function (completer) {\n            if (typeof completer.cancel === \"function\") {\n                completer.cancel();\n            }\n        });\n    };\n    return CompletionProvider;\n}());\nvar FilteredList = /** @class */ (function () {\n    function FilteredList(array, filterText) {\n        this.all = array;\n        this.filtered = array;\n        this.filterText = filterText || \"\";\n        this.exactMatch = false;\n        this.ignoreCaption = false;\n    }\n    FilteredList.prototype.setFilter = function (str) {\n        if (str.length > this.filterText && str.lastIndexOf(this.filterText, 0) === 0)\n            var matches = this.filtered;\n        else\n            var matches = this.all;\n        this.filterText = str;\n        matches = this.filterCompletions(matches, this.filterText);\n        matches = matches.sort(function (a, b) {\n            return b.exactMatch - a.exactMatch || b.$score - a.$score\n                || (a.caption || a.value).localeCompare(b.caption || b.value);\n        });\n        var prev = null;\n        matches = matches.filter(function (item) {\n            var caption = item.snippet || item.caption || item.value;\n            if (caption === prev)\n                return false;\n            prev = caption;\n            return true;\n        });\n        this.filtered = matches;\n    };\n    FilteredList.prototype.filterCompletions = function (items, needle) {\n        var results = [];\n        var upper = needle.toUpperCase();\n        var lower = needle.toLowerCase();\n        loop: for (var i = 0, item; item = items[i]; i++) {\n            var caption = (!this.ignoreCaption && item.caption) || item.value || item.snippet;\n            if (!caption)\n                continue;\n            var lastIndex = -1;\n            var matchMask = 0;\n            var penalty = 0;\n            var index, distance;\n            if (this.exactMatch) {\n                if (needle !== caption.substr(0, needle.length))\n                    continue loop;\n            }\n            else {\n                var fullMatchIndex = caption.toLowerCase().indexOf(lower);\n                if (fullMatchIndex > -1) {\n                    penalty = fullMatchIndex;\n                }\n                else {\n                    for (var j = 0; j < needle.length; j++) {\n                        var i1 = caption.indexOf(lower[j], lastIndex + 1);\n                        var i2 = caption.indexOf(upper[j], lastIndex + 1);\n                        index = (i1 >= 0) ? ((i2 < 0 || i1 < i2) ? i1 : i2) : i2;\n                        if (index < 0)\n                            continue loop;\n                        distance = index - lastIndex - 1;\n                        if (distance > 0) {\n                            if (lastIndex === -1)\n                                penalty += 10;\n                            penalty += distance;\n                            matchMask = matchMask | (1 << j);\n                        }\n                        lastIndex = index;\n                    }\n                }\n            }\n            item.matchMask = matchMask;\n            item.exactMatch = penalty ? 0 : 1;\n            item.$score = (item.score || 0) - penalty;\n            results.push(item);\n        }\n        return results;\n    };\n    return FilteredList;\n}());\nexports.Autocomplete = Autocomplete;\nexports.CompletionProvider = CompletionProvider;\nexports.FilteredList = FilteredList;\n\n});\n\nace.define(\"ace/autocomplete/text_completer\",[\"require\",\"exports\",\"module\",\"ace/range\"], function(require, exports, module){var Range = require(\"../range\").Range;\nvar splitRegex = /[^a-zA-Z_0-9\\$\\-\\u00C0-\\u1FFF\\u2C00-\\uD7FF\\w]+/;\nfunction getWordIndex(doc, pos) {\n    var textBefore = doc.getTextRange(Range.fromPoints({\n        row: 0,\n        column: 0\n    }, pos));\n    return textBefore.split(splitRegex).length - 1;\n}\nfunction wordDistance(doc, pos) {\n    var prefixPos = getWordIndex(doc, pos);\n    var words = doc.getValue().split(splitRegex);\n    var wordScores = Object.create(null);\n    var currentWord = words[prefixPos];\n    words.forEach(function (word, idx) {\n        if (!word || word === currentWord)\n            return;\n        var distance = Math.abs(prefixPos - idx);\n        var score = words.length - distance;\n        if (wordScores[word]) {\n            wordScores[word] = Math.max(score, wordScores[word]);\n        }\n        else {\n            wordScores[word] = score;\n        }\n    });\n    return wordScores;\n}\nexports.getCompletions = function (editor, session, pos, prefix, callback) {\n    var wordScore = wordDistance(session, pos);\n    var wordList = Object.keys(wordScore);\n    callback(null, wordList.map(function (word) {\n        return {\n            caption: word,\n            value: word,\n            score: wordScore[word],\n            meta: \"local\"\n        };\n    }));\n};\n\n});\n\nace.define(\"ace/ext/language_tools\",[\"require\",\"exports\",\"module\",\"ace/snippets\",\"ace/autocomplete\",\"ace/config\",\"ace/lib/lang\",\"ace/autocomplete/util\",\"ace/autocomplete/text_completer\",\"ace/editor\",\"ace/config\"], function(require, exports, module){\"use strict\";\nvar snippetManager = require(\"../snippets\").snippetManager;\nvar Autocomplete = require(\"../autocomplete\").Autocomplete;\nvar config = require(\"../config\");\nvar lang = require(\"../lib/lang\");\nvar util = require(\"../autocomplete/util\");\nvar textCompleter = require(\"../autocomplete/text_completer\");\nvar keyWordCompleter = {\n    getCompletions: function (editor, session, pos, prefix, callback) {\n        if (session.$mode.completer) {\n            return session.$mode.completer.getCompletions(editor, session, pos, prefix, callback);\n        }\n        var state = editor.session.getState(pos.row);\n        var completions = session.$mode.getCompletions(state, session, pos, prefix);\n        completions = completions.map(function (el) {\n            el.completerId = keyWordCompleter.id;\n            return el;\n        });\n        callback(null, completions);\n    },\n    id: \"keywordCompleter\"\n};\nvar transformSnippetTooltip = function (str) {\n    var record = {};\n    return str.replace(/\\${(\\d+)(:(.*?))?}/g, function (_, p1, p2, p3) {\n        return (record[p1] = p3 || '');\n    }).replace(/\\$(\\d+?)/g, function (_, p1) {\n        return record[p1];\n    });\n};\nvar snippetCompleter = {\n    getCompletions: function (editor, session, pos, prefix, callback) {\n        var scopes = [];\n        var token = session.getTokenAt(pos.row, pos.column);\n        if (token && token.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\\.xml$/))\n            scopes.push('html-tag');\n        else\n            scopes = snippetManager.getActiveScopes(editor);\n        var snippetMap = snippetManager.snippetMap;\n        var completions = [];\n        scopes.forEach(function (scope) {\n            var snippets = snippetMap[scope] || [];\n            for (var i = snippets.length; i--;) {\n                var s = snippets[i];\n                var caption = s.name || s.tabTrigger;\n                if (!caption)\n                    continue;\n                completions.push({\n                    caption: caption,\n                    snippet: s.content,\n                    meta: s.tabTrigger && !s.name ? s.tabTrigger + \"\\u21E5 \" : \"snippet\",\n                    completerId: snippetCompleter.id\n                });\n            }\n        }, this);\n        callback(null, completions);\n    },\n    getDocTooltip: function (item) {\n        if (item.snippet && !item.docHTML) {\n            item.docHTML = [\n                \"<b>\", lang.escapeHTML(item.caption), \"</b>\", \"<hr></hr>\",\n                lang.escapeHTML(transformSnippetTooltip(item.snippet))\n            ].join(\"\");\n        }\n    },\n    id: \"snippetCompleter\"\n};\nvar completers = [snippetCompleter, textCompleter, keyWordCompleter];\nexports.setCompleters = function (val) {\n    completers.length = 0;\n    if (val)\n        completers.push.apply(completers, val);\n};\nexports.addCompleter = function (completer) {\n    completers.push(completer);\n};\nexports.textCompleter = textCompleter;\nexports.keyWordCompleter = keyWordCompleter;\nexports.snippetCompleter = snippetCompleter;\nvar expandSnippet = {\n    name: \"expandSnippet\",\n    exec: function (editor) {\n        return snippetManager.expandWithTab(editor);\n    },\n    bindKey: \"Tab\"\n};\nvar onChangeMode = function (e, editor) {\n    loadSnippetsForMode(editor.session.$mode);\n};\nvar loadSnippetsForMode = function (mode) {\n    if (typeof mode == \"string\")\n        mode = config.$modes[mode];\n    if (!mode)\n        return;\n    if (!snippetManager.files)\n        snippetManager.files = {};\n    loadSnippetFile(mode.$id, mode.snippetFileId);\n    if (mode.modes)\n        mode.modes.forEach(loadSnippetsForMode);\n};\nvar loadSnippetFile = function (id, snippetFilePath) {\n    if (!snippetFilePath || !id || snippetManager.files[id])\n        return;\n    snippetManager.files[id] = {};\n    config.loadModule(snippetFilePath, function (m) {\n        if (!m)\n            return;\n        snippetManager.files[id] = m;\n        if (!m.snippets && m.snippetText)\n            m.snippets = snippetManager.parseSnippetFile(m.snippetText);\n        snippetManager.register(m.snippets || [], m.scope);\n        if (m.includeScopes) {\n            snippetManager.snippetMap[m.scope].includeScopes = m.includeScopes;\n            m.includeScopes.forEach(function (x) {\n                loadSnippetsForMode(\"ace/mode/\" + x);\n            });\n        }\n    });\n};\nvar doLiveAutocomplete = function (e) {\n    var editor = e.editor;\n    var hasCompleter = editor.completer && editor.completer.activated;\n    if (e.command.name === \"backspace\") {\n        if (hasCompleter && !util.getCompletionPrefix(editor))\n            editor.completer.detach();\n    }\n    else if (e.command.name === \"insertstring\" && !hasCompleter) {\n        lastExecEvent = e;\n        var delay = e.editor.$liveAutocompletionDelay;\n        if (delay) {\n            liveAutocompleteTimer.delay(delay);\n        }\n        else {\n            showLiveAutocomplete(e);\n        }\n    }\n};\nvar lastExecEvent;\nvar liveAutocompleteTimer = lang.delayedCall(function () {\n    showLiveAutocomplete(lastExecEvent);\n}, 0);\nvar showLiveAutocomplete = function (e) {\n    var editor = e.editor;\n    var prefix = util.getCompletionPrefix(editor);\n    var previousChar = e.args;\n    var triggerAutocomplete = util.triggerAutocomplete(editor, previousChar);\n    if (prefix && prefix.length >= editor.$liveAutocompletionThreshold || triggerAutocomplete) {\n        var completer = Autocomplete.for(editor);\n        completer.autoShown = true;\n        completer.showPopup(editor);\n    }\n};\nvar Editor = require(\"../editor\").Editor;\nrequire(\"../config\").defineOptions(Editor.prototype, \"editor\", {\n    enableBasicAutocompletion: {\n        set: function (val) {\n            if (val) {\n                if (!this.completers)\n                    this.completers = Array.isArray(val) ? val : completers;\n                this.commands.addCommand(Autocomplete.startCommand);\n            }\n            else {\n                this.commands.removeCommand(Autocomplete.startCommand);\n            }\n        },\n        value: false\n    },\n    enableLiveAutocompletion: {\n        set: function (val) {\n            if (val) {\n                if (!this.completers)\n                    this.completers = Array.isArray(val) ? val : completers;\n                this.commands.on('afterExec', doLiveAutocomplete);\n            }\n            else {\n                this.commands.off('afterExec', doLiveAutocomplete);\n            }\n        },\n        value: false\n    },\n    liveAutocompletionDelay: {\n        initialValue: 0\n    },\n    liveAutocompletionThreshold: {\n        initialValue: 0\n    },\n    enableSnippets: {\n        set: function (val) {\n            if (val) {\n                this.commands.addCommand(expandSnippet);\n                this.on(\"changeMode\", onChangeMode);\n                onChangeMode(null, this);\n            }\n            else {\n                this.commands.removeCommand(expandSnippet);\n                this.off(\"changeMode\", onChangeMode);\n            }\n        },\n        value: false\n    }\n});\n\n});                (function() {\n                    ace.require([\"ace/ext/language_tools\"], function(m) {\n                        if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n                            module.exports = m;\n                        }\n                    });\n                })();\n            "]},"metadata":{},"sourceType":"script"}